webpackJsonp([61],{1139:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(710);e.default={data:function(){return{isActive:1,startTime:null,endTime:null,pid:null,sid:null,chartLine:null,chartPie:null,linechartData:[],type:1,finalType:1,day:"",week:"",month:"",year:"",isTouch:!1,currentTime:"",currentYear:null,currentTotal:0,lastTotal:0,circleRadio:0,dayxAxislabel:["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],dayFixedlabel:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],weekxAxislabel:["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],weekFixedlabel:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthxAxislabel:["1日","2日","3日","4日","5日","6日","7日","8日","9日","10日","11日","12日","13日","14日","15日","16日","17日","18日","19日","20日","21日","22日","23日","24日","25日","26日","27日","28日","29日","30日","31日"],monthFixedlabel:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],currentmonthDays:null,lastmonthDays:null,yearxAxislabel:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],yearFixedlabel:[1,2,3,4,5,6,7,8,9,10,11,12],pickerOptions:{firstDayOfWeek:1,disabledDate:function(t){return t.getTime()>Date.now()-864e4}},pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()-864e4}}}},mounted:function(){var t=this;this.pid=JSON.parse(sessionStorage.getItem("project")).id,this.$route.query.sid?this.sid=this.$route.query.sid:this.sid=sessionStorage.getItem("subsystemId"),this.chartLine=echarts.init(document.getElementById("chartLine")),this.chartPie=echarts.init(document.getElementById("chartPie"));var e=(new Date).format("yyyy-MM-dd");this.startTime=e+" 00:00:00",this.endTime=(new Date).format("yyyy-MM-dd hh:mm:ss"),this.day=new Date,this.fetchDmplist(),this.fetchArealist(),this.fetchTotalpassenger(),this.$nextTick(function(){window.onresize=function(){t.chartLine.resize(),t.chartPie.resize()}})},methods:{fetchDmplist:function(){var t=this;a.i(i.i)(this.pid,this.sid,this.startTime,this.endTime,this.finalType).then(function(e){var a=JSON.parse(e.data);a.success?1===t.finalType?t.handlesuccessBack(t.dayxAxislabel,a,t.dayFixedlabel,"当日","昨日"):2===t.finalType?t.handlesuccessBack(t.weekxAxislabel,a,t.weekFixedlabel,"本周","上周"):3===t.finalType?t.handlesuccessBack(t.monthxAxislabel,a,t.monthFixedlabel,"本月","上月"):t.handlesuccessBack(t.yearxAxislabel,a,t.yearFixedlabel,"本年","去年"):t.handlerrorBack()})},fetchArealist:function(){var t=this;a.i(i.j)(this.pid,this.sid,this.startTime,this.endTime).then(function(e){var a=[],i=[];JSON.parse(e.data).success?JSON.parse(e.data).list.forEach(function(e){var n={name:e.area,value:e.val};i.push(n),a.push(e.area),t.handlepieChart(a,i)}):t.handlepieChart(a,i)})},fetchTotalpassenger:function(){var t=this;a.i(i.k)(this.pid,this.sid,this.startTime,this.endTime,this.finalType).then(function(e){var a=JSON.parse(e.data);a.success&&(t.currentTotal=a.total,t.lastTotal=a.oldtotal,t.circleRadio=a.avgval)})},handlelineChart:function(t,e){this.chartLine.setOption({title:{text:e.length?"门店总客流趋势":"暂无数据",x:"center",top:10,textStyle:{fontSize:14}},color:["#2297E8","#48CE38","#F8D156","#FD9827","#9764DC","#339999","#50c2c2","#abd4dd","#7b98c1","#84b5ef","#ffc281","#ff8080"],tooltip:{trigger:"axis"},calculable:!0,legend:{show:!0,right:100,top:5},toolbox:{right:40,feature:{saveAsImage:{}}},xAxis:[{type:"category",boundaryGap:!1,data:t,show:e.length}],yAxis:[{type:"value",name:"单位/人",axisLabel:{formatter:function(t){return t>1e3?t/1e3+"k":t}},show:e.length}],grid:{x:60,y:60,x2:40,y2:40},series:e})},handlepieChart:function(t,e){this.chartPie.setOption({title:{text:e.length?"门店分区域客流":"暂无数据",x:"center",top:10,textStyle:{fontSize:14}},color:["#2297E8","#48CE38","#F8D156","#FD9827","#9764DC","#339999","#50c2c2","#abd4dd","#7b98c1","#84b5ef","#ffc281","#ff8080"],tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"horizontal",bottom:0,data:t,show:!0},toolbox:{right:40,feature:{saveAsImage:{}}},calculable:!0,series:[{name:"占比",type:"pie",radius:"50%",center:["50%","50%"],data:e,itemStyle:{normal:{label:{formatter:"{b} ({c}，{d}%)"},labelLine:{length:0}}}}]})},handletimerange:function(t){if(this.chartLine.clear(),this.linechartData=[],this.lineinitLabel=[],this.isTouch=!1,1===t){var e=(new Date).format("yyyy-MM-dd");this.startTime=e+" 00:00:00",this.endTime=(new Date).format("yyyy-MM-dd hh:mm:ss"),this.day=new Date}else if(2===t){var a=0===(new Date).getDay()?7:(new Date).getDay(),i=(new Date).getTime(),n=new Date(i-24*(a-1)*60*60*1e3).format("yyyy-MM-dd");this.startTime=n+" 00:00:00",this.endTime=(new Date).format("yyyy-MM-dd hh:mm:ss"),this.week=new Date}else if(3===t){this.currentTime=(new Date).format("yyyy-M");var r=(new Date).format("yyyy-MM");this.startTime=r+"-01 00:00:00",this.endTime=(new Date).format("yyyy-MM-dd hh:mm:ss"),this.month=new Date,this.currentmonthDays=new Date(this.currentTime.split("-")[0],this.currentTime.split("-")[1],0).getDate()}else{var s=(new Date).format("yyyy");this.currentYear=s,this.startTime=s+"-01-01 00:00:00",this.endTime=(new Date).format("yyyy-MM-dd hh:mm:ss"),this.year=new Date}this.finalType=t,this.fetchDmplist(),this.fetchArealist(),this.fetchTotalpassenger()},handleformatTime:function(t){if(1===this.finalType){var e=new Date(t).format("yyyy-MM-dd");(new Date).format("yyyy-MM-dd");this.startTime=e+" 00:00:00",this.endTime=new Date(new Date(this.startTime).getTime()+864e5).format("yyyy-MM-dd hh:mm:ss")}else if(2===this.finalType)this.startTime=new Date(new Date(t).getTime()-864e5).format("yyyy-MM-dd hh:mm:ss"),this.endTime=new Date(new Date(t).getTime()+5184e5).format("yyyy-MM-dd hh:mm:ss");else if(3===this.finalType){this.currentTime=t;var a=t.split("-")[0],i=t.split("-")[1],n=new Date(a,i,0);this.currentmonthDays=n.getDate(),this.startTime=t+"-01 00:00:00",this.endTime=new Date(new Date(this.startTime).getTime()+86400*this.currentmonthDays*1e3).format("yyyy-MM-dd hh:mm:ss")}else{var r=(new Date).format("yyyy");r===t?(this.currentYear=t,this.startTime=t+"-01-01 00:00:00",this.endTime=(new Date).format("yyyy-MM-dd hh:mm:ss")):(this.currentYear=t,this.startTime=t+"-01-01 00:00:00",this.endTime=+t+1+"-01-01 00:00:00")}this.linechartData=[],this.chartLine.clear(),this.isTouch=!1,this.fetchDmplist(),this.fetchArealist(),this.fetchTotalpassenger()},comparison:function(){if(this.isTouch=!this.isTouch,this.isTouch){if(1===this.finalType)this.endTime=this.startTime,this.startTime=new Date(new Date(this.startTime).getTime()-864e5).format("yyyy-MM-dd hh:mm:ss");else if(2===this.finalType)this.endTime=this.startTime,this.startTime=new Date(new Date(this.startTime).getTime()-6048e5).format("yyyy-MM-dd hh:mm:ss");else if(3===this.finalType){var t=+this.currentTime.split("-")[0],e=+this.currentTime.split("-")[1],a=1===e?12:e-1,i=1===e?t-1:t;this.lastmonthDays=new Date(i,a,0).getDate(),this.endTime=this.startTime,this.startTime=i+"-"+a+"-01 00:00:00"}else this.endTime=this.startTime,this.startTime=this.currentYear-1+"-01-01 00:00:00";this.fetchDmplist()}else this.chartLine.clear(),this.startTime=this.endTime,this.endTime=new Date(new Date(this.startTime).getTime()+6048e5).format("yyyy-MM-dd hh:mm:ss"),this.linechartData.splice(1,1),1===this.finalType?this.handlelineChart(this.dayxAxislabel,this.linechartData):2===this.finalType?this.handlelineChart(this.weekxAxislabel,this.linechartData):3===this.finalType?this.handlelineChart(this.monthxAxislabel,this.linechartData):this.handlelineChart(this.yearxAxislabel,this.linechartData)},handledayxLabel:function(t,e){var a=this,i=[],n=[];return t.forEach(function(t){2!==a.finalType?i.push(+t.time):i.push(t.time)}),e.forEach(function(e){-1===i.indexOf(e)?n.push(""):t.forEach(function(t){2!==a.finalType?+t.time===e&&n.push(+t.val):t.time===e&&n.push(+t.val)})}),n},handlesuccessBack:function(t,e,a,i,n){if(this.isTouch){var r={name:n,type:"line",itemStyle:{normal:{areaStyle:{type:"default"}}},data:this.handledayxLabel(e.list,a)};this.linechartData.push(r),this.handlelineChart(t,this.linechartData)}else{var s={name:i,type:"line",itemStyle:{normal:{areaStyle:{type:"default"}}},data:this.handledayxLabel(e.list,a)};this.linechartData.push(s),this.handlelineChart(t,this.linechartData)}},handlerrorBack:function(){this.isTouch?1===this.finalType?this.handlelineChart(this.dayxAxislabel,this.linechartData):2===this.finalType?this.handlelineChart(this.weekxAxislabel,this.linechartData):3===this.finalType?this.handlelineChart(this.monthxAxislabel,this.linechartData):this.handlelineChart(this.yearxAxislabel,this.linechartData):this.handlelineChart([],[])}}}},1315:function(t,e,a){e=t.exports=a(539)(),e.push([t.i,".tab-content .toolBox .el-date-editor{vertical-align:-1.5px}.tab-content .el-picker-panel{position:absolute;z-index:100}",""])},1316:function(t,e,a){e=t.exports=a(539)(),e.push([t.i,".toolBox .check[data-v-cd7720a8],.toolBox .timeselect[data-v-cd7720a8]{vertical-align:middle}.chart-wrapper[data-v-cd7720a8]{margin-top:10px}.chart-wrapper .line-wrapper[data-v-cd7720a8],.chart-wrapper .pie-wrapper[data-v-cd7720a8]{box-shadow:0 0 3px rgba(0,0,0,.4);border-radius:4px}.chart-wrapper .line-wrapper #chartLine[data-v-cd7720a8],.chart-wrapper .pie-wrapper #chartLine[data-v-cd7720a8]{height:320px;width:100%}.chart-wrapper .line-wrapper #chartPie[data-v-cd7720a8],.chart-wrapper .pie-wrapper #chartPie[data-v-cd7720a8]{height:330px;width:50%;padding-bottom:10px;float:right}.chart-wrapper .line-wrapper .quantity-wrapper[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper[data-v-cd7720a8]{width:50%;height:330px;padding:20px 0;box-sizing:border-box}.chart-wrapper .line-wrapper .quantity-wrapper .quantity-container[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper .quantity-container[data-v-cd7720a8]{height:100%;border-right:1px solid #bbb}.chart-wrapper .line-wrapper .quantity-wrapper .quantity-container .quantity-title[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper .quantity-container .quantity-title[data-v-cd7720a8]{font-size:15px;color:#949494;padding:70px 0 15px;text-align:center}.chart-wrapper .line-wrapper .quantity-wrapper .quantity-container .quantity-total[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper .quantity-container .quantity-total[data-v-cd7720a8]{font-size:30px;font-weight:600;margin-bottom:20px;text-align:center}.chart-wrapper .line-wrapper .quantity-wrapper .quantity-container .quantity-subtitle[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper .quantity-container .quantity-subtitle[data-v-cd7720a8]{font-size:15px;color:#949494;display:inline-block;width:50%;text-align:right;margin-right:10px}.chart-wrapper .line-wrapper .quantity-wrapper .quantity-container .quantity-lastday[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper .quantity-container .quantity-lastday[data-v-cd7720a8]{font-weight:600;font-size:15px}.chart-wrapper .line-wrapper .quantity-wrapper .quantity-container .quantity-circleradio[data-v-cd7720a8],.chart-wrapper .pie-wrapper .quantity-wrapper .quantity-container .quantity-circleradio[data-v-cd7720a8]{font-weight:600;color:red;font-size:15px}.chart-wrapper .pie-wrapper[data-v-cd7720a8]{margin-top:10px}",""])},1445:function(t,e,a){var i=a(1315);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(540)("90bad1ba",i,!0)},1446:function(t,e,a){var i=a(1316);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(540)("c4c2051e",i,!0)},1589:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-content"},[a("div",{staticClass:"toolBox"},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.handletimerange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("el-radio-button",{attrs:{label:1}},[t._v("\n        日\n      ")]),t._v(" "),a("el-radio-button",{attrs:{label:2}},[t._v("\n        周\n      ")]),t._v(" "),a("el-radio-button",{attrs:{label:3}},[t._v("\n        月\n      ")]),t._v(" "),a("el-radio-button",{attrs:{label:4}},[t._v("\n        年\n      ")])],1),t._v(" "),1===t.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions1,size:"small"},on:{change:t.handleformatTime},model:{value:t.day,callback:function(e){t.day=e},expression:"day"}}):2===t.type?a("el-date-picker",{attrs:{"picker-options":t.pickerOptions,type:"week",size:"small",format:"yyyy 第 WW 周",placeholder:"选择周"},on:{change:t.handleformatTime},model:{value:t.week,callback:function(e){t.week=e},expression:"week"}}):3===t.type?a("el-date-picker",{attrs:{type:"month",size:"small","value-format":"yyyy-M","picker-options":t.pickerOptions1,placeholder:"选择月"},on:{change:t.handleformatTime},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}}):a("el-date-picker",{attrs:{type:"year",size:"small",placeholder:"选择年","picker-options":t.pickerOptions1,"value-format":"yyyy"},on:{change:t.handleformatTime},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}}),t._v(" "),a("el-button",{staticClass:"check",staticStyle:{float:"right"},attrs:{size:"small"},nativeOn:{click:function(e){return t.comparison(e)}}},[t._v("\n      "+t._s(1===t.type?"对比昨日":2===t.type?"对比上周":3===t.type?"对比上月":"对比去年")+"\n    ")])],1),t._v(" "),a("div",{staticClass:"chart-wrapper"},[t._m(0),t._v(" "),a("div"),t._v(" "),a("div",{staticClass:"pie-wrapper bg-fff"},[a("div",{attrs:{id:"chartPie"}}),t._v(" "),a("div",{staticClass:"quantity-wrapper"},[a("div",{staticClass:"quantity-container"},[a("div",{staticClass:"quantity-title"},[t._v("\n            总客流(人)\n          ")]),t._v(" "),a("div",{staticClass:"quantity-total"},[t._v("\n            "+t._s(t.currentTotal)+"\n          ")]),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("span",{staticClass:"quantity-subtitle"},[t._v(t._s(1===t.type?"昨日":2===t.type?"上周":3===t.type?"上月":"去年")+"客流：")]),a("span",{staticClass:"quantity-lastday"},[t._v(t._s(t.lastTotal))])]),t._v(" "),a("div",[a("span",{staticClass:"quantity-subtitle"},[t._v("环比：")]),a("span",{staticClass:"quantity-circleradio"},[t._v(t._s(t.circleRadio)+"%")])])])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"line-wrapper bg-fff"},[a("div",{attrs:{id:"chartLine"}})])}]}},642:function(t,e,a){a(1446),a(1445);var i=a(38)(a(1139),a(1589),"data-v-cd7720a8",null);t.exports=i.exports},710:function(t,e,a){"use strict";a.d(e,"y",function(){return n}),a.d(e,"x",function(){return r}),a.d(e,"m",function(){return s}),a.d(e,"b",function(){return l}),a.d(e,"h",function(){return o}),a.d(e,"c",function(){return c}),a.d(e,"w",function(){return h}),a.d(e,"a",function(){return p}),a.d(e,"l",function(){return d}),a.d(e,"i",function(){return u}),a.d(e,"j",function(){return m}),a.d(e,"k",function(){return y}),a.d(e,"e",function(){return f}),a.d(e,"f",function(){return w}),a.d(e,"d",function(){return T}),a.d(e,"g",function(){return v}),a.d(e,"n",function(){return g}),a.d(e,"o",function(){return x}),a.d(e,"p",function(){return b}),a.d(e,"q",function(){return D}),a.d(e,"r",function(){return k}),a.d(e,"s",function(){return q}),a.d(e,"t",function(){return M}),a.d(e,"u",function(){return C}),a.d(e,"v",function(){return _});var i=a(32),n=function(t){return i.a.get("/api/model/getchild",{params:{project:t}})},r=function(t,e,a,n,r,s){return i.a.get("/api/model/queryDeviceInfo",{params:{project:t,sid:e,model:a,inp:n,num:r,page:s}})},s=function(t,e,a,n,r,s,l){return i.a.get("/api/model/getTableList",{params:{project:t,sid:e,mname:a,model:n,page:r,num:s,pname:l}})},l=function(t,e){return i.a.get("/api/model/getTab",{params:{project:t,sid:e}})},o=function(t,e,a,n){return i.a.get("/api/Report/dataInfo",{params:{id:t,start:e,end:a,tmes:n}})},c=function(t,e,a,n,r,s){return i.a.get("/api/model/getCard",{params:{project:t,sid:e,model:a,inp:n,page:r,num:s}})},h=function(t){return i.a.post("/api/model/alarmTable",t)},p=function(t){return i.a.post("/api/model/showTable",t)},d=function(t){return i.a.post("/api/model/queryPoint",t)},u=function(t,e,a,n,r){return i.a.get("/api/model/GetDmplist",{params:{project:t,sid:e,startTime:a,endTime:n,type:r}})},m=function(t,e,a,n){return i.a.get("/api/model/GetArealist",{params:{project:t,sid:e,startTime:a,endTime:n}})},y=function(t,e,a,n,r){return i.a.get("/api/model/GetPersonlist",{params:{project:t,sid:e,startTime:a,endTime:n,type:r}})},f=function(t){return i.a.post("/api/car/getCarList",t)},w=function(t){return i.a.get("/api/car/getCarInfo",{params:{id:t}})},T=function(t){return i.a.get("/api/car/getdataInfo",{params:{id:t}})},v=function(t){return i.a.post("/api/car/updateCarInfo",t)},g=function(t){return i.a.get("/api/model/getSymbol",{params:{mtid:t}})},x=function(t){return i.a.get("/api/model/deviceInfo",{params:{mtid:t}})},b=function(t){return i.a.get("/api/model/contact",{params:{mtid:t}})},D=function(t,e){return i.a.get("/api/model/normal",{params:{pid:t,mtid:e}})},k=function(t,e,a,n){return i.a.get("/api/Report/dataInfo",{params:{pid:t,start:e,end:a,tmes:n}})},q=function(t){return i.a.post("/api/alarm/",t)},M=function(t){return i.a.get("/api/DeviceInfo/QueryModbus",{params:{Id:t}})},C=function(t){return i.a.post("/api/DeviceInfo/saveModbus",t)},_=function(t,e){return i.a.get("/api/model/updateSymbol",{params:{sid:t,write:e}})}}});