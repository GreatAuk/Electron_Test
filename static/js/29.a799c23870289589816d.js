webpackJsonp([29],{1085:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(93),r=a.n(n),s=a(132),i=a.n(s),o=a(723),l=a(903),u=a(840),c=(a(711),a(722));t.default={data:function(){var e=this,t=function(t,n,r){"3"===e.gatewayForm.type?/^[a-zA-Z\d]+$/.test(n)?r():r(new Error("由字母、数字组成")):/^[a-zA-Z0-9_-]{16}$/.test(n)?a.i(o.v)(n).then(function(e){e.data?r():r(new Error("该序列号已存在"))}):r(new Error("16位（字母，数字组合）"))};return{tcpTableLoading:!1,tcpAddLoading:!1,tcpSenserTable:[],tcpSenserData:[],stepActive:0,projectOptions:this.$store.state.app.proList,pointTypeOptions:[],gatewayForm:{name:"",project:"",serialNumber:"",method:"",type:"1",pwd:"",account:""},gatewayFormRules:{type:[{required:!0,message:"请选择网关类型",trigger:"change"}],name:[{required:!0,message:"请输入项目名称",trigger:"blur"}],project:[{required:!0,message:"请选择所属项目",trigger:"change"}],serialNumber:[{required:!0,message:"请输入网关序列号",trigger:"blur"},{validator:t,trigger:"blur"}],method:[{required:!0,message:"请选择配置方式",trigger:"change"}]},templates:[],templateOptions:[],tableLoading:!1,templateList:[],templateDialog:!1,currentTemplate:{},multipleSelection:[],senserData:[],senserTable:[],senserPagination:{total:0,currentPage:1,pageSize:20},tcpSenserPagination:{total:0,currentPage:1,pageSize:20},senserInfo:{name:"",project:"",serialNumber:"",number:""},batchAddDialog:!1,batchAddForm:{sensorName:"",sensorTypeId:"",decimal:"",address:"",bias:"",funcode:"",datatype:"",orderStr:"",field1:"",field2:"",field3:"",field4:"",unit:"",cycle:"",datas:"",addCount:"",increment:1},batchAddFormRule:{bias:[{type:"number",message:"请输入一个 0-65535 之间的整数",trigger:"blur"}]},addLoading:!1}},mounted:function(){this.fetchTemplateOptions()},methods:{switchGatewayType:function(e){this.$refs.gatewayForm.resetFields(),this.gatewayForm.type=e},nextStep:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;if("3"!==t.gatewayForm.type)t.stepActive+=1,a.i(c.e)(t.gatewayForm.project).then(function(e){var n=JSON.parse(e.data);t.pointTypeOptions=[{label:"状态量",options:n.State},{label:"模拟量",options:n.Analog}],"2"===t.gatewayForm.type&&(a.i(u.d)(t.tcpSenserData,t.gatewayForm.type,3),t.tcpSenserPagination.currentPage=1,t.handleSenserCurrentChange(1))}).catch(function(e){t.$message.error("服务器错误")});else{var n=t.gatewayForm,r=n.serialNumber,s=n.pwd,i=n.account,o=n.project,d=n.name;a.i(l.d)({deviceNo:r,deviceUserName:i,deviceUserPwd:s}).then(function(e){var n=e.data;200===n.Code?a.i(l.e)({deviceName:d,deviceNo:r,deviceUserName:i,deviceUserPwd:s,pid:o,uid:t.$store.state.app.userInfo.uid}).then(function(e){200===e.data.Code&&(t.stepActive=4)}).catch(function(e){t.$message.error("网关添加失败")}):t.$message.error(n.Message)}).catch(function(e){})}})},previousStep:function(){this.stepActive-=1},handleSenserCurrentChange:function(e){"1"===this.gatewayForm.type?(this.senserPagination.total=this.senserData.length,this.senserTable=this.senserData.slice((e-1)*this.senserPagination.pageSize,(e-1)*this.senserPagination.pageSize+this.senserPagination.pageSize)):(this.tcpSenserPagination.total=this.tcpSenserData.length,this.tcpSenserTable=this.tcpSenserData.slice((e-1)*this.tcpSenserPagination.pageSize,(e-1)*this.tcpSenserPagination.pageSize+this.tcpSenserPagination.pageSize))},submitGateway:function(){var e=this,t={};a.i(u.b)(this.senserData),this.$nextTick(function(){if("custom"===e.gatewayForm.method){var n=null;if(n="2"===e.gatewayForm.type?a.i(u.b)(e.tcpSenserData,e.gatewayForm.type):a.i(u.b)(e.senserData),n.errPages.length)return e.$notify({title:"警告",message:"请修复第 "+n.errPages.join(", ")+" 页的错误",type:"warning",duration:1e4}),!1;e.addLoading=!0,t.sensorItem=[];for(var s=0;s<e.senserData.length;s++){var l={};l.decimal=e.senserData[s].decimal.value,l.sensorId=e.senserData[s].sensorId?e.senserData[s].sensorId:"",l.lastUpdateDate="",l.sensorName=e.senserData[s].sensorName.value,l.sensorTypeId=e.senserData[s].sensorTypeId.value,l.unit=e.senserData[s].unit.value,""===e.senserData[s].field1.value?(l.field1="",l.field2="",l.field3="",l.field4=""):(l.field1=e.senserData[s].field1.value,l.field2=e.senserData[s].field2.value,l.field3=e.senserData[s].field3.value,l.field4=e.senserData[s].field4.value),l.address=e.senserData[s].address.value,l.bias=e.senserData[s].bias.value,l.funcode=e.senserData[s].funcode.value,l.datatype=e.senserData[s].datatype.value,l.modbusId=e.senserData[s].modbusId?e.senserData[s].modbusId:"",l.datas=e.senserData[s].datas.value.toString(),l.orderStr=e.senserData[s].orderStr.value,l.cycle=e.senserData[s].cycle.value,l.iswrite="0",l.iocUrl="",l.isLine="0",l.isOpen="0",l.lastUpdateDate="",l.switcher="",l.tag="",l.pointType="1",l.symbol="",l.createDate=(new Date).format("yyyy-MM-dd hh:mm:ss"),t.sensorItem.push(l)}if(!t.sensorItem.length)return e.$message("请确保最少有一条传感器记录"),void(e.addLoading=!1);t.userId="40",t.defaultTime="120",t.agreement="modbus",t.faultDelay="",t.isShare="0",t.userKey="7a29438732d24d259712c231eb4d63a0",t.uid=JSON.parse(sessionStorage.getItem("userInfo")).uid,t.linktype="modbus",t.deviceName=e.gatewayForm.name,t.remark=e.gatewayForm.serialNumber,t.pid=e.gatewayForm.project,t.deviceId="",t.type=0}else if("template"===e.gatewayForm.method){if(!e.templateList.length)return e.$message("请最少选择一个要添加的模板"),!1;e.addLoading=!0,t.userId="40",t.defaultTime="120",t.agreement="modbus",t.faultDelay="",t.isShare="0",t.userKey="7a29438732d24d259712c231eb4d63a0",t.uid=JSON.parse(sessionStorage.getItem("userInfo")).uid,t.linktype="modbus",t.deviceName=e.gatewayForm.name,t.remark=e.gatewayForm.serialNumber,t.pid=e.gatewayForm.project,t.deviceId="",t.type=1,t.sensorItem=[],e.templateList.forEach(function(e){var a;(a=t.sensorItem).push.apply(a,i()(e.value.sensorItem))}),t.sensorItem.forEach(function(e){e.iswrite="0",e.iocUrl="",e.isLine="0",e.isOpen="0",e.lastUpdateDate="",e.switcher="",e.pointType="2",e.symbol="",e.tag="",e.createDate=(new Date).format("yyyy-MM-dd hh:mm:ss")})}e.senserInfo.name=t.deviceName,e.senserInfo.serialNumber=t.remark,e.senserInfo.number=t.sensorItem.length,e.senserInfo.project=e.projectOptions.filter(function(e){return e.id===t.pid})[0].label,a.i(o.L)({data:r()(t)}).then(function(t){var a=JSON.parse(t.data);"00"===a.flag?(e.$message({message:"添加成功",type:"success"}),setTimeout(function(){e.stepActive=4},600)):e.$message(a.msg)}).catch(function(t){e.$message.error("服务器错误，添加失败")}).then(function(t){e.addLoading=!1})})},submitTcpGateway:function(){var e=this,t={};a.i(u.b)(this.tcpSenserData,this.gatewayForm.type),this.$nextTick(function(){if(0!==document.querySelectorAll(".error").length)return e.$message("请确保提交的数据不存在错误再提交"),!1;e.tcpAddLoading=!0,t.PointList=[];for(var n=0;n<e.tcpSenserData.length;n++){var r={};r.Decimal=e.tcpSenserData[n].decimal.value,r.PointName=e.tcpSenserData[n].sensorName.value,r.PointType=e.tcpSenserData[n].sensorTypeId.value,r.Unit=e.tcpSenserData[n].unit.value,r.Channel=n+1,""===e.tcpSenserData[n].field1.value?r.Map="":r.Map=e.tcpSenserData[n].field1.value+","+e.tcpSenserData[n].field2.value+","+e.tcpSenserData[n].field3.value+","+e.tcpSenserData[n].field4.value,t.PointList.push(r)}if(!t.PointList.length)return e.$message("请确保最少有一条传感器记录"),void(e.tcpAddLoading=!1);t.DvcName=e.gatewayForm.name,t.DvcNo=e.gatewayForm.serialNumber,t.ProjectID=e.gatewayForm.project,e.senserInfo.name=t.DvcName,e.senserInfo.serialNumber=t.DvcNo,e.senserInfo.number=t.PointList.length,e.senserInfo.project=e.projectOptions.filter(function(e){return e.id===t.ProjectID})[0].label,a.i(o.w)(t).then(function(t){t.data?(e.$message({message:"添加成功",type:"success"}),setTimeout(function(){e.stepActive=4},600)):e.$message.error("添加失败")}).finally(function(){e.tcpAddLoading=!1})})},addressInputClick:function(e){e.target.parentNode.querySelector("input").style.display="inline-block",e.target.parentNode.querySelector("input").focus(),e.target.parentNode.querySelector("span").style.display="none"},addressInputBlur:function(e,t,a){if(t=Number(t),isNaN(t)||t>255||t<1)return this.$message({message:"请输入一个 1-255 的整数",showClose:!0,type:"error",duration:0}),t="",!1;this.templateList[a].value.sensorItem.forEach(function(e){e.address=t}),e.target.parentNode.querySelector("span").style.display="block",e.target.parentNode.querySelector("input").style.display="none"},openTemplateDialog:function(e){this.currentTemplate=JSON.parse(r()(e)),this.currentTemplate.value.sensorItem.forEach(function(e){e.sensorName={value:e.sensorName,msg:""},e.cycle={value:e.cycle,msg:""}}),this.templateDialog=!0},submitTemplate:function(){var e=this;this.currentTemplate.value.sensorItem.forEach(function(e){""===e.sensorName.value&&(e.sensorName.msg="值不能为空"),a.i(u.g)(e.cycle.value)?10!=e.cycle.value&&30!=e.cycle.value&&e.cycle.value%60!=0&&(e.cycle.msg="采集周期应该为10秒 / 30秒 / 60的倍数"):e.cycle.msg="采集周期应该为10秒 / 30秒 / 60的倍数"}),this.$nextTick(function(){0===document.querySelectorAll(".error").length&&(e.templateDialog=!1,setTimeout(function(){e.currentTemplate.value.sensorItem.forEach(function(e){e.sensorName=e.sensorName.value,e.cycle=e.cycle.value}),e.templateList.forEach(function(t){t.id===e.currentTemplate.id&&(t.value.sensorItem=e.currentTemplate.value.sensorItem)})},200))})},clickAddRow:function(){"1"===this.gatewayForm.type?(a.i(u.d)(this.senserData),this.senserPagination.currentPage=1):(a.i(u.d)(this.tcpSenserData,this.gatewayForm.type),this.tcpSenserPagination.currentPage=1),this.handleSenserCurrentChange(1)},handleSelectionChange:function(e){this.multipleSelection=e},batchDel:function(){if(!this.multipleSelection.length)return this.$message("请至少选中一行"),!1;if(this.multipleSelection.length===this.senserData.length)return this.$message("请确保最少有一条点位记录"),!1;var e=this.multipleSelection.map(function(e){return e.flag});this.senserData=this.senserData.filter(function(t){return!(e.indexOf(t.flag)>-1)}),this.handleSenserCurrentChange(this.senserPagination.currentPage)},batchPaste:function(){if(!this.multipleSelection.length)return this.$message("请至少选中一行"),!1;a.i(u.e)(this.senserData,JSON.parse(r()(this.multipleSelection))),this.senserPagination.currentPage=1,this.handleSenserCurrentChange(1),this.$refs["custom-table"].clearSelection(),this.$message.success("已成功复制指定行至列表头部")},batchAdd:function(){var e=this;this.$refs.batchAddForm.validate(function(t){if(!t)return!1;for(var a,n=[],r=e.batchAddForm,s=e.batchAddForm.bias,i=0;i<e.batchAddForm.addCount;i++)n.push({sensorName:{value:r.sensorName,msg:""},sensorTypeId:{value:r.sensorTypeId,msg:""},decimal:{value:r.decimal,msg:""},unit:{value:r.unit,msg:""},field1:{value:r.field1,msg:""},field2:{value:r.field2,msg:""},field3:{value:r.field3,msg:""},field4:{value:r.field4,msg:""},address:{value:r.address,msg:""},funcode:{value:r.funcode,msg:""},bias:{value:s,msg:""},datatype:{value:r.datatype,msg:""},orderStr:{value:r.orderStr,msg:""},datas:{value:r.datas,msg:""},cycle:{value:r.cycle,msg:""},pointType:"1",editable:!1,flag:Math.random()}),s=Number(s)+e.batchAddForm.increment;(a=e.senserData).unshift.apply(a,n),e.handleSenserCurrentChange(1),e.batchAddDialog=!1})},batchAddDialogClose:function(){this.batchAddForm={sensorName:"",sensorTypeId:"",decimal:"",address:"",bias:"",funcode:"",datatype:"",orderStr:"",field1:"",field2:"",field3:"",field4:"",unit:"",cycle:"",datas:"",addCount:"",increment:1}},handleCellClick:function(e,t,a,n){if(a.querySelector(".cell-value")){a.querySelector(".cell-value").style.display="none";a.querySelector(".cell-input").style.display="inline-block",a.querySelector(".not-el-input")&&a.querySelector(".not-el-input").select()}return!1},downloadTemplate:function(){window.location.href=_host+"/file/New_Template.xlsx"},uploadExcel:function(e){var t=this,n=new FileReader;n.onload=function(n){var r,s=n.target.result,o=XLSX.read(s,{type:"binary"});(r=t.senserData).unshift.apply(r,i()(a.i(u.c)(t.toJson(o).Sheet1,"fromExcel",t.pointTypeOptions)));var l=a.i(u.b)(t.senserData);t.senserPagination.currentPage=1,t.handleSenserCurrentChange(1),l.errPages.length&&t.$notify({title:"警告",message:"请修复第 "+l.errPages.join(", ")+" 页的错误",type:"warning",duration:1e4}),e.target.value=""},setTimeout(function(){e.target.value=""},2e3),n.readAsBinaryString(e.target.files[0])},deleteSenser:function(e,t){var a=this;if(1===this.senserData.length||1===this.tcpSenserTable.length)return void this.$message("请确保最少有一条传感器记录");this.$confirm("确认要删除该点位？","提示",{type:"warning"}).then(function(){"1"===a.gatewayForm.type?(a.senserData.splice(20*(a.senserPagination.currentPage-1)+e,1),a.handleSenserCurrentChange(a.senserPagination.currentPage)):(a.tcpSenserData.splice(20*(a.tcpSenserPagination.currentPage-1)+e,1),a.handleSenserCurrentChange(a.tcpSenserPagination.currentPage))})},handleCheckData:function(){var e=null;e="2"===this.gatewayForm.type?a.i(u.b)(this.tcpSenserData,this.gatewayForm.type):a.i(u.b)(this.senserData),e.errPages.length?this.$notify({title:"警告",message:"请修复第 "+e.errPages.join(", ")+" 页的错误",type:"warning",duration:1e4}):this.$message.success("点位数据无冲突")},clickEdit:function(e){e.editable=!e.editable,e.editable||("2"===this.gatewayForm.type?a.i(u.b)([e],this.gatewayForm.type):a.i(u.b)([e]))},copyRow:function(e){"1"===this.gatewayForm.type?(a.i(u.f)(this.senserData,JSON.parse(r()(e))),this.senserPagination.currentPage=1):(a.i(u.f)(this.tcpSenserData,JSON.parse(r()(e)),this.gatewayForm.type),this.tcpSenserPagination.currentPage=1),this.handleSenserCurrentChange(1),this.$message.success("已成功复制指定行至列表头部")},shortcutField:function(e,t,a,n,r){e.field1={value:t,msg:""},e.field2={value:a,msg:""},e.field3={value:n,msg:""},e.field4={value:r,msg:""}},handleBlur:function(e,t){t.msg=""},handleChange:function(e,t){return e[t].msg="","sensorTypeId"===t?(e.decimal.msg="",e.unit.msg="",e.unit.value="",this.pointTypeOptions[0].options.forEach(function(t){t.ID===e.sensorTypeId.value&&(e.typeSection="state",e.decimal.value="")}),this.pointTypeOptions[1].options.forEach(function(t){if(t.ID===e.sensorTypeId.value){e.typeSection="simulate",e.decimal.value=0;var a=[];t.Value&&(a=t.Value.split("|")),e.unitOptions=a}}),!1):("funcode"===t&&(1!==e.funcode.value&&2!==e.funcode.value||(e.datatype.value=7,e.datatype.msg="",e.orderStr.value="",e.orderStr.msg="",e.datas.value="",e.datas.msg="")),"datatype"===t&&""!==e.datas.msg?(6===e.datatype.value&&e.datas.value&&(e.datas.msg=""),6===e.datatype.value||e.datas.value||(e.datas.msg=""),!1):void("datatype"===t&&(1===e.datatype.value||2===e.datatype.value||6===e.datatype.value?e.orderStr={value:"AB",msg:""}:7===e.datatype.value?e.orderStr={value:"",msg:""}:e.orderStr={value:"ABCD",msg:""})))},addAgain:function(){this.$refs.gatewayForm.resetFields(),this.stepActive=0,"1"===this.gatewayForm.type?this.senserData=[]:this.tcpSenserData=[]},fetchTemplateOptions:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.i(o.M)(t).then(function(t){var a=JSON.parse(t.data);a.success?e.templateOptions=a.list:e.templateOptions=[]}).catch(function(e){})},fetchTemplate:function(e){var t=this;if(!this.templates.length)return this.templateList=[],!1;e||(this.tableLoading=!0,a.i(o.z)(this.templates.join(",")).then(function(e){var a=JSON.parse(e.data);a.success?(t.templateList=a.list,t.templateList.forEach(function(e){t.$set(e,"address","")})):t.templateList=[]}).catch(function(e){}).then(function(){t.tableLoading=!1}))},getPointTypeLabel:function(e){var t="";return this.pointTypeOptions[0].options.forEach(function(a){a.ID===e&&(t=a.TypeName)}),this.pointTypeOptions[1].options.forEach(function(a){a.ID===e&&(t=a.TypeName)}),t},toJson:function(e){var t=[];return e.SheetNames.forEach(function(a){var n=XLSX.utils.sheet_to_row_object_array(e.Sheets[a]);n.length>0&&(t[a]=n)}),t},s2ab:function(e){var t=void 0;if("undefined"!=typeof ArrayBuffer){t=new ArrayBuffer(e.length);for(var a=new Uint8Array(t),n=0;n!==e.length;++n)a[n]=255&e.charCodeAt(n);return t}t=new Array(e.length);for(var r=0;r!==e.length;++r)t[r]=255&e.charCodeAt(r);return t}}}},1294:function(e,t,a){t=e.exports=a(539)(),t.push([e.i,"@keyframes shine{0%{box-shadow:0 0 0 0 rgba(235,10,10,.4)}to{box-shadow:0 0 0 10px hsla(0,7%,53%,0)}}.el-input-padding-0 input{padding:0 2px}.template-select .el-tag__close{display:none}.error-type{font-weight:600}.popover-visibility{visibility:hidden}.template-set-dialog{width:691px}.batch-add-dialog{width:690px}.gmdialogtable input{padding:5px}.gmdialogtable div.cell{padding-left:6px;padding-right:6px}.tooltip-info-wrap{line-height:1.9}.tooltip-info-wrap .tooltip-title{border-bottom:1px dotted #c4c5c5;margin:10px 0}.tooltip-info-wrap p{padding-left:10px}.tcpSelectWrap{max-width:550px}",""])},1295:function(e,t,a){t=e.exports=a(539)(),t.push([e.i,'.addGateway[data-v-8b8468aa]{border-radius:4px;overflow:hidden}.step-wrap[data-v-8b8468aa]{margin:25px auto 40px}.step-wrap .el-steps[data-v-8b8468aa]{-ms-flex-pack:center;justify-content:center}.step-wrap .el-step[data-v-8b8468aa]:last-child{-ms-flex-preferred-size:50px!important;flex-basis:50px!important}.basic-form[data-v-8b8468aa]{width:450px;margin:auto}.basic-form .el-select[data-v-8b8468aa]{display:block}.icon-what[data-v-8b8468aa]{transform:translateY(3px);margin-left:10px;width:18px;height:18px;cursor:pointer}.icon-what[data-v-8b8468aa]:hover{color:#399}.gateway-set-template[data-v-8b8468aa]{width:900px;margin:auto}.template-select[data-v-8b8468aa]{width:400px}.gateway-set-custom[data-v-8b8468aa]{padding:15px}.file-btn[data-v-8b8468aa]{position:relative;overflow:hidden}.file-btn input[data-v-8b8468aa]{position:absolute;top:0;right:0;left:0;bottom:0;opacity:0}.field-wrap[data-v-8b8468aa]{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.field-wrap .el-dropdown[data-v-8b8468aa]{font-size:10px}.shortcut-field[data-v-8b8468aa]{padding:5px;color:#399;cursor:pointer}.error[data-v-8b8468aa]{width:100%;height:28px;outline-style:none}.error[data-v-8b8468aa]:after{content:"";display:inline-block;width:6px;height:6px;background:red;border-radius:50%;position:absolute;right:17px;top:50%;transform:translateY(-50%);animation:shine 2s linear infinite}.el-table .cell[data-v-8b8468aa]{height:36px;line-height:36px}.cell-input[data-v-8b8468aa]{display:none}.cell-input input[data-v-8b8468aa]{padding-left:7px;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;background-image:none;border-radius:4px;border:1px solid #bfcbd9;box-sizing:border-box;color:#1f2d3d;font-size:inherit;line-height:28px;height:28px;outline:none;transition:border-color .2s cubic-bezier(.645,.045,.355,1);width:100%}.cell-input input[data-v-8b8468aa]:focus{outline:none;border-color:#399}.table-head[data-v-8b8468aa]{text-align:right;margin:15px 5px}.table-head .title[data-v-8b8468aa]{font-size:18px;float:left}#senserTable .el-select input[data-v-8b8468aa]{height:25px}#senserTable .cell [data-v-8b8468aa]{outline:none}.input-field1[data-v-8b8468aa]{position:relative}.input-field1[data-v-8b8468aa]:after{content:"";display:inline-block;position:absolute;top:20px;right:-21px;width:12px;height:1px;background:#bfd7d9}.input-field2[data-v-8b8468aa]{position:relative}.input-field2 .icon[data-v-8b8468aa]{position:absolute;right:-5px;top:12px;fill:#bfd7d9;width:18px;height:18px}.input-field3[data-v-8b8468aa]{position:relative}.input-field3[data-v-8b8468aa]:after{content:"";display:inline-block;position:absolute;top:20px;right:-3px;width:12px;height:1px;background:#bfd7d9}.add-complete[data-v-8b8468aa]{width:450px;margin:auto}.ok-icon[data-v-8b8468aa]{text-align:center}.ok-icon i[data-v-8b8468aa]{font-size:70px;color:#259b24}.ok-text[data-v-8b8468aa]{font-size:18px;text-align:center;margin:20px 0;letter-spacing:3px}.gateway-info[data-v-8b8468aa]{padding:20px 40px;background:#fafafa}.info-list[data-v-8b8468aa]{padding:7px}.btn-wrap[data-v-8b8468aa]{text-align:center;margin:20px}.btn-wrap .el-button+.el-button[data-v-8b8468aa]{margin-left:30px}',""])},1424:function(e,t,a){var n=a(1294);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(540)("7c92f33c",n,!0)},1425:function(e,t,a){var n=a(1295);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(540)("1bab5444",n,!0)},1574:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-backgroundConfig pdg2"},[a("div",{staticClass:"addGateway bg-fff"},[a("div",{staticClass:"title-wrap"},[a("h3",[a("c-svg",{staticStyle:{color:"#339999"},attrs:{name:"plus","class-name":"title-icon"}}),e._v(" "),a("span",{staticClass:"text"},[e._v("添加网关")])],1)]),e._v(" "),a("div",{staticClass:"step-wrap"},[a("el-steps",{attrs:{space:250,"finish-status":"success",active:e.stepActive}},[a("el-step",{attrs:{title:"填写基本信息"}}),e._v(" "),"3"!==e.gatewayForm.type?a("el-step",{attrs:{title:"配置网关点位"}}):e._e(),e._v(" "),a("el-step",{attrs:{title:"完成"}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.stepActive,expression:"stepActive === 0"}],staticClass:"basic-form"},[a("el-form",{ref:"gatewayForm",attrs:{model:e.gatewayForm,rules:e.gatewayFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"网关类型",prop:"type"}},[a("el-select",{attrs:{prop:"type",placeholder:"请选择网关类型"},on:{change:e.switchGatewayType},model:{value:e.gatewayForm.type,callback:function(t){e.$set(e.gatewayForm,"type","string"==typeof t?t.trim():t)},expression:"gatewayForm.type"}},[a("el-option",{attrs:{label:"Modbus网关",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"TCP网关",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"MQTT网关",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"网关名称",prop:"name"}},[a("el-input",{model:{value:e.gatewayForm.name,callback:function(t){e.$set(e.gatewayForm,"name","string"==typeof t?t.trim():t)},expression:"gatewayForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"网关序列号",prop:"serialNumber"}},[a("el-input",{model:{value:e.gatewayForm.serialNumber,callback:function(t){e.$set(e.gatewayForm,"serialNumber","string"==typeof t?t.trim():t)},expression:"gatewayForm.serialNumber"}})],1),e._v(" "),"3"===e.gatewayForm.type?a("el-form-item",{attrs:{label:"网关用户名",prop:"account",rules:[{required:"3"===e.gatewayForm.type,message:"请输入网关用户名",trigger:"blur"}]}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.gatewayForm.account,callback:function(t){e.$set(e.gatewayForm,"account","string"==typeof t?t.trim():t)},expression:"gatewayForm.account"}}),e._v(" "),a("input",{staticStyle:{position:"absolute",top:"-1000px"},attrs:{type:"text"}})],1):e._e(),e._v(" "),"3"===e.gatewayForm.type?a("el-form-item",{attrs:{label:"网关密码",prop:"pwd",rules:[{required:"3"===e.gatewayForm.type,message:"请输入网关密码",trigger:"blur"}]}},[a("input",{staticStyle:{position:"absolute",top:"-1000px"},attrs:{type:"password"}}),e._v(" "),a("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.gatewayForm.pwd,callback:function(t){e.$set(e.gatewayForm,"pwd","string"==typeof t?t.trim():t)},expression:"gatewayForm.pwd"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"所属项目",prop:"project"}},[a("el-select",{attrs:{prop:"project",placeholder:"请选择项目"},model:{value:e.gatewayForm.project,callback:function(t){e.$set(e.gatewayForm,"project","string"==typeof t?t.trim():t)},expression:"gatewayForm.project"}},e._l(e.projectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.id}})}),1)],1),e._v(" "),"1"===e.gatewayForm.type?a("el-form-item",{attrs:{label:"配置方式",prop:"method"}},[a("el-radio-group",{model:{value:e.gatewayForm.method,callback:function(t){e.$set(e.gatewayForm,"method",t)},expression:"gatewayForm.method"}},[a("el-radio",{attrs:{label:"template"}},[e._v("\n              从模板中添加\n            ")]),e._v(" "),a("el-radio",{attrs:{label:"custom"}},[e._v("\n              自定义\n            ")])],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{staticStyle:{"line-height":"25px"},attrs:{slot:"content"},slot:"content"},[e._v("\n              从模版添加：通过选择系统内置模版或用户模版来进行网关参数配置"),a("br"),e._v("\n              自定义：自由添加网关参数点位\n            ")]),e._v(" "),a("c-svg",{attrs:{name:"what","class-name":"icon-what"}})],1)],1):e._e(),e._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{nativeOn:{click:function(t){return e.$router.go(-1)}}},[e._v("\n            返 回\n          ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.nextStep("gatewayForm")}}},[e._v("\n            "+e._s("3"===e.gatewayForm.type?"保 存":"下一步")+"\n          ")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.stepActive&&"template"===e.gatewayForm.method,expression:"stepActive === 1 && gatewayForm.method === 'template'"}],staticClass:"gateway-set-template"},[a("div",{staticStyle:{"text-align":"center","margin-bottom":"25px"}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v("选择模板（多选）：")]),e._v(" "),a("el-select",{staticClass:"template-select",attrs:{multiple:"",filterable:"",placeholder:"请选择模板"},on:{"visible-change":e.fetchTemplate},model:{value:e.templates,callback:function(t){e.templates=t},expression:"templates"}},e._l(e.templateOptions,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),a("el-alert",{staticStyle:{"margin-bottom":"15px"},attrs:{"show-icon":"",title:"注意：  修改从站地址后，对应模板下所有点位的从站地址都会更新",type:"info","close-text":"知道了"}}),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":"请选择模板","element-loading-text":"加载中...",data:e.templateList}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"模板名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"从站地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{display:"block",cursor:"pointer",height:"30px","line-height":"30px"},on:{click:function(t){return e.addressInputClick(t)}}},[e._v(e._s(""===t.row.address?"点击修改":t.row.address))]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.row.address,expression:"scope.row.address",modifiers:{trim:!0}}],staticStyle:{display:"none","border-radius":"4px",border:"1px solid #bfcbd9","outline-style":"none",padding:"3px"},attrs:{type:"text",placeholder:"1-255"},domProps:{value:t.row.address},on:{blur:[function(a){return e.addressInputBlur(a,t.row.address,t.$index)},function(t){return e.$forceUpdate()}],input:function(a){a.target.composing||e.$set(t.row,"address",a.target.value.trim())}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"点位数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.value.sensorItem.length)+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},nativeOn:{click:function(a){return e.openTemplateDialog(t.row)}}},[e._v("\n              编辑\n            ")])]}}])})],1),e._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{on:{click:e.previousStep}},[e._v("\n          上一步\n        ")]),e._v(" "),a("el-button",{attrs:{loading:e.addLoading,type:"primary"},on:{click:e.submitGateway}},[e._v("\n          确  认\n        ")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.stepActive&&"custom"===e.gatewayForm.method&&"1"===e.gatewayForm.type,expression:"stepActive === 1 && gatewayForm.method === 'custom' && gatewayForm.type === '1'"}],staticClass:"gateway-set-custom"},[a("div",{staticStyle:{"text-align":"right",margin:"10px"}},[a("el-tooltip",{attrs:{placement:"right"}},[a("div",{staticClass:"tooltip-info-wrap",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"tooltip-title"},[e._v("\n              唯一性\n            ")]),e._v(" "),a("p",[e._v("\n              不可同时存在两个以上具有相同从站地址、功能码、寄存器地址、地址位的传感器\n            ")]),e._v(" "),a("div",{staticClass:"tooltip-title"},[e._v("\n              映射：\n            ")]),e._v(" "),a("p",[e._v("\n              映射参数由4个数{x1,x2,x3,x4}组成,如: -1000~1000 -> -100 ~ 100 表示将原始值缩小10倍\n              "),a("br"),e._v("\n              计算公式为 [输出值] = (x4-x3)/(x2-x1)*([原始值]-x1)+x3\n            ")]),e._v(" "),a("div",{staticClass:"tooltip-title"},[e._v("\n              从站地址：\n            ")]),e._v(" "),a("p",[e._v("一个 1-255 之间的整数。")]),e._v(" "),a("div",{staticClass:"tooltip-title"},[e._v("\n              寄存器地址：\n            ")]),e._v(" "),a("p",[e._v("一个 0-65535 之间的整数。")]),e._v(" "),a("div",{staticClass:"tooltip-title"},[e._v("\n              采样周期：\n            ")]),e._v(" "),a("p",[e._v("可选择 10s/30s/60s/120s 或自定义(手动输入60的倍数)。")]),e._v(" "),a("div",{staticClass:"tooltip-title"},[e._v("\n              功能码 / 数据格式 / 字节顺序 / 地址位：\n            ")]),e._v(" "),a("p",[a("ul",[a("li",[e._v("\n                  当功能码为 01读写/02只读时，数据格式只能为 bit，字节顺序和地址位只能为 空。\n                ")]),e._v(" "),a("li",[e._v("\n                  当功能码为 03读写/04只读，数据格式为 16位有符号数(默认)/16位无符号数时，\n                  "),a("br"),e._v("\n                  字节顺序可选 AB(默认)/BA，地址位只能为空。\n                ")]),e._v(" "),a("li",[e._v("\n                  当功能码为 03读写/04只读，数据格式为 16位按位读取时，字节顺序可选 AB(默认)/BA，\n                  "),a("br"),e._v("\n                  地址位非空，默认 1。\n                ")]),e._v(" "),a("li",[e._v("\n                  当功能码为 03读写/04只读，数据格式为 32位有符号数/32位无符号数/32位浮点型数时，\n                  "),a("br"),e._v("\n                  字节顺序可选 ABCD(默认)/CDAB/BADC/DCBA，地址位只能为 空。\n                ")])])])]),e._v(" "),a("c-svg",{staticStyle:{float:"left"},attrs:{name:"what","class-name":"icon-what"}})],1),e._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light",content:"在点位列表中添加一行","open-delay":1e3}},[a("el-button",{attrs:{size:"small"},nativeOn:{click:function(t){return e.clickAddRow(t)}}},[e._v("\n            添加点位\n          ")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light"}},[a("div",{staticStyle:{"text-align":"center","font-size":"12px"},attrs:{slot:"content"},slot:"content"},[e._v("\n            通过Excel样表"),a("br"),e._v("编辑点位并上传"),a("br"),a("a",{staticStyle:{color:"#399998"},attrs:{href:"javascript:;"},on:{click:e.downloadTemplate}},[e._v("样式表下载"),a("c-svg",{attrs:{name:"download"}})],1)]),e._v(" "),a("el-button",{staticClass:"file-btn",attrs:{size:"small"}},[e._v("\n            上传Excel\n            "),a("input",{attrs:{id:"fileInput",type:"file",multiple:"false",accept:".xlsx"},on:{change:function(t){return e.uploadExcel(t)}}})])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light",content:"验证点位列表数据的正确性","open-delay":1e3}},[a("el-button",{attrs:{size:"small"},nativeOn:{click:function(t){return e.handleCheckData(t)}}},[e._v("\n            数据校验\n          ")])],1),e._v(" "),a("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{trigger:"click"}},[a("el-button",{attrs:{size:"small"}},[e._v("\n            批量操作"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.batchPaste(t)}}},[e._v("\n              批量复制\n            ")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(t){return e.batchDel(t)}}},[e._v("\n              批量删除\n            ")])],1)],1)],1),e._v(" "),a("el-table",{ref:"custom-table",staticClass:"gmdialogtable",staticStyle:{width:"100%"},attrs:{id:"senserTable","highlight-current-row":"",data:e.senserTable,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"35"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"125"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"5px"},attrs:{type:"danger",round:"",size:"mini",icon:"el-icon-delete"},nativeOn:{click:function(a){return e.deleteSenser(t.$index,t.row.sensorId)}}}),e._v(" "),a("el-button",{staticStyle:{padding:"5px"},attrs:{size:"mini",round:""},nativeOn:{click:function(a){return e.copyRow(t.row)}}},[a("c-svg",{attrs:{name:"paste"}})],1),e._v(" "),a("el-button",{staticStyle:{padding:"5px"},attrs:{type:"success",round:"",size:"mini",icon:t.row.editable?"el-icon-check":"el-icon-edit"},nativeOn:{click:function(a){return e.clickEdit(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"传感器名称","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.sensorName.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.sensorName.msg))]),e._v(" "),a("div",{class:{error:t.row.sensorName.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-input",{attrs:{size:"mini"},on:{blur:function(a){return e.handleBlur(a,t.row.sensorName)}},model:{value:t.row.sensorName.value,callback:function(a){e.$set(t.row.sensorName,"value","string"==typeof a?a.trim():a)},expression:"scope.row['sensorName'].value"}}):a("span",[e._v(e._s(t.row.sensorName.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"点位类型",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.sensorTypeId.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.sensorTypeId.msg))]),e._v(" "),a("div",{class:{error:t.row.sensorTypeId.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{filterable:"",placeholder:"请选择点位类型",size:"mini"},on:{change:function(a){return e.handleChange(t.row,"sensorTypeId")}},model:{value:t.row.sensorTypeId.value,callback:function(a){e.$set(t.row.sensorTypeId,"value",a)},expression:"scope.row['sensorTypeId'].value"}},e._l(e.pointTypeOptions,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(n){return a("el-option",{key:n.ID,attrs:{label:n.TypeName,value:n.ID}},[a("span",{staticStyle:{float:"left","margin-right":"25px"}},[e._v(e._s(n.TypeName))]),e._v(" "),"状态量"===t.label?a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(n.Value))]):e._e()])}),1)}),1):a("div",[e._v("\n                  "+e._s(e.getPointTypeLabel(t.row.sensorTypeId.value))+"\n                ")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"小数位",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.decimal.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.decimal.msg))]),e._v(" "),a("div",{class:{error:t.row.decimal.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{disabled:"state"===t.row.typeSection,size:"mini"},on:{change:function(a){return e.handleChange(t.row,"decimal")}},model:{value:t.row.decimal.value,callback:function(a){e.$set(t.row.decimal,"value",a)},expression:"scope.row['decimal'].value"}},[a("el-option",{attrs:{label:"0",value:0}}),e._v(" "),a("el-option",{attrs:{label:"1",value:1}}),e._v(" "),a("el-option",{attrs:{label:"2",value:2}}),e._v(" "),a("el-option",{attrs:{label:"3",value:3}}),e._v(" "),a("el-option",{attrs:{label:"4",value:4}})],1):a("span",[e._v(e._s(t.row.decimal.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单位",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.unit.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.unit.msg))]),e._v(" "),a("div",{class:{error:t.row.unit.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{staticClass:"inline-input",attrs:{disabled:"state"===t.row.typeSection,size:"mini",placeholder:"请选择"},on:{blur:function(a){return e.handleBlur(a,t.row.unit)}},model:{value:t.row.unit.value,callback:function(a){e.$set(t.row.unit,"value","string"==typeof a?a.trim():a)},expression:"scope.row['unit'].value"}},e._l(t.row.unitOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1):a("span",[e._v(e._s(t.row.unit.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"映射","min-width":"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.field1.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.field1.msg))]),e._v(" "),a("div",{class:{error:t.row.field1.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("div",{staticClass:"field-wrap"},[a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x1"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field1.value,callback:function(a){e.$set(t.row.field1,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field1'].value"}}),e._v("~\n                  "),a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x2"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field2.value,callback:function(a){e.$set(t.row.field2,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field2'].value"}}),e._v("→\n                  "),a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x3"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field3.value,callback:function(a){e.$set(t.row.field3,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field3'].value"}}),e._v("~\n                  "),a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x4"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field4.value,callback:function(a){e.$set(t.row.field4,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field4'].value"}}),e._v(" "),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-caret-bottom shortcut-field"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return e.shortcutField(t.row,"","","","")}}},[e._v("\n                        无\n                      ")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){return e.shortcutField(t.row,-1e3,1e3,-100,100)}}},[e._v("\n                        -1000 ~ 1000 → -100 ~ 100\n                      ")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){return e.shortcutField(t.row,-1e4,1e4,-1e3,1e3)}}},[e._v("\n                        -10000 ~ 10000 → -1000 ~ 1000\n                      ")])],1)],1)],1):a("span",[e._v(e._s(""!==t.row.field1.value?t.row.field1.value+" ~ "+t.row.field2.value+" → "+t.row.field3.value+" ~ "+t.row.field4.value:""))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"从站地址",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.address.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.address.msg))]),e._v(" "),a("div",{class:{error:t.row.address.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-input",{attrs:{size:"mini",placeholder:"1-255"},on:{blur:function(a){return e.handleBlur(a,t.row.address)}},model:{value:t.row.address.value,callback:function(a){e.$set(t.row.address,"value","string"==typeof a?a.trim():a)},expression:"scope.row['address'].value"}}):a("span",[e._v(e._s(t.row.address.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"功能码",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.funcode.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.funcode.msg))]),e._v(" "),a("div",{class:{error:t.row.funcode.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:function(a){return e.handleChange(t.row,"funcode")}},model:{value:t.row.funcode.value,callback:function(a){e.$set(t.row.funcode,"value",a)},expression:"scope.row['funcode'].value"}},[a("el-option",{attrs:{label:"01读写",value:1}}),e._v(" "),a("el-option",{attrs:{label:"02只读",value:2}}),e._v(" "),a("el-option",{attrs:{label:"03读写",value:3}}),e._v(" "),a("el-option",{attrs:{label:"04只读",value:4}})],1):a("span",[e._v(e._s(1===t.row.funcode.value?"01读写":2===t.row.funcode.value?"02只读":3===t.row.funcode.value?"03读写":4===t.row.funcode.value?"04只读":""))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"寄存器地址",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.bias.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.bias.msg))]),e._v(" "),a("div",{class:{error:t.row.bias.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-input",{attrs:{size:"mini",placeholder:"0-65535"},on:{blur:function(a){return e.handleBlur(a,t.row.bias)}},model:{value:t.row.bias.value,callback:function(a){e.$set(t.row.bias,"value","string"==typeof a?a.trim():a)},expression:"scope.row['bias'].value"}}):a("span",[e._v(e._s(t.row.bias.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"数据格式",width:"125"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.datatype.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.datatype.msg))]),e._v(" "),a("div",{class:{error:t.row.datatype.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:function(a){return e.handleChange(t.row,"datatype")}},model:{value:t.row.datatype.value,callback:function(a){e.$set(t.row.datatype,"value",a)},expression:"scope.row['datatype'].value"}},[a("el-option",{attrs:{label:"16位有符号数",value:1}}),e._v(" "),a("el-option",{attrs:{label:"16位无符号数",value:2}}),e._v(" "),a("el-option",{attrs:{label:"32位有符号数",value:3}}),e._v(" "),a("el-option",{attrs:{label:"32位无符号数",value:4}}),e._v(" "),a("el-option",{attrs:{label:"32位浮点型数",value:5}}),e._v(" "),a("el-option",{attrs:{label:"16位按位读取",value:6}}),e._v(" "),a("el-option",{attrs:{label:"bit",value:7}})],1):a("span",[e._v(e._s(1===t.row.datatype.value?"16位有符号数":2===t.row.datatype.value?"16位无符号数":3===t.row.datatype.value?"32位有符号数":4===t.row.datatype.value?"32位无符号数":5===t.row.datatype.value?"32位浮点型数":6===t.row.datatype.value?"16位按位读取":7===t.row.datatype.value?"bit":""))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"字节顺序",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.orderStr.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.orderStr.msg))]),e._v(" "),a("div",{class:{error:t.row.orderStr.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:function(a){return e.handleChange(t.row,"orderStr")}},model:{value:t.row.orderStr.value,callback:function(a){e.$set(t.row.orderStr,"value",a)},expression:"scope.row['orderStr'].value"}},[a("el-option",{attrs:{label:"空",value:""}}),e._v(" "),a("el-option",{attrs:{label:"ABCD",value:"ABCD"}}),e._v(" "),a("el-option",{attrs:{label:"CDAB",value:"CDAB"}}),e._v(" "),a("el-option",{attrs:{label:"BADC",value:"BADC"}}),e._v(" "),a("el-option",{attrs:{label:"DCAB",value:"DCAB"}}),e._v(" "),a("el-option",{attrs:{label:"AB",value:"AB"}}),e._v(" "),a("el-option",{attrs:{label:"BA",value:"BA"}})],1):a("span",[e._v(e._s(t.row.orderStr.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"地址位",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.datas.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.datas.msg))]),e._v(" "),a("div",{class:{error:t.row.datas.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:function(a){return e.handleChange(t.row,"datas")}},model:{value:t.row.datas.value,callback:function(a){e.$set(t.row.datas,"value",a)},expression:"scope.row['datas'].value"}},[e._l(16,function(e){return a("el-option",{key:e,attrs:{label:e,value:e.toString()}})}),e._v(" "),a("el-option",{attrs:{label:"空",value:""}})],2):a("span",[e._v(e._s(t.row.datas.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"采集周期/s",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.cycle.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.cycle.msg))]),e._v(" "),a("div",{class:{error:t.row.cycle.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-autocomplete",{attrs:{size:"mini","fetch-suggestions":function(e,t){t([{value:"10"},{value:"30"},{value:"60"},{value:"120"}])},placeholder:"可输入"},on:{blur:function(a){return e.handleBlur(a,t.row.cycle)}},model:{value:t.row.cycle.value,callback:function(a){e.$set(t.row.cycle,"value","string"==typeof a?a.trim():a)},expression:"scope.row['cycle'].value"}}):a("span",[e._v(e._s(t.row.cycle.value))])],1)])]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.senserPagination.total,"page-size":e.senserPagination.pageSize,"current-page":e.senserPagination.currentPage},on:{"update:currentPage":function(t){return e.$set(e.senserPagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.senserPagination,"currentPage",t)},"current-change":e.handleSenserCurrentChange}})],1),e._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{on:{click:e.previousStep}},[e._v("\n          上一步\n        ")]),e._v(" "),a("el-button",{attrs:{loading:e.addLoading,type:"primary"},on:{click:e.submitGateway}},[e._v("\n          确  认\n        ")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.stepActive&&"2"===e.gatewayForm.type,expression:"stepActive === 1 && gatewayForm.type === '2'"}],staticClass:"gateway-set-custom"},[a("div",{staticStyle:{"text-align":"right",margin:"10px"}},[a("el-tooltip",{attrs:{placement:"top",effect:"light",content:"在点位列表中添加一行","open-delay":1e3}},[a("el-button",{attrs:{size:"small"},nativeOn:{click:function(t){return e.clickAddRow(t)}}},[e._v("\n            添加点位\n          ")])],1),e._v(" "),a("el-tooltip",{attrs:{placement:"top",effect:"light",content:"验证点位列表数据的正确性","open-delay":1e3}},[a("el-button",{attrs:{size:"small"},nativeOn:{click:function(t){return e.handleCheckData(t)}}},[e._v("\n            数据校验\n          ")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tcpTableLoading,expression:"tcpTableLoading"}],staticStyle:{width:"100%"},attrs:{id:"tcpSenserTable","element-loading-text":"加载中...",border:"",data:e.tcpSenserTable}},[a("el-table-column",{attrs:{prop:"channel",label:"通道号",width:"100",type:"index"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.tcpSenserPagination.pageSize*(e.tcpSenserPagination.currentPage-1)+1+t.$index))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"145"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{padding:"5px"},attrs:{type:"danger",round:"",size:"mini",icon:"el-icon-delete"},nativeOn:{click:function(a){return e.deleteSenser(t.$index,t.row.sensorId)}}}),e._v(" "),a("el-button",{staticStyle:{padding:"5px"},attrs:{size:"mini",round:""},nativeOn:{click:function(a){return e.copyRow(t.row)}}},[a("c-svg",{attrs:{name:"paste"}})],1),e._v(" "),a("el-button",{staticStyle:{padding:"5px"},attrs:{type:"success",round:"",size:"mini",icon:t.row.editable?"el-icon-check":"el-icon-edit"},nativeOn:{click:function(a){return e.clickEdit(t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"点位类型",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.sensorTypeId.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.sensorTypeId.msg))]),e._v(" "),a("div",{class:{error:t.row.sensorTypeId.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{"popper-class":"tcpSelectWrap",filterable:"",placeholder:"请选择点位类型",size:"mini"},on:{change:function(a){return e.handleChange(t.row,"sensorTypeId")}},model:{value:t.row.sensorTypeId.value,callback:function(a){e.$set(t.row.sensorTypeId,"value",a)},expression:"scope.row['sensorTypeId'].value"}},e._l(e.pointTypeOptions,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(n){return a("el-option",{key:n.ID,attrs:{label:n.TypeName,value:n.ID}},[a("span",{staticStyle:{float:"left","margin-right":"25px"}},[e._v(e._s(n.TypeName))]),e._v(" "),"状态量"===t.label?a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(n.Value))]):e._e()])}),1)}),1):a("div",[e._v("\n                  "+e._s(e.getPointTypeLabel(t.row.sensorTypeId.value))+"\n                ")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"传感器名称","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.sensorName.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.sensorName.msg))]),e._v(" "),a("div",{class:{error:t.row.sensorName.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-input",{attrs:{size:"mini"},on:{blur:function(a){return e.handleBlur(a,t.row.sensorName)}},model:{value:t.row.sensorName.value,callback:function(a){e.$set(t.row.sensorName,"value","string"==typeof a?a.trim():a)},expression:"scope.row['sensorName'].value"}}):a("span",[e._v(e._s(t.row.sensorName.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"小数位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.decimal.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.decimal.msg))]),e._v(" "),a("div",{class:{error:t.row.decimal.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{attrs:{disabled:"state"===t.row.typeSection,size:"mini"},on:{change:function(a){return e.handleChange(t.row,"decimal")}},model:{value:t.row.decimal.value,callback:function(a){e.$set(t.row.decimal,"value",a)},expression:"scope.row['decimal'].value"}},[a("el-option",{attrs:{label:"0",value:0}}),e._v(" "),a("el-option",{attrs:{label:"1",value:1}}),e._v(" "),a("el-option",{attrs:{label:"2",value:2}}),e._v(" "),a("el-option",{attrs:{label:"3",value:3}}),e._v(" "),a("el-option",{attrs:{label:"4",value:4}})],1):a("span",[e._v(e._s(t.row.decimal.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.unit.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.unit.msg))]),e._v(" "),a("div",{class:{error:t.row.unit.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("el-select",{staticClass:"inline-input",attrs:{disabled:"state"===t.row.typeSection,size:"mini",placeholder:"请选择"},on:{blur:function(a){return e.handleBlur(a,t.row.unit)}},model:{value:t.row.unit.value,callback:function(a){e.$set(t.row.unit,"value","string"==typeof a?a.trim():a)},expression:"scope.row['unit'].value"}},e._l(t.row.unitOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1):a("span",[e._v(e._s(t.row.unit.value))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"映射","min-width":"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.field1.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.field1.msg))]),e._v(" "),a("div",{class:{error:t.row.field1.msg},attrs:{slot:"reference"},slot:"reference"},[t.row.editable?a("div",{staticClass:"field-wrap"},[a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x1"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field1.value,callback:function(a){e.$set(t.row.field1,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field1'].value"}}),e._v("~\n                  "),a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x2"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field2.value,callback:function(a){e.$set(t.row.field2,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field2'].value"}}),e._v("→\n                  "),a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x3"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field3.value,callback:function(a){e.$set(t.row.field3,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field3'].value"}}),e._v("~\n                  "),a("el-input",{staticClass:"el-input-padding-0",attrs:{size:"mini",placeholder:"x4"},on:{blur:function(a){return e.handleBlur(a,t.row.field1)}},model:{value:t.row.field4.value,callback:function(a){e.$set(t.row.field4,"value","string"==typeof a?a.trim():a)},expression:"scope.row['field4'].value"}}),e._v(" "),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-caret-bottom shortcut-field"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return e.shortcutField(t.row,"","","","")}}},[e._v("\n                        无\n                      ")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){return e.shortcutField(t.row,-1e3,1e3,-100,100)}}},[e._v("\n                        -1000 ~ 1000 → -100 ~ 100\n                      ")]),e._v(" "),a("el-dropdown-item",{nativeOn:{click:function(a){return e.shortcutField(t.row,-1e4,1e4,-1e3,1e3)}}},[e._v("\n                        -10000 ~ 10000 → -1000 ~ 1000\n                      ")])],1)],1)],1):a("span",[e._v(e._s(""!==t.row.field1.value?t.row.field1.value+" ~ "+t.row.field2.value+" → "+t.row.field3.value+" ~ "+t.row.field4.value:""))])])])]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.tcpSenserPagination.total,"page-size":e.tcpSenserPagination.pageSize,"current-page":e.tcpSenserPagination.currentPage},on:{"update:currentPage":function(t){return e.$set(e.tcpSenserPagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tcpSenserPagination,"currentPage",t)},"current-change":e.handleSenserCurrentChange}})],1),e._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{on:{click:e.previousStep}},[e._v("\n          上一步\n        ")]),e._v(" "),a("el-button",{attrs:{loading:e.tcpAddLoading,type:"primary"},on:{click:e.submitTcpGateway}},[e._v("\n          确  认\n        ")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:4===e.stepActive,expression:"stepActive === 4"}],staticClass:"add-complete"},[e._m(0),e._v(" "),a("div",{staticClass:"ok-text"},[e._v("\n        网关添加成功\n      ")]),e._v(" "),a("div",{staticClass:"gateway-info"},[a("p",{staticClass:"info-list"},[a("span",[e._v("网关名称：  ")]),e._v(" "),a("span",[e._v(e._s(e.senserInfo.name))])]),e._v(" "),a("p",{staticClass:"info-list"},[a("span",[e._v("网关 S/N：  ")]),e._v(" "),a("span",[e._v(e._s(e.senserInfo.serialNumber))])]),e._v(" "),a("p",{staticClass:"info-list"},[a("span",[e._v("所属项目：  ")]),e._v(" "),a("span",[e._v(e._s(e.senserInfo.project))])]),e._v(" "),a("p",{staticClass:"info-list"},[a("span",[e._v("点位数量：  ")]),e._v(" "),a("span",[e._v(e._s(e.senserInfo.number))])])]),e._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addAgain}},[e._v("\n          继续添加\n        ")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){return e.$router.push("/terminalManage/index")}}},[e._v("\n          查看网关\n        ")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.currentTemplate.name,visible:e.templateDialog,"custom-class":"template-set-dialog"},on:{"update:visible":function(t){e.templateDialog=t}}},[a("el-table",{attrs:{"highlight-current-row":"",data:e.currentTemplate.value&&e.currentTemplate.value.sensorItem,border:""},on:{"cell-click":e.handleCellClick}},[a("el-table-column",{attrs:{type:"index",width:"90"}}),e._v(" "),a("el-table-column",{attrs:{label:"点位名称",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.sensorName.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.sensorName.msg)+"\n              ")]),e._v(" "),a("div",{class:{error:t.row.sensorName.msg},attrs:{slot:"reference"},slot:"reference"},[a("span",{staticClass:"cell-value"},[e._v(e._s(t.row.sensorName.value))]),e._v(" "),a("div",{staticClass:"cell-input"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.row.sensorName.value,expression:"scope.row['sensorName'].value",modifiers:{trim:!0}}],staticClass:"not-el-input",domProps:{value:t.row.sensorName.value},on:{blur:[function(a){return e.handleBlur(a,t.row.sensorName)},function(t){return e.$forceUpdate()}],input:function(a){a.target.composing||e.$set(t.row.sensorName,"value",a.target.value.trim())}}})])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"点位类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",disabled:!0}},[e._v("\n              "+e._s(e.getPointTypeLabel(t.row.sensorTypeId))+"\n            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"小数位",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",disabled:!0}},[e._v("\n              "+e._s(t.row.decimal)+"\n            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单位",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",disabled:!0}},[e._v("\n              "+e._s(t.row.unit)+"\n            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"采集周期/s",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{"popper-class":t.row.cycle.msg+"popover-visibility",trigger:"hover",placement:"top"}},[a("p",[a("span",{staticClass:"error-type"},[e._v("错误原因： ")]),e._v(" "+e._s(t.row.cycle.msg)+"\n              ")]),e._v(" "),a("div",{class:{error:t.row.cycle.msg},attrs:{slot:"reference"},slot:"reference"},[a("span",{staticClass:"cell-value"},[e._v(e._s(t.row.cycle.value))]),e._v(" "),a("div",{staticClass:"cell-input"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.row.cycle.value,expression:"scope.row['cycle'].value",modifiers:{trim:!0}}],staticClass:"not-el-input",attrs:{placeholder:"请输入"},domProps:{value:t.row.cycle.value},on:{blur:[function(a){return e.handleBlur(a,t.row.cycle)},function(t){return e.$forceUpdate()}],input:function(a){a.target.composing||e.$set(t.row.cycle,"value",a.target.value.trim())}}})])])])]}}])})],1),e._v(" "),a("span",{staticStyle:{"text-align":"center",display:"block"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitTemplate(t)}}},[e._v("保存配置")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"点位批量添加",visible:e.batchAddDialog,"custom-class":"batch-add-dialog"},on:{"update:visible":function(t){e.batchAddDialog=t},close:e.batchAddDialogClose}},[a("el-form",{ref:"batchAddForm",attrs:{model:e.batchAddForm,rules:e.batchAddFormRule,"label-width":"110px",inline:""}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"点位名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.sensorName,callback:function(t){e.$set(e.batchAddForm,"sensorName","string"==typeof t?t.trim():t)},expression:"batchAddForm.sensorName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"点位类型"}},[a("el-select",{staticStyle:{width:"190px"},attrs:{size:"small"},model:{value:e.batchAddForm.sensorTypeId,callback:function(t){e.$set(e.batchAddForm,"sensorTypeId",t)},expression:"batchAddForm.sensorTypeId"}},[a("el-option",{attrs:{label:"开关型",value:2}}),e._v(" "),a("el-option",{attrs:{label:"数值型",value:1}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"小数位"}},[a("el-select",{staticStyle:{width:"190px"},attrs:{size:"small"},model:{value:e.batchAddForm.decimal,callback:function(t){e.$set(e.batchAddForm,"decimal",t)},expression:"batchAddForm.decimal"}},[a("el-option",{attrs:{label:"0",value:0}}),e._v(" "),a("el-option",{attrs:{label:"1",value:1}}),e._v(" "),a("el-option",{attrs:{label:"2",value:2}}),e._v(" "),a("el-option",{attrs:{label:"3",value:3}}),e._v(" "),a("el-option",{attrs:{label:"4",value:4}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"从站地址"}},[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.address,callback:function(t){e.$set(e.batchAddForm,"address",e._n("string"==typeof t?t.trim():t))},expression:"batchAddForm.address"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"功能码"}},[a("el-select",{staticStyle:{width:"190px"},attrs:{size:"small"},model:{value:e.batchAddForm.funcode,callback:function(t){e.$set(e.batchAddForm,"funcode",t)},expression:"batchAddForm.funcode"}},[a("el-option",{attrs:{label:"01读写",value:1}}),e._v(" "),a("el-option",{attrs:{label:"02只读",value:2}}),e._v(" "),a("el-option",{attrs:{label:"03读写",value:3}}),e._v(" "),a("el-option",{attrs:{label:"04只读",value:4}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"bias",label:"寄存器地址"}},[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.bias,callback:function(t){e.$set(e.batchAddForm,"bias",e._n("string"==typeof t?t.trim():t))},expression:"batchAddForm.bias"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据格式"}},[a("el-select",{staticStyle:{width:"190px"},attrs:{size:"small"},model:{value:e.batchAddForm.datatype,callback:function(t){e.$set(e.batchAddForm,"datatype",t)},expression:"batchAddForm.datatype"}},[a("el-option",{attrs:{label:"16位有符号数",value:1}}),e._v(" "),a("el-option",{attrs:{label:"16位无符号数",value:2}}),e._v(" "),a("el-option",{attrs:{label:"32位有符号数",value:3}}),e._v(" "),a("el-option",{attrs:{label:"32位无符号数",value:4}}),e._v(" "),a("el-option",{attrs:{label:"32位浮点型数",value:5}}),e._v(" "),a("el-option",{attrs:{label:"16位按位读取",value:6}}),e._v(" "),a("el-option",{attrs:{label:"bit",value:7}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"字节顺序"}},[a("el-select",{staticStyle:{width:"190px"},attrs:{size:"small"},model:{value:e.batchAddForm.orderStr,callback:function(t){e.$set(e.batchAddForm,"orderStr",t)},expression:"batchAddForm.orderStr"}},[a("el-option",{attrs:{label:"ABCD",value:"ABCD"}}),e._v(" "),a("el-option",{attrs:{label:"CDAB",value:"CDAB"}}),e._v(" "),a("el-option",{attrs:{label:"BADC",value:"BADC"}}),e._v(" "),a("el-option",{attrs:{label:"DCAB",value:"DCAB"}}),e._v(" "),a("el-option",{attrs:{label:"AB",value:"AB"}}),e._v(" "),a("el-option",{attrs:{label:"BA",value:"BA"}}),e._v(" "),a("el-option",{attrs:{label:"空",value:""}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"地址位"}},[a("el-select",{staticStyle:{width:"190px"},attrs:{size:"small"},model:{value:e.batchAddForm.datas,callback:function(t){e.$set(e.batchAddForm,"datas",t)},expression:"batchAddForm.datas"}},[e._l(16,function(e){return a("el-option",{key:e,attrs:{label:e,value:e.toString()}})}),e._v(" "),a("el-option",{attrs:{label:"空",value:""}})],2)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"单位"}},[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.unit,callback:function(t){e.$set(e.batchAddForm,"unit","string"==typeof t?t.trim():t)},expression:"batchAddForm.unit"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"采集周期"}},[a("el-input",{attrs:{size:"small",placeholder:"10秒/30秒/60的倍数"},model:{value:e.batchAddForm.cycle,callback:function(t){e.$set(e.batchAddForm,"cycle","string"==typeof t?t.trim():t)},expression:"batchAddForm.cycle"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{staticStyle:{"font-size":"15px",padding:"11px 4px 11px 0","text-align":"right","line-height":"1"},attrs:{span:4}},[e._v("\n            映射\n          ")]),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"input-field1"},[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.field1,callback:function(t){e.$set(e.batchAddForm,"field1","string"==typeof t?t.trim():t)},expression:"batchAddForm.field1"}})],1)],1),e._v(" "),a("el-col",{staticClass:"input-field2",attrs:{span:5}},[a("el-form-item",[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.field2,callback:function(t){e.$set(e.batchAddForm,"field2","string"==typeof t?t.trim():t)},expression:"batchAddForm.field2"}})],1),e._v(" "),a("c-svg",{attrs:{name:"right-arrow"}})],1),e._v(" "),a("el-col",{staticClass:"input-field3",attrs:{span:5}},[a("el-form-item",[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.field3,callback:function(t){e.$set(e.batchAddForm,"field3","string"==typeof t?t.trim():t)},expression:"batchAddForm.field3"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("el-form-item",[a("el-input",{attrs:{size:"small"},model:{value:e.batchAddForm.field4,callback:function(t){e.$set(e.batchAddForm,"field4","string"==typeof t?t.trim():t)},expression:"batchAddForm.field4"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"寄存器地址增量"}},[a("el-input-number",{attrs:{min:1,size:"small"},model:{value:e.batchAddForm.increment,callback:function(t){e.$set(e.batchAddForm,"increment",t)},expression:"batchAddForm.increment"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"批量个数"}},[a("el-input-number",{attrs:{min:1,max:40,size:"small"},model:{value:e.batchAddForm.addCount,callback:function(t){e.$set(e.batchAddForm,"addCount",t)},expression:"batchAddForm.addCount"}})],1)],1)],1)],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.batchAddDialog=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.batchAdd(t)}}},[e._v("确认")])],1)],1)],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ok-icon"},[a("i",{staticClass:"el-icon-circle-check"})])}]}},584:function(e,t,a){a(1425),a(1424);var n=a(38)(a(1085),a(1574),"data-v-8b8468aa",null);e.exports=n.exports},684:function(e,t,a){var n=a(133)("meta"),r=a(58),s=a(69),i=a(59).f,o=0,l=Object.isExtensible||function(){return!0},u=!a(68)(function(){return l(Object.preventExtensions({}))}),c=function(e){i(e,n,{value:{i:"O"+ ++o,w:{}}})},d=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,n)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[n].i},p=function(e,t){if(!s(e,n)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[n].w},v=function(e){return u&&f.NEED&&l(e)&&!s(e,n)&&c(e),e},f=e.exports={KEY:n,NEED:!1,fastKey:d,getWeak:p,onFreeze:v}},685:function(e,t,a){var n=a(58);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},686:function(e,t,a){var n=a(70);e.exports=Array.isArray||function(e){return"Array"==n(e)}},687:function(e,t,a){e.exports={default:a(688),__esModule:!0}},688:function(e,t,a){a(215),a(134),a(213),a(698),a(701),a(700),a(699),e.exports=a(14).Set},689:function(e,t,a){var n=a(210);e.exports=function(e,t){var a=[];return n(e,!1,a.push,a,t),a}},690:function(e,t,a){var n=a(60),r=a(136),s=a(72),i=a(90),o=a(692);e.exports=function(e,t){var a=1==e,l=2==e,u=3==e,c=4==e,d=6==e,p=5==e||d,v=t||o;return function(t,o,f){for(var m,g,b=s(t),y=r(b),h=n(o,f,3),w=i(y.length),_=0,x=a?v(t,w):l?v(t,0):void 0;w>_;_++)if((p||_ in y)&&(m=y[_],g=h(m,_,b),e))if(a)x[_]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return _;case 2:x.push(m)}else if(c)return!1;return d?-1:u||c?c:x}}},691:function(e,t,a){var n=a(58),r=a(686),s=a(21)("species");e.exports=function(e){var t;return r(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!r(t.prototype)||(t=void 0),n(t)&&null===(t=t[s])&&(t=void 0)),void 0===t?Array:t}},692:function(e,t,a){var n=a(691);e.exports=function(e,t){return new(n(e))(t)}},693:function(e,t,a){"use strict";var n=a(59).f,r=a(214),s=a(212),i=a(60),o=a(211),l=a(210),u=a(137),c=a(216),d=a(217),p=a(61),v=a(684).fastKey,f=a(685),m=p?"_s":"size",g=function(e,t){var a,n=v(t);if("F"!==n)return e._i[n];for(a=e._f;a;a=a.n)if(a.k==t)return a};e.exports={getConstructor:function(e,t,a,u){var c=e(function(e,n){o(e,c,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=n&&l(n,a,e[u],e)});return s(c.prototype,{clear:function(){for(var e=f(this,t),a=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete a[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var a=f(this,t),n=g(a,e);if(n){var r=n.n,s=n.p;delete a._i[n.i],n.r=!0,s&&(s.n=r),r&&(r.p=s),a._f==n&&(a._f=r),a._l==n&&(a._l=s),a[m]--}return!!n},forEach:function(e){f(this,t);for(var a,n=i(e,arguments.length>1?arguments[1]:void 0,3);a=a?a.n:this._f;)for(n(a.v,a.k,this);a&&a.r;)a=a.p},has:function(e){return!!g(f(this,t),e)}}),p&&n(c.prototype,"size",{get:function(){return f(this,t)[m]}}),c},def:function(e,t,a){var n,r,s=g(e,t);return s?s.v=a:(e._l=s={i:r=v(t,!0),k:t,v:a,p:n=e._l,n:void 0,r:!1},e._f||(e._f=s),n&&(n.n=s),e[m]++,"F"!==r&&(e._i[r]=s)),e},getEntry:g,setStrong:function(e,t,a){u(e,t,function(e,a){this._t=f(e,t),this._k=a,this._l=void 0},function(){for(var e=this,t=e._k,a=e._l;a&&a.r;)a=a.p;return e._t&&(e._l=a=a?a.n:e._t._f)?"keys"==t?c(0,a.k):"values"==t?c(0,a.v):c(0,[a.k,a.v]):(e._t=void 0,c(1))},a?"entries":"values",!a,!0),d(t)}}},694:function(e,t,a){var n=a(135),r=a(689);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},695:function(e,t,a){"use strict";var n=a(15),r=a(39),s=a(684),i=a(68),o=a(52),l=a(212),u=a(210),c=a(211),d=a(58),p=a(89),v=a(59).f,f=a(690)(0),m=a(61);e.exports=function(e,t,a,g,b,y){var h=n[e],w=h,_=b?"set":"add",x=w&&w.prototype,S={};return m&&"function"==typeof w&&(y||x.forEach&&!i(function(){(new w).entries().next()}))?(w=t(function(t,a){c(t,w,e,"_c"),t._c=new h,void 0!=a&&u(a,b,t[_],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in x&&(!y||"clear"!=e)&&o(w.prototype,e,function(a,n){if(c(this,w,e),!t&&y&&!d(a))return"get"==e&&void 0;var r=this._c[e](0===a?0:a,n);return t?this:r})}),y||v(w.prototype,"size",{get:function(){return this._c.size}})):(w=g.getConstructor(t,e,b,_),l(w.prototype,a),s.NEED=!0),p(w,e),S[e]=w,r(r.G+r.W+r.F,S),y||g.setStrong(w,e,b),w}},696:function(e,t,a){"use strict";var n=a(39),r=a(71),s=a(60),i=a(210);e.exports=function(e){n(n.S,e,{from:function(e){var t,a,n,o,l=arguments[1];return r(this),t=void 0!==l,t&&r(l),void 0==e?new this:(a=[],t?(n=0,o=s(l,arguments[2],2),i(e,!1,function(e){a.push(o(e,n++))})):i(e,!1,a.push,a),new this(a))}})}},697:function(e,t,a){"use strict";var n=a(39);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},698:function(e,t,a){"use strict";var n=a(693),r=a(685);e.exports=a(695)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(r(this,"Set"),e=0===e?0:e,e)}},n)},699:function(e,t,a){a(696)("Set")},700:function(e,t,a){a(697)("Set")},701:function(e,t,a){var n=a(39);n(n.P+n.R,"Set",{toJSON:a(694)("Set")})},711:function(e,t,a){"use strict";a.d(t,"p",function(){return r}),a.d(t,"c",function(){return s}),a.d(t,"o",function(){return i}),a.d(t,"i",function(){return o}),a.d(t,"a",function(){return l}),a.d(t,"n",function(){return u}),a.d(t,"h",function(){return c}),a.d(t,"g",function(){return d}),a.d(t,"f",function(){return p}),a.d(t,"e",function(){return v}),a.d(t,"b",function(){return f}),a.d(t,"l",function(){return m}),a.d(t,"m",function(){return g}),a.d(t,"k",function(){return b}),a.d(t,"d",function(){return y}),a.d(t,"j",function(){return h});var n=a(32),r=function(e){return n.a.get("/api/project/loadSite",{params:{uid:e}})},s=function(e){return n.a.post("/api/project/addProject",e)},i=function(e){return n.a.post("/api/project/upProject",e)},o=function(e,t){return n.a.get("/api/project/delProject",{params:{pid:e,pwd:t}})},l=function(e,t){return n.a.get("/api/project/projectShow",{params:{page:e,num:t}})},u=function(e,t){return n.a.get("/api/project/queryProject",{params:{pid:e,uid:t}})},c=function(){return n.a.get("/api/project/getTagByUid")},d=function(e){return n.a.get("/api/project/getTag",{params:{pid:e}})},p=function(e,t){return n.a.get("/api/project/delete",{params:{pid:e,id:t}})},v=function(e,t){return n.a.get("/api/project/addTag",{params:{pid:e,tag:t}})},f=function(e){return n.a.get("/api/project/getDeviceTree",{params:{project:e}})},m=function(e,t){return n.a.get("/api/project/getDevice",{params:{project:e,user:t}})},g=function(e){return n.a.post("/api/project/updateDevOrPoint",e)},b=function(e,t){return n.a.get("/api/project/getUserbyPro",{params:{project:e,inp:t}})},y=function(e){return n.a.get("/api/project/Signout",{params:{project:e}})},h=function(e,t,a){return n.a.get("/api/project/assignMent",{params:{project:e,user:t,pwd:a}})}},722:function(e,t,a){"use strict";a.d(t,"c",function(){return r}),a.d(t,"e",function(){return s}),a.d(t,"a",function(){return i}),a.d(t,"b",function(){return o}),a.d(t,"d",function(){return l}),a.d(t,"g",function(){return u}),a.d(t,"h",function(){return c}),a.d(t,"i",function(){return d}),a.d(t,"j",function(){return p}),a.d(t,"f",function(){return v});var n=a(32),r=function(e){return n.a.post("/api/PointType/PointTypeInsert",e)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return n.a.get("/api/PointType/PointTypeList",{params:{projectId:e,TypeName:t}})},i=function(e){return n.a.post("/api/PointType/PointTypeDelete",e)},o=function(e,t){return n.a.get("/api/PointType/PointTypeQuery",{params:{ID:e,projectId:t}})},l=function(e){return n.a.post("/api/PointType/PointTypeUpdate",e)},u=function(e){return n.a.post("/api/EditPoint/GetModePointType",e)},c=function(e){return n.a.post("/api/EditPoint/GetModePointUnit",e)},d=function(e){return n.a.post("/api/EditPoint/updateDmpSetS",e)},p=function(e){return n.a.post("/api/EditPoint/QueryModelSWList",e)},v=function(e){return n.a.post("/api/EditPoint/GetProjectdmpTable",e)}},723:function(e,t,a){"use strict";a.d(t,"I",function(){return r}),a.d(t,"w",function(){return s}),a.d(t,"B",function(){return i}),a.d(t,"x",function(){return o}),a.d(t,"v",function(){return l}),a.d(t,"i",function(){return u}),a.d(t,"L",function(){return c}),a.d(t,"h",function(){return d}),a.d(t,"A",function(){return p}),a.d(t,"l",function(){return v}),a.d(t,"y",function(){return f}),a.d(t,"k",function(){return m}),a.d(t,"j",function(){return g}),a.d(t,"g",function(){return b}),a.d(t,"c",function(){return y}),a.d(t,"d",function(){return h}),a.d(t,"b",function(){return w}),a.d(t,"a",function(){return _}),a.d(t,"f",function(){return x}),a.d(t,"e",function(){return S}),a.d(t,"H",function(){return D}),a.d(t,"p",function(){return I}),a.d(t,"n",function(){return k}),a.d(t,"m",function(){return T}),a.d(t,"o",function(){return C}),a.d(t,"F",function(){return A}),a.d(t,"J",function(){return N}),a.d(t,"z",function(){return F}),a.d(t,"G",function(){return P}),a.d(t,"M",function(){return $}),a.d(t,"E",function(){return z}),a.d(t,"K",function(){return B}),a.d(t,"C",function(){return E}),a.d(t,"D",function(){return O}),a.d(t,"u",function(){return j}),a.d(t,"q",function(){return L}),a.d(t,"r",function(){return M}),a.d(t,"t",function(){return U}),a.d(t,"s",function(){return q});var n=a(32),r=function(e,t,a,r){return n.a.get("/api/DeviceInfo/ShowDevice_List",{params:{uid:e,type:t,page:a,pnum:r}})},s=function(e){return n.a.post("/api/DeviceInfo/AddDevicePoint",e)},i=function(e){return n.a.get("/api/DeviceInfo/devDeleteTCP",{params:{ID:e}})},o=function(e){return n.a.get("/api/DeviceInfo/GetDevice_TCPConfig",{params:{deviceID:e}})},l=function(e){return n.a.get("/api/DeviceInfo/CkDeviceNo",{params:{deviceno:e}})},u=function(e,t){return n.a.get("/api/DeviceInfo/ControlDown",{params:{pointID:e,writeData:t}})},c=function(e){return n.a.post("/api/DeviceInfo/addDevicesNew",e)},d=function(e){return n.a.get("/api/DeviceInfo/queryDevicesIndexNew",{params:{deviceId:e}})},p=function(e){return n.a.get("/api/DeviceInfo/delDevicesNew",{params:{deviceId:e}})},v=function(e){return n.a.get("/api/DeviceInfo/delSensorNEW",{params:{SensorId:e}})},f=function(e){return n.a.get("/api/DeviceInfo/GetDevice_Config",{params:{deviceId:e}})},m=function(e){return n.a.post("/api/DeviceInfo/saveModbus",e)},g=function(e){return n.a.get("/api/DeviceInfo/QueryModbus",{params:{id:e}})},b=function(e,t,a){return n.a.get("/api/DeviceInfo/getInfoById",{params:{mtid:e,project:t,name:a}})},y=function(e){return n.a.post("/api/DeviceInfo/addModel",e)},h=function(e){return n.a.get("/api/DeviceInfo/deleteModel",{params:{mtid:e}})},w=function(e){return n.a.post("/api/DeviceInfo/updateModel",e)},_=function(){return n.a.get("/api/DeviceInfo/getBigInfo")},x=function(e){return n.a.get("/api/DeviceInfo/getSmallInfo",{params:{bid:e}})},S=function(e){return n.a.post("/api/DeviceInfo/addDeviceInfo",e)},D=function(e){return n.a.post("/api/DeviceInfo/updateDevicesNEW",e)},I=function(e){return n.a.post("/api/DeviceInfo/updateDevice",e)},k=function(e){return n.a.get("/api/DeviceInfo/deleteDevice",{params:{id:e}})},T=function(e){return n.a.post("/api/deviceInfo/imgUrl",e,{headers:{"Content-Type":"multipart/form-data"}})},C=function(e){return n.a.post("/api/DeviceInfo/FileUrl",e,{headers:{"Content-Type":"multipart/form-data"}})},A=function(e){return n.a.post("/api/DeviceInfo/addTemplate",e)},N=function(){return n.a.get("/api/DeviceInfo/getTempByUid")},F=function(e){return n.a.get("/api/DeviceInfo/getTempById",{params:{tids:e}})},P=function(e){return n.a.post("/api/DeviceInfo/updateTemplate",e)},$=function(e){return n.a.get("/api/DeviceInfo/getTempByType",{params:{inp:e}})},z=function(e){return n.a.get("/api/DeviceInfo/deleteTemplate",{params:{tid:e}})},B=function(e,t){return n.a.get("/api/DeviceInfo/getUserbyPro",{params:{tid:e,inp:t}})},E=function(e,t){return n.a.get("/api/DeviceInfo/regionUser",{params:{tid:e,uids:t}})},O=function(e,t){return n.a.get("/api/DeviceInfo/deleteUser",{params:{tid:e,uids:t}})},j=function(e){return n.a.get("/api/DeviceInfo/Get_Device_contactsList",{params:{mtid:e}})},L=function(e){return n.a.post("/api/DeviceInfo/Add_Device_contacts",e)},M=function(e){return n.a.get("/api/DeviceInfo/Delete_Device_contacts",{params:{id:e}})},U=function(e){return n.a.get("/api/Maintenance_team/QueryUser",{params:{screen:e}})},q=function(e,t,a){return n.a.get("/api/DeviceInfo/getDeviceByMtid",{params:{mtid:e,project:t,name:a}})}},840:function(e,t,a){"use strict";function n(e){var t=parseInt(e/20);return e%20!=0&&(t+=1),t}a.d(t,"b",function(){return u}),a.d(t,"a",function(){return c}),a.d(t,"c",function(){return d}),a.d(t,"f",function(){return p}),a.d(t,"e",function(){return v}),a.d(t,"d",function(){return f}),a.d(t,"g",function(){return m});var r=a(687),s=a.n(r),i=a(234),o=a.n(i),l=this,u=function(e,t){var a=[],r=[];if(t)for(var i=0;i<e.length;i++){var l=!1;e[i].sensorName.value&&"Error"!==e[i].sensorName.value||(e[i].sensorName.msg="请输入传感器名称",l=!0),e[i].sensorTypeId.value||(e[i].sensorTypeId.msg="请选择点位类型",l=!0),e[i].decimal.value,e[i].unit.value,(e[i].field1.value||e[i].field2.value||e[i].field3.value||e[i].field4.value)&&(m(e[i].field1.value)&&m(e[i].field2.value)&&m(e[i].field3.value)&&m(e[i].field4.value)?e[i].field1.value===e[i].field2.value&&(e[i].field1.msg="映射参数 x1 不能等于 x2",l=!0):(e[i].field1.msg="映射参数由4个数{x1,x2,x3,x4}组成,如: -1000~1000 -> -100 ~ 100",l=!0)),l?(a.push(i+1),e[i].editable=!0):e[i].editable=!1}else for(var u=e.map(function(e){return e.address.value+"/"+e.funcode.value+"/"+e.bias.value+"/"+e.datas.value}),i=0;i<e.length;i++)!function(t){var n=!1;u.filter(function(a){return a===e[t].address.value+"/"+e[t].funcode.value+"/"+e[t].bias.value+"/"+e[t].datas.value}).length>1?(e[t].sensorName.msg="不可同时存在两个以上具有相同从站地址、功能码、寄存器地址、地址位的传感器，请修改完成后再校验一次",n=!0):e[t].sensorName.msg="",e[t].sensorName.value&&"Error"!==e[t].sensorName.value||(e[t].sensorName.msg="请输入传感器名称",n=!0),e[t].sensorTypeId.value||(e[t].sensorTypeId.msg="请选择点位类型",n=!0),e[t].decimal.value,e[t].unit.value,(e[t].field1.value||e[t].field2.value||e[t].field3.value||e[t].field4.value)&&(m(e[t].field1.value)&&m(e[t].field2.value)&&m(e[t].field3.value)&&m(e[t].field4.value)?e[t].field1.value===e[t].field2.value&&(e[t].field1.msg="映射参数 x1 不能等于 x2",n=!0):(e[t].field1.msg="映射参数由4个数{x1,x2,x3,x4}组成,如: -1000~1000 -> -100 ~ 100",n=!0)),m(e[t].address.value)?(Number(e[t].address.value)<1||Number(e[t].address.value)>255)&&(e[t].address.msg="请输入一个 1-255 之间的整数",n=!0):(e[t].address.msg="请输入一个 1-255 之间的整数",n=!0),m(e[t].bias.value)?(Number(e[t].bias.value)<=0||Number(e[t].bias.value)>=65535)&&(e[t].bias.msg="请输入一个 0-65535 之间的整数",n=!0):(e[t].bias.msg="请输入一个 0-65535 之间的整数",n=!0),e[t].funcode.value||(e[t].funcode.msg="功能码不能为空",n=!0),1===e[t].funcode.value||2===e[t].funcode.value?7!==e[t].datatype.value&&(e[t].datatype.msg="当功能码为 01读写 / 02只读 时，数据格式应该为 bit",n=!0):7===e[t].datatype.value&&(e[t].datatype.msg="当功能码为 03读写 / 04只读 时，数据格式不能为 bit",n=!0),e[t].datatype.value||(e[t].datatype.msg="数据格式不能为空",n=!0),e[t].orderStr.value?(1!==e[t].datatype.value&&2!==e[t].datatype.value&&6!==e[t].datatype.value||"AB"!==e[t].orderStr.value&&"BA"!==e[t].orderStr.value&&(e[t].orderStr.msg="当数据格式为 16位有符号数 / 16位无符号数 / 16位按位读取，字节顺序应该为 AB / BA",n=!0),3!==e[t].datatype.value&&4!==e[t].datatype.value&&5!==e[t].datatype.value||"AB"!==e[t].orderStr.value&&"BA"!==e[t].orderStr.value&&""!==e[t].orderStr.value||(e[t].orderStr.msg="当数据格式为 32位有符号数 / 32位无符号数 / 32位浮点型数 时，字节顺序应该为 ABCD / CDAB / BADC / DCAB",n=!0),7===e[t].datatype.value&&""!==e[t].orderStr.value&&(e[t].orderStr.msg="当数据格式为 bit 时，字节顺序应该为 空",n=!0)):7!==e[t].datatype.value&&(e[t].orderStr.msg="当数据格式不为 bit 时，字节顺序不能为 空",n=!0),e[t].datas.value?6!==e[t].datatype.value&&(e[t].datas.msg="当数据格式不为 16位按位读取 时，值应该为 空",n=!0):6===e[t].datatype.value&&(e[t].datas.msg="当数据格式为 16位按位读取 时，值不能为 空",n=!0),m(e[t].cycle.value)?10!=e[t].cycle.value&&30!=e[t].cycle.value&&e[t].cycle.value%60!=0&&(e[t].cycle.msg="可选择 10s/30s/60s/120s 或自定义(输入60的倍数)",n=!0):(e[t].cycle.msg="可选择 10s/30s/60s/120s 或自定义(输入60的倍数)",n=!0),n?(a.push(t+1),e[t].editable=!0):e[t].editable=!1}(i);return a.forEach(function(e){r.push(n(e))}),{data:e,errPages:o()(new s.a(r))}},c=function(e,t){if("fromExcel"===t)try{for(var a=0;a<e.length;a++)e[a].type=e[a]["点检类型"],e[a].content=e[a]["点检项"],e[a].mobile=e[a]["点检人账号"],e[a].cycle=e[a]["点检周期"],e[a].editable=!1,delete e[a]["点检类型"],delete e[a]["点检项"],delete e[a]["点检人账号"],delete e[a]["点检周期"]}catch(e){return void l.$message("无法识别的内容，请参照模板文件生成文件")}return e},d=function(e,t,a){if("fromExcel"===t)try{for(var n=0;n<e.length;n++)!function(t){if(e[t]["传感器名称"]?e[t].sensorName={value:e[t]["传感器名称"],msg:""}:e[t].sensorName={value:"",msg:""},e[t]["点位类型"]?(a[0].options.forEach(function(a){a.TypeName===e[t]["点位类型"]&&(e[t].typeSection="state",e[t]["小数位"]="",e[t]["单位"]="",e[t].sensorTypeId={value:a.ID,msg:""})}),a[1].options.forEach(function(a){if(a.TypeName===e[t]["点位类型"]){e[t].typeSection="simulate",e[t].sensorTypeId={value:a.ID,msg:""};var n=[];a.Value&&(n=a.Value.split("|")),-1===n.indexOf(e[t]["单位"])&&(e[t]["单位"]=""),e[t].unitOptions=n}}),e[t].sensorTypeId||(e[t].sensorTypeId={value:"",msg:""})):e[t].sensorTypeId={value:"",msg:""},e[t]["小数位"]?e[t].decimal={value:Number(e[t]["小数位"]),msg:""}:e[t].decimal={value:"",msg:""},e[t]["单位"]?e[t].unit={value:e[t]["单位"],msg:""}:e[t].unit={value:"",msg:""},e[t]["映射"]){var n=e[t]["映射"].split("/");e[t].field1={value:n[0],msg:""},e[t].field2={value:n[1],msg:""},e[t].field3={value:n[2],msg:""},e[t].field4={value:n[3],msg:""}}else e[t].field1={value:"",msg:""},e[t].field2={value:"",msg:""},e[t].field3={value:"",msg:""},e[t].field4={value:"",msg:""};if(e[t]["从站地址"]?e[t].address={value:e[t]["从站地址"],msg:""}:e[t].address={value:"",msg:""},e[t]["功能码"])switch(e[t].funcode={value:e[t]["功能码"],msg:""},e[t].funcode.value){case"01读写":e[t].funcode.value=1;break;case"02只读":e[t].funcode.value=2;break;case"03读写":e[t].funcode.value=3;break;case"04只读":e[t].funcode.value=4}else e[t].funcode={value:"",msg:""};if(e[t]["寄存器地址"]?e[t].bias={value:e[t]["寄存器地址"],msg:""}:e[t].bias={value:"",msg:""},e[t]["数据格式"])switch(e[t].datatype={value:e[t]["数据格式"],msg:""},e[t].datatype.value){case"16位有符号数":e[t].datatype.value=1;break;case"16位无符号数":e[t].datatype.value=2;break;case"32位有符号数":e[t].datatype.value=3;break;case"32位无符号数":e[t].datatype.value=4;break;case"32位浮点型数":e[t].datatype.value=5;break;case"16位按位读取":e[t].datatype.value=6;break;case"bit":e[t].datatype.value=7}else e[t].datatype={value:"",msg:""};e[t]["字节顺序"]?e[t].orderStr={value:e[t]["字节顺序"],msg:""}:e[t].orderStr={value:"",msg:""},e[t]["地址位"]?e[t].datas={value:e[t]["地址位"],msg:""}:e[t].datas={value:"",msg:""},e[t]["采集周期/s"]?e[t].cycle={value:e[t]["采集周期/s"],msg:""}:e[t].cycle={value:"",msg:""},e[t].pointType="1",e[t].editable=!1,e[t].flag=Math.random()}(n)}catch(e){return void alert("无法识别的内容，请参照模板文件生成文件")}else if("fromServer"===t)for(var n=0;n<e.length;n++)!function(t){e[t].sensorName={value:e[t].NEW_NAME,msg:""},e[t].sensorTypeId={value:e[t].TYPE,msg:""},e[t].decimal={value:e[t].DECIMAL_POINT,msg:""},e[t].unit={value:e[t].UNIT,msg:""},e[t].field1={value:""!==e[t].field1&&null!==e[t].field1?e[t].field1:"",msg:""},e[t].field2={value:""!==e[t].field2&&null!==e[t].field2?e[t].field2:"",msg:""},e[t].field3={value:""!==e[t].field3&&null!==e[t].field3?e[t].field3:"",msg:""},e[t].field4={value:""!==e[t].field4&&null!==e[t].field4?e[t].field4:"",msg:""},e[t].funcode={value:e[t].function,msg:""},e[t].bias={value:e[t].address,msg:""},e[t].datatype={value:e[t].dataType,msg:""},e[t].address={value:e[t].slaveId,msg:""},e[t].orderStr={value:e[t].orderStr,msg:""},e[t].datas={value:e[t].bit?e[t].bit:"",msg:""},e[t].cycle={value:e[t].cycle.toString(),msg:""},a[0].options.forEach(function(a){a.ID===e[t].TYPE&&(e[t].typeSection="state")}),a[1].options.forEach(function(a){if(a.ID===e[t].TYPE){e[t].typeSection="simulate";var n=[];a.Value&&(n=a.Value.split("|")),e[t].unitOptions=n}}),e[t].editable=!1,e[t].flag=Math.random()}(n);else if("templateFromServer"===t)for(var n=0;n<e.length;n++)!function(t){e[t].sensorName={value:e[t].sensorName,msg:""},a[0].options.forEach(function(a){a.ID===e[t].sensorTypeId&&(e[t].typeSection="state")}),a[1].options.forEach(function(a){if(a.ID===e[t].sensorTypeId){e[t].typeSection="simulate";var n=[];a.Value&&(n=a.Value.split("|")),e[t].unitOptions=n}}),e[t].sensorTypeId={value:e[t].sensorTypeId,msg:""},e[t].decimal={value:e[t].decimal,msg:""},e[t].unit={value:e[t].unit,msg:""},e[t].field1={value:e[t].field1,msg:""},e[t].field2={value:e[t].field2,msg:""},e[t].field3={value:e[t].field3,msg:""},e[t].field4={value:e[t].field4,msg:""},e[t].fieldId=e[t].fieldId,e[t].address={value:e[t].address,msg:""},e[t].funcode={value:e[t].funcode,msg:""},e[t].bias={value:e[t].bias,msg:""},e[t].datatype={value:e[t].datatype,msg:""},e[t].orderStr={value:e[t].orderStr,msg:""},e[t].datas={value:e[t].datas?e[t].datas:"",msg:""},e[t].cycle={value:e[t].cycle,msg:""},e[t].editable=!1,e[t].flag=Math.random()}(n);else if("tcpGateway"===t)for(var n=0;n<e.length;n++)!function(t){e[t].channel=e[t].Channel,e[t].sensorName={value:e[t].NAME,msg:""},e[t].sensorTypeId={value:e[t].TYPE,msg:""},e[t].decimal={value:e[t].DECIMAL_POINT,msg:""},e[t].unit={value:e[t].UNIT,msg:""};var n=e[t].Map?e[t].Map.split(","):[];e[t].field1={value:n.length?n[0]:"",msg:""},e[t].field2={value:n.length?n[1]:"",msg:""},e[t].field3={value:n.length?n[2]:"",msg:""},e[t].field4={value:n.length?n[3]:"",msg:""},a[0].options.forEach(function(a){a.ID===e[t].TYPE&&(e[t].typeSection="state")}),a[1].options.forEach(function(a){if(a.ID===e[t].TYPE){e[t].typeSection="simulate";var n=[];a.Value&&(n=a.Value.split("|")),e[t].unitOptions=n}}),e[t].editable=!1}(n);return e},p=function(e,t,a){var n={};n.sensorName=t.sensorName,n.sensorName.value=n.sensorName.value+"-copy",n.sensorTypeId=t.sensorTypeId,n.decimal=t.decimal,n.unit=t.unit,n.field1=t.field1,n.field2=t.field2,n.field3=t.field3,n.field4=t.field4,n.editable=!0,a||(n.address=t.address,n.funcode=t.funcode,n.bias=t.bias,n.datatype=t.datatype,n.orderStr=t.orderStr,n.datas=t.datas,n.cycle=t.cycle,n.pointType=t.pointType,n.editable=!0,n.flag=Math.random()),e.unshift(n)},v=function(e,t){var a=[];t.forEach(function(e){var t={};t.sensorName=e.sensorName,t.sensorName.value=t.sensorName.value+"-copy",t.sensorTypeId=e.sensorTypeId,t.decimal=e.decimal,t.unit=e.unit,t.field1=e.field1,t.field2=e.field2,t.field3=e.field3,t.field4=e.field4,t.address=e.address,t.funcode=e.funcode,t.bias=e.bias,t.datatype=e.datatype,t.orderStr=e.orderStr,t.datas=e.datas,t.cycle=e.cycle,t.pointType=e.pointType,t.editable=!0,t.flag=Math.random(),a.push(t)}),e.unshift.apply(e,a)},f=function(e,t,a){if(t)if(a){for(var n=[],r=1;r<a+1;r++){var s={sensorName:{value:"",msg:""},sensorTypeId:{value:"",msg:""},decimal:{value:0,msg:""},unit:{value:"",msg:""},field1:{value:"",msg:""},field2:{value:"",msg:""},field3:{value:"",msg:""},field4:{value:"",msg:""},editable:!0,channel:r};n.push(s)}e.unshift.apply(e,n)}else e.unshift({sensorName:{value:"",msg:""},sensorTypeId:{value:"",msg:""},decimal:{value:0,msg:""},unit:{value:"",msg:""},field1:{value:"",msg:""},field2:{value:"",msg:""},field3:{value:"",msg:""},field4:{value:"",msg:""},editable:!0,channel:""});else e.unshift({sensorName:{value:"",msg:""},sensorTypeId:{value:"",msg:""},decimal:{value:0,msg:""},unit:{value:"",msg:""},field1:{value:"",msg:""},field2:{value:"",msg:""},field3:{value:"",msg:""},field4:{value:"",msg:""},address:{value:"",msg:""},funcode:{value:"",msg:""},bias:{value:"",msg:""},datatype:{value:"",msg:""},orderStr:{value:"",msg:""},datas:{value:"",msg:""},cycle:{value:"",msg:""},pointType:"1",editable:!0,flag:Math.random()})},m=function(e){return""!==e&&parseInt(e,10)==e}},903:function(e,t,a){"use strict";a.d(t,"e",function(){return r}),a.d(t,"d",function(){return s}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return o}),a.d(t,"a",function(){return l});var n=a(32),r=function(e){return n.a.post("/api/DeviceInfo/AddDevicesMQTT",e,{headers:{"Content-Type":"application/json"}})},s=function(e){var t=e.deviceNo,a=e.deviceUserName,r=e.deviceUserPwd;return n.a.get("/api/DeviceInfo/VerifyDevice",{params:{deviceNo:t,deviceUserName:a,deviceUserPwd:r}})},i=function(e){var t=e.deviceId,a=e.pageIndex,r=e.pageSize;return n.a.get("/api/DeviceInfo/GetDeviceMQTTPointPage",{params:{deviceId:t,pageIndex:a,pageSize:r}})},o=function(e){var t=e.deviceName,a=e.deviceID;return n.a.post("/api/DeviceInfo/UpdateDevicesMQTT",null,{params:{deviceName:t,deviceID:a}})},l=function(e){return n.a.get("/api/DeviceInfo/GetDeviceMQTT",{params:{deviceNo:e}})}}});