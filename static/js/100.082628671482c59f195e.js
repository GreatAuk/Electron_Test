webpackJsonp([100],{1046:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"member-connect"},[n("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.clickConnect(t)}}},[e._v("\n    关联成员\n  ")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(t){return e.remove(t)}}},[e._v("\n    批量移除\n  ")]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%","margin-top":"25px"},attrs:{data:e.tableData},on:{"selection-change":function(t){return e.multipleSelection=t}}},[n("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),n("el-table-column",{attrs:{type:"index",label:"#",width:"50px"}}),e._v(" "),n("el-table-column",{attrs:{prop:"Nickname",label:"负责人"}}),e._v(" "),n("el-table-column",{attrs:{prop:"Mobile",label:"联系电话"}}),e._v(" "),n("el-table-column",{attrs:{prop:"SubareaName",label:"服务范围"}})],1),e._v(" "),n("el-dialog",{attrs:{title:"关联用户",visible:e.connectDialog,width:"800px"},on:{"update:visible":function(t){e.connectDialog=t},close:function(){return e.connectMembers=[]}}},[n("el-transfer",{attrs:{filterable:"",titles:["可关联用户","关联用户"],"filter-placeholder":"通过用户名或所有分区查找",data:e.connectSource},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.option;return n("div",{staticClass:"member-item"},[n("img",{staticClass:"user-logo",attrs:{src:e.port+a.Avatar}}),e._v(" "),n("div",{staticClass:"member-info"},[n("div",[e._v(e._s(a.Nickname)+" - "+e._s(a.Mobile))]),e._v(" "),n("div",{staticStyle:{"font-size":"12px",color:"#b4b4b4 !important"}},[e._v("\n            "+e._s(a.SubareaName)+"\n          ")])])])}}]),model:{value:e.connectMembers,callback:function(t){e.connectMembers=t},expression:"connectMembers"}}),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium"},on:{click:function(t){e.connectDialog=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleConnect}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},568:function(e,t,n){n(993);var a=n(38)(n(897),n(1046),null,null);e.exports=a.exports},897:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(229);t.default={props:{role:{type:Object,default:function(){return null}}},data:function(){return{tableLoading:!1,multipleSelection:[],tableData:[],connectDialog:!1,connectSource:[],connectMembers:[],port:_host+"/Img/Person/"}},watch:{role:{handler:function(e){var t=this;e&&(this.fetchMemeberList(),n.i(a.i)({companyId:this.$store.state.app.company.id,roleId:e.RoleId}).then(function(e){var n=e.data;200===n.Code?(n.Data.forEach(function(e){e.key=e.UserRoleSubareaId,e.label=e.Nickname+"-"+e.SubareaName}),t.connectSource=n.Data):t.connectSource=[]}).catch(function(e){t.connectSource=[],t.$message.error("用户角色获取失败")}))},immediate:!0}},methods:{clickConnect:function(){this.connectDialog=!0},remove:function(){var e=this;if(!this.multipleSelection.length)return void this.$message("至少选择一位要移除的成员");this.$confirm("确认要移除选定人员","确认",{type:"warning",distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(){n.i(a.j)({UserRoleIdS:e.multipleSelection.map(function(e){return e.User_roleId}).join(",")}).then(function(t){200===t.data.Code?(e.$message.success("人员移除成功"),e.fetchMemeberList()):e.$message.error("人员移除失败")}).catch(function(t){e.$message.error("人员移除失败")})}).catch(function(){})},handleConnect:function(){var e=this;if(!this.connectMembers.length)return this.$message("请至少选中一位要关联的用户"),!1;n.i(a.k)({RoleId:this.role.RoleId,UserRoleSubareaIds:this.connectMembers,CompanyId:this.$store.state.app.company.id}).then(function(t){200===t.data.Code?(e.$message.success("人员关联成功"),e.connectDialog=!1,e.fetchMemeberList()):e.$message.error("人员关联失败")}).catch(function(t){e.$message.error("人员关联失败")})},fetchMemeberList:function(){var e=this;this.tableLoading=!0,n.i(a.l)({RoleId:this.role.RoleId,companyId:this.$store.state.app.company.id}).then(function(t){var n=t.data;200===n.Code?e.tableData=n.Data:e.$message.error("已关联人员获取失败")}).catch(function(t){e.$message.error("已关联人员获取失败")}).finally(function(){e.tableLoading=!1})}}}},929:function(e,t,n){t=e.exports=n(539)(),t.push([e.i,".member-connect .member-item{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:15px}.member-connect .member-item img{-ms-flex:0 0 45px;flex:0 0 45px;width:45px;height:45px;margin-right:15px;border-radius:50%}.member-connect .el-transfer-panel__item{height:auto;line-height:auto}.member-connect .el-transfer-panel__item .el-checkbox__input{top:15px}.member-connect .el-transfer-panel{width:330px}.member-connect .el-transfer-panel__body{height:380px}.member-connect .el-transfer-panel__list.is-filterable{height:333px}.member-connect .el-transfer-panel__item.el-checkbox .el-checkbox__label{font-weight:400;line-height:20px}",""])},993:function(e,t,n){var a=n(929);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(540)("066bcb56",a,!0)}});