webpackJsonp([13,34,68],{1028:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"point-type"},[n("span",[t._v("所属项目：")]),t._v(" "),n("el-select",{attrs:{placeholder:"请选择项目",size:"small"},on:{change:t.changeProject},model:{value:t.currentProject,callback:function(e){t.currentProject=e},expression:"currentProject"}},t._l(t.proList,function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1),t._v(" "),n("el-input",{staticStyle:{float:"right",width:"190px"},attrs:{size:"small",clearable:"",placeholder:"请输入类型名称（回车）"},on:{clear:t.fetchPointTypeList},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.fetchPointTypeList(e)}},model:{value:t.filterText,callback:function(e){t.filterText="string"==typeof e?e.trim():e},expression:"filterText"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})]),t._v(" "),n("div",{staticStyle:{marginTop:"25px"}},[n("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(e){return t.openEditDialog(-1)}}},[t._v("\n      新增\n    ")]),t._v(" "),n("el-button",{attrs:{size:"small",type:"danger"},nativeOn:{click:function(e){return t.handleDelete(e)}}},[t._v("\n      删除\n    ")])],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{"element-loading-text":"加载中..."}},[n("div",{staticClass:"table-title"},[t._v("\n      状态量：\n    ")]),t._v(" "),n("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData1},on:{"selection-change":t.handleSelectionChange1}},[n("el-table-column",{attrs:{type:"selection",width:"55",selectable:function(t,e){return 0!==t.Edit}}}),t._v(" "),n("el-table-column",{attrs:{prop:"TypeName",label:"类型名称"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Value",label:"状态值"}}),t._v(" "),n("el-table-column",{attrs:{prop:"UpdateTime",label:"最后修改时间"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Operator",label:"修改人"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[0!==e.row.Edit?n("el-button",{attrs:{size:"small",type:"text"},nativeOn:{click:function(n){return t.openEditDialog(e.row.ID)}}},[t._v("\n            编辑\n          ")]):t._e()]}}])})],1),t._v(" "),n("div",{staticClass:"table-title"},[t._v("\n      模拟量：\n    ")]),t._v(" "),n("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData2},on:{"selection-change":t.handleSelectionChange2}},[n("el-table-column",{attrs:{type:"selection",width:"55",selectable:function(t,e){return 0!==t.Edit}}}),t._v(" "),n("el-table-column",{attrs:{prop:"TypeName",label:"类型名称"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Value",label:"单位"}}),t._v(" "),n("el-table-column",{attrs:{prop:"UpdateTime",label:"最后修改时间"}}),t._v(" "),n("el-table-column",{attrs:{prop:"Operator",label:"修改人"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[0!==e.row.Edit?n("el-button",{attrs:{size:"small",type:"text"},nativeOn:{click:function(n){return t.openEditDialog(e.row.ID)}}},[t._v("\n            编辑\n          ")]):t._e()]}}])})],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"新增/修改点位类型",visible:t.dialogVisible,width:"450px"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.dialogClose}},[n("el-form",{ref:"form",staticStyle:{margin:"0 20px"},attrs:{model:t.form,rules:t.formRules,size:"medium","label-width":"80px"}},[n("el-form-item",{attrs:{label:"类型名称",prop:"name"}},[n("el-input",{staticStyle:{width:"200px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name","string"==typeof e?e.trim():e)},expression:"form.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"数值类型",prop:"type"}},[n("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择数值类型"},on:{change:t.changeValueType},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("el-option",{attrs:{label:"状态量",value:1}}),t._v(" "),n("el-option",{attrs:{label:"模拟量",value:2}})],1)],1),t._v(" "),2===t.form.type?n("div",[n("el-form-item",{attrs:{label:"单位"}},[n("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){return t.addFormItem(e)}}},[t._v("\n            添加\n          ")])],1),t._v(" "),t._l(t.form.list,function(e,i){return n("el-form-item",{key:e.key,staticClass:"custom-form-item1",attrs:{rules:{required:!0,message:"请输入单位",trigger:"blur"},prop:"list."+i+".unit"}},[n("el-input",{model:{value:e.unit,callback:function(n){t.$set(e,"unit","string"==typeof n?n.trim():n)},expression:"item.unit"}}),t._v(" "),n("el-button",{staticClass:"btn-danger",attrs:{type:"text"},nativeOn:{click:function(e){return t.delFormItem(i)}}},[t._v("\n            删除\n          ")])],1)})],2):t._e(),t._v(" "),1===t.form.type?n("div",[n("el-form-item",{attrs:{label:"状态值"}},[n("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){return t.addFormItem(e)}}},[t._v("\n            添加\n          ")])],1),t._v(" "),t._l(t.form.list,function(e,i){return n("div",{key:i,staticClass:"custom-form-item2"},[n("el-form-item",{attrs:{rules:{validator:t.checkValue,trigger:"blur"},prop:"list."+i+".value","label-width":"0"}},[n("el-input",{attrs:{placeholder:"数值"},model:{value:e.value,callback:function(n){t.$set(e,"value","string"==typeof n?n.trim():n)},expression:"state.value"}})],1),t._v(" "),n("span",[t._v(":")]),t._v(" "),n("el-form-item",{attrs:{rules:[{required:!0,message:"请输入状态描述",trigger:"blur"},{validator:t.checkLabel,trigger:"blur"}],prop:"list."+i+".showvalue","label-width":"0"}},[n("el-input",{attrs:{placeholder:"状态描述"},model:{value:e.showvalue,callback:function(n){t.$set(e,"showvalue","string"==typeof n?n.trim():n)},expression:"state.showvalue"}})],1),t._v(" "),n("el-button",{staticClass:"btn-danger",attrs:{type:"text"},nativeOn:{click:function(e){return t.delFormItem(i)}}},[t._v("\n            删除\n          ")])],1)})],2):t._e()],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(e){return t.submit(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},1043:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-backgroundConfig"},[n("div",{staticClass:"pointConnect"},[n("el-row",{attrs:{gutter:40}},[n("el-col",{attrs:{md:24,lg:8}},[n("div",{staticClass:"struct bg-fff"},[n("div",{staticClass:"title-wrap"},[n("h3",[n("c-svg",{attrs:{name:"tree","class-name":"title-icon"}}),t._v(" "),n("span",{staticClass:"text"},[t._v("项目结构")])],1)]),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.structLoading,expression:"structLoading"}],staticClass:"content-wrap thin-scroll",attrs:{"element-loading-text":"加载中..."}},[n("el-tree",{attrs:{data:t.structData,"render-content":t.renderContent,"highlight-current":"","node-key":"mtid","current-node-key":t.currentNode.mtid,props:t.structTreeProps,"default-expanded-keys":t.structData?[t.structData[0].mtid]:[],"expand-on-click-node":!1},on:{"node-click":t.handleNodeClick}})],1)])]),t._v(" "),n("el-col",{staticClass:"transfer-wrap",attrs:{md:24,lg:16}},[n("div",{staticClass:"transfer-left bg-fff"},[n("div",{staticClass:"title-wrap"},[n("h3",[n("c-svg",{attrs:{name:"checked","class-name":"title-icon"}}),t._v(" "),n("span",{staticClass:"text"},[t._v("点位池")])],1)]),t._v(" "),n("div",{staticClass:"transfer-search"},[n("el-input",{attrs:{clearable:"",icon:"search",size:"small",placeholder:"输入搜索内容"},model:{value:t.filter,callback:function(e){t.filter="string"==typeof e?e.trim():e},expression:"filter"}})],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pointLoading,expression:"pointLoading"}],staticClass:"transfer-body thin-scroll",attrs:{"element-loading-text":"加载中..."}},[t.filterPointData.length?n("el-checkbox-group",{on:{change:t.leftCheckedChange},model:{value:t.leftChecked,callback:function(e){t.leftChecked=e},expression:"leftChecked"}},t._l(t.filterPointData,function(e){return n("el-checkbox",{key:e.key,attrs:{label:e}},[t._v("\n                "+t._s(e.area+"--"+e.label)+"\n              ")])}),1):n("div",{staticClass:"transfer-no-data"},[t._v("\n              暂无数据\n            ")])],1),t._v(" "),n("div",{staticClass:"transfer-footer",staticStyle:{"line-height":"35px","padding-left":"30px"}},[n("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("\n              全选\n            ")])],1)]),t._v(" "),n("div",{staticClass:"transfer-operation"},[n("el-button",{style:{background:0===t.currentOperationBtn&&t.operationLoading?"#339999":""},attrs:{disabled:t.copyBtnDis||t.operationLoading,icon:0===t.currentOperationBtn&&t.operationLoading?"el-icon-loading":"el-icon-arrow-right",size:"small",type:"primary"},nativeOn:{click:function(e){return t.handleCopy(e)}}},[t._v("\n            复制\n          ")]),t._v(" "),n("el-button",{style:{background:1===t.currentOperationBtn&&t.operationLoading?"#67c23a":""},attrs:{disabled:t.addBtnDis||t.operationLoading,icon:1===t.currentOperationBtn&&t.operationLoading?"el-icon-loading":"el-icon-arrow-right",size:"small",type:"success"},nativeOn:{click:function(e){return t.handleAdd(e)}}},[t._v("\n            移入\n          ")]),t._v(" "),n("el-button",{style:{background:2===t.currentOperationBtn&&t.operationLoading?"#f56c6c":""},attrs:{disabled:t.delBtnDis||t.operationLoading,size:"small",icon:2===t.currentOperationBtn&&t.operationLoading?"el-icon-loading":"el-icon-arrow-left",type:"danger"},nativeOn:{click:function(e){return t.handleDel(e)}}},[t._v("\n            移出\n          ")])],1),t._v(" "),n("div",{staticClass:"transfer-right bg-fff"},[n("div",{staticClass:"title-wrap"},[n("h3",[n("c-svg",{attrs:{name:"parameter","class-name":"title-icon"}}),t._v(" "),n("span",{staticClass:"text"},[t._v("参数信息")])],1)]),t._v(" "),n("div",{staticClass:"level-btn-wrap"},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.currentLevelType,callback:function(e){t.currentLevelType=e},expression:"currentLevelType"}},[n("el-radio-button",{attrs:{label:"level1"}},[t._v("\n                一级参数\n              ")]),t._v(" "),n("el-radio-button",{attrs:{label:"level2"}},[t._v("\n                二级参数\n              ")]),t._v(" "),n("el-radio-button",{attrs:{label:"level3"}},[t._v("\n                三级参数\n              ")])],1)],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.parameterLoading,expression:"parameterLoading"}],staticClass:"transfer-body thin-scroll",attrs:{"element-loading-text":"加载中..."}},[n("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:"level1"===t.currentLevelType,expression:"currentLevelType === 'level1'"}],on:{change:t.rightCheckedChange},model:{value:t.rightChecked,callback:function(e){t.rightChecked=e},expression:"rightChecked"}},t._l(t.level1Parameter,function(e){return n("el-checkbox",{key:e.key,attrs:{label:e}},[t._v("\n                "+t._s(e.area+"--"+e.label)+"\n              ")])}),1),t._v(" "),n("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:"level2"===t.currentLevelType,expression:"currentLevelType === 'level2'"}],on:{change:t.rightCheckedChange},model:{value:t.rightChecked,callback:function(e){t.rightChecked=e},expression:"rightChecked"}},t._l(t.level2Parameter,function(e){return n("el-checkbox",{key:e.key,attrs:{label:e}},[t._v("\n                "+t._s(e.area+"--"+e.label)+"\n              ")])}),1),t._v(" "),n("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:"level3"===t.currentLevelType,expression:"currentLevelType === 'level3'"}],on:{change:t.rightCheckedChange},model:{value:t.rightChecked,callback:function(e){t.rightChecked=e},expression:"rightChecked"}},t._l(t.level3Parameter,function(e){return n("el-checkbox",{key:e.key,attrs:{label:e}},[t._v("\n                "+t._s(e.area+"--"+e.label)+"\n              ")])}),1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"level1"===t.currentLevelType&&!t.level1Parameter.length,expression:"currentLevelType === 'level1' && !level1Parameter.length"}],staticClass:"transfer-no-data"},[t._v("\n              暂无数据\n            ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"level2"===t.currentLevelType&&!t.level2Parameter.length,expression:"currentLevelType === 'level2' && !level2Parameter.length"}],staticClass:"transfer-no-data"},[t._v("\n              暂无数据\n            ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"level3"===t.currentLevelType&&!t.level3Parameter.length,expression:"currentLevelType === 'level3' && !level3Parameter.length"}],staticClass:"transfer-no-data"},[t._v("\n              暂无数据\n            ")])],1),t._v(" "),n("div",{staticClass:"transfer-footer",staticStyle:{"line-height":"35px","padding-left":"30px"}},[n("el-checkbox",{attrs:{indeterminate:t.isIndeterminate2},on:{change:t.handleCheckAllChange2},model:{value:t.checkAll2,callback:function(e){t.checkAll2=e},expression:"checkAll2"}},[t._v("\n              全选\n            ")])],1)])])],1),t._v(" "),n("el-row",{staticClass:"point-list bg-fff"},[n("el-col",{attrs:{sm:24}},[n("div",{staticClass:"navtabs-wrap"},t._l(t.tabList,function(e,i){return n("div",{key:i,class:["navtabs-item",e===t.tabRadio?"is-active":""],style:{color:e===t.tabRadio?"#1890ff":"#303133"},on:{click:function(n){return t.handleTabClick(e)}}},[t._v("\n            "+t._s(e)+"\n          ")])}),0),t._v(" "),n("div",{staticClass:"content-wrap"},[n("el-form",{ref:"deviceForm",staticClass:"clear-fix",attrs:{model:t.deviceForm}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:4}},[n("el-form-item",{attrs:{label:"",size:"small"}},[n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.batchModify(e)}}},[t._v("\n                    批量修改\n                  ")]),t._v(" "),n("el-button",{attrs:{type:"danger"},nativeOn:{click:function(e){return t.removeAllPoint(e)}}},[t._v("\n                    删除\n                  ")])],1)],1),t._v(" "),n("el-col",{staticStyle:{float:"right"},attrs:{span:4}},[n("el-form-item",{attrs:{label:""}},[n("input",{staticStyle:{display:"none"},attrs:{type:"text"}}),t._v(" "),n("el-input",{attrs:{size:"small",clearable:"",placeholder:"请输入点位名称","suffix-icon":"el-icon-search"},on:{clear:function(e){return t.fetchObservePointList(t.deviceForm,1)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.fetchObservePointList(t.deviceForm,1)}},model:{value:t.deviceForm.name,callback:function(e){t.$set(t.deviceForm,"name","string"==typeof e?e.trim():e)},expression:"deviceForm.name"}})],1)],1)],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.observePointListLoading,expression:"observePointListLoading"}],ref:"pointTable",staticStyle:{width:"100%"},attrs:{data:t.observePointList,"element-loading-text":"加载中..."},on:{"filter-change":t.tableFilterChange,"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"35",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{"class-name":"operation-cell",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{loading:e.row.loading,type:"text"},nativeOn:{click:function(n){return t.editRow(e.row)}}},[t._v("\n                  "+t._s(e.row.editable?"保存":"编辑")+"\n                ")]),t._v(" "),n("el-button",{staticClass:"btn-danger",attrs:{type:"text"},nativeOn:{click:function(n){return t.delRow(e.$index,e.row.id,e.row.point,e.row.alarmset)}}},[t._v("\n                  删除\n                ")])]}}])}),t._v(" "),"所有设备"===t.tabRadio?n("el-table-column",{attrs:{prop:"mname"},scopedSlots:t._u([{key:"header",fn:function(e){return[n("el-popover",{attrs:{placement:"bottom-start",width:"190",trigger:"click","popper-class":"pointConnect-table-filter-popover",transition:"el-zoom-in-top"},model:{value:t.filterPopoverVisible,callback:function(e){t.filterPopoverVisible=e},expression:"filterPopoverVisible"}},[n("div",{staticClass:"filter-top"},[n("button",{class:["filter-btn",t.tableFilterDevice.length?"":"disabled"],on:{click:function(e){return t.filterByDevice("filter")}}},[t._v("\n                      筛选\n                    ")]),t._v(" "),n("button",{staticClass:"filter-btn",on:{click:function(e){return t.filterByDevice("reset")}}},[t._v("\n                      重置\n                    ")])]),t._v(" "),n("el-select",{staticStyle:{padding:"8px"},attrs:{multiple:"","collapse-tags":"",filterable:"","popper-class":"pointConnect-table-filter-select",placeholder:"请选择所属位置",size:"mini"},model:{value:t.tableFilterDevice,callback:function(e){t.tableFilterDevice=e},expression:"tableFilterDevice"}},t._l(t.filterDeviceOptions,function(e){return n("el-option-group",{key:e.lable,attrs:{label:e.lable}},t._l(e.options,function(t){return n("el-option",{key:t.value,attrs:{label:t.lable,value:t.value}})}),1)}),1),t._v(" "),n("div",{staticStyle:{cursor:"pointer",display:"block"},attrs:{slot:"reference"},slot:"reference"},[n("span",{style:{color:t.tableFilterDevice.length?"#409EFF":"inherit"}},[t._v("设备")]),t._v(" "),n("i",{staticClass:"el-icon-arrow-down",staticStyle:{"font-size":"12px",color:"#909399",transform:"scale(.75)"}})])],1)]}}],null,!1,38766629)}):t._e(),t._v(" "),n("el-table-column",{attrs:{prop:"pname",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editable?t._e():n("span",[t._v(t._s(e.row.pname))]),t._v(" "),e.row.editable?n("el-input",{ref:"pnameInput",class:"pnameInput"+e.row.point,attrs:{clearable:"",size:"small"},on:{blur:function(n){return t.inputPointName(e.row)}},model:{value:e.row.pname,callback:function(n){t.$set(e.row,"pname","string"==typeof n?n.trim():n)},expression:"scope.row.pname"}}):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"typename",label:"类型",filters:t.filterPointType,"column-key":"typename"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editable?t._e():n("span",[t._v(t._s(e.row.typename))]),t._v(" "),e.row.editable?n("div",[n("el-select",{attrs:{filterable:"",placeholder:"请选择点位类型",size:"small"},on:{change:function(n){return t.changePointType(e.row)}},model:{value:e.row.type,callback:function(n){t.$set(e.row,"type",n)},expression:"scope.row.type"}},t._l(t.pointTypeList,function(e){return n("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,function(i){return n("el-option",{key:i.ID,attrs:{label:i.TypeName,value:i.ID}},[n("span",{staticStyle:{float:"left","margin-right":"25px"}},[t._v(t._s(i.TypeName))]),t._v(" "),"状态量"===e.label?n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(i.Value))]):t._e()])}),1)}),1)],1):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"unit",label:"单位",filters:t.filterPointUnit,"column-key":"unit","filter-multiple":!1},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editable?t._e():n("span",[t._v(t._s("2"===e.row.state?e.row.unit:"-"))]),t._v(" "),e.row.editable&&"2"===e.row.state?n("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:e.row.unit,callback:function(n){t.$set(e.row,"unit",n)},expression:"scope.row.unit"}},t._l(e.row.unitOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"level","column-key":"level",label:"测点级别",filters:[{text:"一级",value:1},{text:"二级",value:2},{text:"三级",value:3}]},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editable?t._e():n("span",[t._v(t._s("1"===e.row.lev?"一级测点":"2"===e.row.lev?"二级测点":"3"===e.row.lev?"三级测点":""))]),t._v(" "),e.row.editable?n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.row.lev,callback:function(n){t.$set(e.row,"lev",n)},expression:"scope.row.lev"}},[n("el-option",{attrs:{label:"一级测点",value:"1"}}),t._v(" "),n("el-option",{attrs:{label:"二级测点",value:"2"}}),t._v(" "),n("el-option",{attrs:{label:"三级测点",value:"3"}})],1):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"valinfo",sortable:"",label:"当前值"}}),t._v(" "),n("el-table-column",{attrs:{prop:"utime",sortable:"",label:"更新时间"}}),t._v(" "),n("el-table-column",{attrs:{prop:"alarmset",sortable:"",label:"报警配置","filter-multiple":!1,"column-key":"alarmset",filters:[{text:"未配置",value:"0"},{text:"已配置",value:"1"}]},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{size:"small",type:"0"===e.row.alarmset?"info":""}},[t._v("\n                  "+t._s("0"===e.row.alarmset?"未配置":"已配置")+"\n                ")])]}}])})],1),t._v(" "),n("el-pagination",{attrs:{background:"",total:t.pagination.total,"current-page":t.pagination.currentPage,"page-size":t.pagination.pageSize,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)},"update:pageSize":function(e){return t.$set(t.pagination,"pageSize",e)},"update:page-size":function(e){return t.$set(t.pagination,"pageSize",e)},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"批量修改",visible:t.attributeDialog,width:"400px"},on:{"update:visible":function(e){t.attributeDialog=e}}},[n("el-form",{ref:"attrForm",attrs:{model:t.attrForm,rules:t.attrFormRule,"label-width":"120px",size:"medium"}},[n("div",{staticStyle:{"margin-left":"25px","margin-bottom":"25px"}},[t._v("\n        已选中点位:"),n("span",{staticStyle:{color:"#F9D462","font-size":"18px","margin-left":"20px","margin-right":"6px"}},[t._v(t._s(t.selectPoints.length))]),t._v("个\n      ")]),t._v(" "),n("el-form-item",{attrs:{label:"选择属性："}},[n("el-select",{attrs:{placeholder:"请选择属性"},on:{change:t.switchType},model:{value:t.attrForm.type,callback:function(e){t.$set(t.attrForm,"type",e)},expression:"attrForm.type"}},[n("el-option",{attrs:{label:"名称",value:1}}),t._v(" "),n("el-option",{attrs:{label:"类型/单位",value:2}}),t._v(" "),n("el-option",{attrs:{label:"测点级别",value:3}})],1)],1),t._v(" "),1===t.attrForm.type?n("el-form-item",{ref:"pointname",attrs:{label:"输入新名称：",prop:"pointname"}},[n("el-input",{staticStyle:{width:"217px"},attrs:{placeholder:"请输入名称",clearable:""},model:{value:t.attrForm.pointname,callback:function(e){t.$set(t.attrForm,"pointname","string"==typeof e?e.trim():e)},expression:"attrForm.pointname"}})],1):t._e(),t._v(" "),2===t.attrForm.type?n("el-form-item",{ref:"pointtype",attrs:{label:"选择类型：",prop:"pointtype"}},[n("el-select",{attrs:{filterable:"",placeholder:"请选择点位类型"},on:{change:function(e){return t.switchPointType(t.attrForm.pointtype)}},model:{value:t.attrForm.pointtype,callback:function(e){t.$set(t.attrForm,"pointtype",e)},expression:"attrForm.pointtype"}},t._l(t.pointTypeList,function(e){return n("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,function(i){return n("el-option",{key:i.ID,attrs:{label:i.TypeName,value:i.ID}},[n("span",{staticStyle:{float:"left","margin-right":"25px"}},[t._v(t._s(i.TypeName))]),t._v(" "),"状态量"===e.label?n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(i.Value))]):t._e()])}),1)}),1)],1):t._e(),t._v(" "),2===t.attrForm.type&&"2"===t.selectPointType.state?n("el-form-item",{ref:"pointunit",attrs:{label:"选择单位：",prop:"pointunit"}},[n("el-select",{attrs:{placeholder:"请选择单位",disabled:0===t.selectPointType.unitOptions.length},model:{value:t.attrForm.pointunit,callback:function(e){t.$set(t.attrForm,"pointunit",e)},expression:"attrForm.pointunit"}},t._l(t.selectPointType.unitOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1):t._e(),t._v(" "),3===t.attrForm.type?n("el-form-item",{attrs:{label:"选择级别："}},[n("el-select",{attrs:{placeholder:"请选择测点级别"},model:{value:t.attrForm.pointlevel,callback:function(e){t.$set(t.attrForm,"pointlevel",e)},expression:"attrForm.pointlevel"}},[n("el-option",{attrs:{label:"一级",value:1}}),t._v(" "),n("el-option",{attrs:{label:"二级",value:2}}),t._v(" "),n("el-option",{attrs:{label:"三级",value:3}})],1)],1):t._e()],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){return t.closeAttributeDialog("attrForm")}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitAttrForm("attrForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},1089:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(564),r=n.n(i),a=n(565),o=n.n(a);e.default={components:{PointConfig:r.a,PointType:o.a},data:function(){return{tabsActive:"first"}}}},1255:function(t,e,n){e=t.exports=n(539)(),e.push([t.i,".point-connect .el-tabs__nav-scroll{padding-left:40px;background:#fff}",""])},1385:function(t,e,n){var i=n(1255);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(540)("491e6729",i,!0)},1538:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"point-connect"},[n("el-tabs",{model:{value:t.tabsActive,callback:function(e){t.tabsActive=e},expression:"tabsActive"}},[n("el-tab-pane",{attrs:{label:"点位配置",name:"first"}},[n("div",{staticClass:"pdg"},[n("point-config",{attrs:{visible:"first"===t.tabsActive}})],1)]),t._v(" "),n("el-tab-pane",{attrs:{label:"点位类型",name:"second"}},[n("div",{staticClass:"pdg"},[n("point-type")],1)])],1)],1)},staticRenderFns:[]}},564:function(t,e,n){n(990),n(991);var i=n(38)(n(892),n(1043),"data-v-8d43374c",null);t.exports=i.exports},565:function(t,e,n){n(983),n(982);var i=n(38)(n(893),n(1028),"data-v-2c3ed75c",null);t.exports=i.exports},588:function(t,e,n){n(1385);var i=n(38)(n(1089),n(1538),null,null);t.exports=i.exports},684:function(t,e,n){var i=n(133)("meta"),r=n(58),a=n(69),o=n(59).f,l=0,s=Object.isExtensible||function(){return!0},c=!n(68)(function(){return s(Object.preventExtensions({}))}),p=function(t){o(t,i,{value:{i:"O"+ ++l,w:{}}})},u=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!s(t))return"F";if(!e)return"E";p(t)}return t[i].i},f=function(t,e){if(!a(t,i)){if(!s(t))return!0;if(!e)return!1;p(t)}return t[i].w},d=function(t){return c&&h.NEED&&s(t)&&!a(t,i)&&p(t),t},h=t.exports={KEY:i,NEED:!1,fastKey:u,getWeak:f,onFreeze:d}},685:function(t,e,n){var i=n(58);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},686:function(t,e,n){var i=n(70);t.exports=Array.isArray||function(t){return"Array"==i(t)}},687:function(t,e,n){t.exports={default:n(688),__esModule:!0}},688:function(t,e,n){n(215),n(134),n(213),n(698),n(701),n(700),n(699),t.exports=n(14).Set},689:function(t,e,n){var i=n(210);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},690:function(t,e,n){var i=n(60),r=n(136),a=n(72),o=n(90),l=n(692);t.exports=function(t,e){var n=1==t,s=2==t,c=3==t,p=4==t,u=6==t,f=5==t||u,d=e||l;return function(e,l,h){for(var m,v,g=a(e),b=r(g),y=i(l,h,3),x=o(b.length),_=0,k=n?d(e,x):s?d(e,0):void 0;x>_;_++)if((f||_ in b)&&(m=b[_],v=y(m,_,g),t))if(n)k[_]=v;else if(v)switch(t){case 3:return!0;case 5:return m;case 6:return _;case 2:k.push(m)}else if(p)return!1;return u?-1:c||p?p:k}}},691:function(t,e,n){var i=n(58),r=n(686),a=n(21)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},692:function(t,e,n){var i=n(691);t.exports=function(t,e){return new(i(t))(e)}},693:function(t,e,n){"use strict";var i=n(59).f,r=n(214),a=n(212),o=n(60),l=n(211),s=n(210),c=n(137),p=n(216),u=n(217),f=n(61),d=n(684).fastKey,h=n(685),m=f?"_s":"size",v=function(t,e){var n,i=d(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var p=t(function(t,i){l(t,p,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=i&&s(i,n,t[c],t)});return a(p.prototype,{clear:function(){for(var t=h(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var n=h(this,e),i=v(n,t);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[m]--}return!!i},forEach:function(t){h(this,e);for(var n,i=o(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!v(h(this,e),t)}}),f&&i(p.prototype,"size",{get:function(){return h(this,e)[m]}}),p},def:function(t,e,n){var i,r,a=v(t,e);return a?a.v=n:(t._l=a={i:r=d(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[m]++,"F"!==r&&(t._i[r]=a)),t},getEntry:v,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=h(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?p(0,n.k):"values"==e?p(0,n.v):p(0,[n.k,n.v]):(t._t=void 0,p(1))},n?"entries":"values",!n,!0),u(e)}}},694:function(t,e,n){var i=n(135),r=n(689);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},695:function(t,e,n){"use strict";var i=n(15),r=n(39),a=n(684),o=n(68),l=n(52),s=n(212),c=n(210),p=n(211),u=n(58),f=n(89),d=n(59).f,h=n(690)(0),m=n(61);t.exports=function(t,e,n,v,g,b){var y=i[t],x=y,_=g?"set":"add",k=x&&x.prototype,P={};return m&&"function"==typeof x&&(b||k.forEach&&!o(function(){(new x).entries().next()}))?(x=e(function(e,n){p(e,x,t,"_c"),e._c=new y,void 0!=n&&c(n,g,e[_],e)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in k&&(!b||"clear"!=t)&&l(x.prototype,t,function(n,i){if(p(this,x,t),!e&&b&&!u(n))return"get"==t&&void 0;var r=this._c[t](0===n?0:n,i);return e?this:r})}),b||d(x.prototype,"size",{get:function(){return this._c.size}})):(x=v.getConstructor(e,t,g,_),s(x.prototype,n),a.NEED=!0),f(x,t),P[t]=x,r(r.G+r.W+r.F,P),b||v.setStrong(x,t,g),x}},696:function(t,e,n){"use strict";var i=n(39),r=n(71),a=n(60),o=n(210);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,l,s=arguments[1];return r(this),e=void 0!==s,e&&r(s),void 0==t?new this:(n=[],e?(i=0,l=a(s,arguments[2],2),o(t,!1,function(t){n.push(l(t,i++))})):o(t,!1,n.push,n),new this(n))}})}},697:function(t,e,n){"use strict";var i=n(39);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},698:function(t,e,n){"use strict";var i=n(693),r=n(685);t.exports=n(695)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"Set"),t=0===t?0:t,t)}},i)},699:function(t,e,n){n(696)("Set")},700:function(t,e,n){n(697)("Set")},701:function(t,e,n){var i=n(39);i(i.P+i.R,"Set",{toJSON:n(694)("Set")})},722:function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"e",function(){return a}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return l}),n.d(e,"d",function(){return s}),n.d(e,"g",function(){return c}),n.d(e,"h",function(){return p}),n.d(e,"i",function(){return u}),n.d(e,"j",function(){return f}),n.d(e,"f",function(){return d});var i=n(32),r=function(t){return i.a.post("/api/PointType/PointTypeInsert",t)},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return i.a.get("/api/PointType/PointTypeList",{params:{projectId:t,TypeName:e}})},o=function(t){return i.a.post("/api/PointType/PointTypeDelete",t)},l=function(t,e){return i.a.get("/api/PointType/PointTypeQuery",{params:{ID:t,projectId:e}})},s=function(t){return i.a.post("/api/PointType/PointTypeUpdate",t)},c=function(t){return i.a.post("/api/EditPoint/GetModePointType",t)},p=function(t){return i.a.post("/api/EditPoint/GetModePointUnit",t)},u=function(t){return i.a.post("/api/EditPoint/updateDmpSetS",t)},f=function(t){return i.a.post("/api/EditPoint/QueryModelSWList",t)},d=function(t){return i.a.post("/api/EditPoint/GetProjectdmpTable",t)}},730:function(t,e,n){"use strict";n.d(e,"h",function(){return r}),n.d(e,"i",function(){return a}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return l}),n.d(e,"g",function(){return s}),n.d(e,"f",function(){return c}),n.d(e,"a",function(){return p}),n.d(e,"d",function(){return u}),n.d(e,"e",function(){return f});var i=n(32),r=function(t,e,n,r){return i.a.get("/api/EditPoint/getPointByPro",{params:{pid:t,uid:e,mtid:n,type:r}})},a=function(t,e){return i.a.get("/api/EditPoint/getPointByMtid",{params:{mtid:t,type:e}})},o=function(t,e){return i.a.get("/api/EditPoint/queryPoint",{params:{mtid:t,point:e}})},l=function(t,e){return i.a.get("/api/EditPoint/deleteDmpset",{params:{mtid:t,point:e}})},s=function(t){return i.a.post("/api/EditPoint/deleteDmpset",t)},c=function(t){return i.a.post("/api/EditPoint/updateDmpSet",t)},p=function(t){return i.a.get("/api/EditPoint/areaList",{params:{project:t}})},u=function(t){return i.a.post("/api/EditPoint/addInfoPost",t)},f=function(t,e){return i.a.post("/api/EditPoint/deleteInfo",{mtid:t,points:e})}},892:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(687),r=n.n(i),a=n(220),o=n.n(a),l=n(132),s=n.n(l),c=n(730),p=n(722);e.default={props:{visible:Boolean},data:function(){var t=this,e=function(e,n,i){2===t.attrForm.type?!t.attrForm.pointtype&&i(new Error("请选择点位类型")):3===t.attrForm.type&&!t.attrForm.pointlevel&&i(new Error("请选择测点级别")),i()},n=function(t,e,n){var i=/[`~!@#$%^&*()+<>?:"{},.\/;'[\]]/im;e?i.test(e)?n(new Error("请输入正确的点位名称")):n():n(new Error("请输入点位名称"))};return{structTreeProps:{children:"Child",label:"mname"},currentNode:{mtid:"",projectId:"",type:""},structLoading:!1,parameterLoading:!1,pointLoading:!1,formVisible:!1,pointData:[],tempParameter:[],level1Parameter:[],level2Parameter:[],level3Parameter:[],isIndeterminate:!0,isIndeterminate2:!1,checkAll:!1,checkAll2:!1,leftChecked:[],rightChecked:[],currentOperationBtn:-1,operationLoading:!1,currentLevelType:"level1",deviceForm:{project:"",mtids:"",mname:"",name:"",unit:"",type:"",level:"",alarmsetwhere:"",page:1,num:10,types:"",levels:""},observePointList:[],observePointListLoading:!1,pagination:{total:0,currentPage:1,pageSize:10},filter:"",pointTypeList:[],userId:JSON.parse(sessionStorage.getItem("userInfo")).uid,filterPointType:[],filterPointUnit:[],attributeDialog:!1,attrForm:{pointname:"",pointtype:"",type:"",pointlevel:"",pointunit:""},selectPoints:[],attrFormRule:{pointtype:[{validator:e,trigger:"change"}],pointlevel:[{validator:e,trigger:"change"}],pointunit:[{required:!0,message:"请选择单位",trigger:"change"}],pointname:[{validator:n,trigger:"blur"}]},tablePointNameValid:!0,selectPointType:{state:"",unitOptions:[]},tabRadio:"当前设备",tableFilterDevice:"",filterDeviceOptions:[],filterPopoverVisible:!1,deviceIdReplace:"",tabList:["当前设备","所有设备"],mtidArr:[],pointArr:[]}},computed:{project:function(t){return this.$store.state.app.project.id},proList:function(){return this.$store.state.app.proList},structData:function(){return this.$store.state.app.structTree},copyBtnDis:function(){return!this.leftChecked.length},addBtnDis:function(){return!this.leftChecked.length},delBtnDis:function(){return!this.rightChecked.length},filterPointData:function(){var t=this;return this.checkAll=!1,this.isIndeterminate=!1,this.pointData.filter(function(e){return(e.area+"--"+e.label).toLowerCase().indexOf(t.filter.toLowerCase())>-1})}},watch:{currentLevelType:function(t,e){this.rightChecked=[]},visible:function(t){t&&this.fetchPointTypeList(this.project)},structData:{handler:function(t){var e=t[0];this.fetchPointList(e.pid,e.mtid,e.type),this.deviceForm.mtids=e.mtid,this.fetchObservePointList(this.deviceForm)}},project:function(t){this.deviceForm.project=t,this.filter="",this.pointData=[],this.tempParameter=[],this.level1Parameter=[],this.level2Parameter=[],this.level3Parameter=[],this.leftChecked=[],this.rightChecked=[],this.observePointList=[],this.pagination.total=0,this.pagination.currentPage=1,this.fetchPointTypeList(t)}},mounted:function(){this.fetchPointTypeList(this.project)},methods:{handleNodeClick:function(t,e,n){var i=JSON.parse(sessionStorage.getItem("project")).label;e.data.mname!==i?this.filter=e.data.mname:this.filter="",this.tabRadio="当前设备",this.currentNode.mtid=e.data.mtid,this.currentNode.projectId=e.data.pid,this.currentNode.type=e.data.type,this.deviceForm.mtids=e.data.mtid,this.deviceIdReplace=e.data.mtid,this.deviceForm.project=e.data.pid,this.currentLevelType="level1",this.fetchParameter(this.currentNode.mtid,this.currentNode.type),this.fetchObservePointList(this.deviceForm),this.fetchPointFilterList(this.currentNode.mtid),this.leftChecked=[],this.rightChecked=[],this.checkAll=!1,this.checkAll2=!1,this.isIndeterminate=!1,this.isIndeterminate2=!1,this.$refs.pointTable.clearFilter(),this.deviceForm.unit="",this.deviceForm.types="",this.deviceForm.levels="",this.deviceForm.alarmsetwhere="",this.deviceForm.name=""},renderContent:function(t,e){var n=e.node,i=e.data,r=(e.store,null);return 0===i.type?r=t("svg",{class:"icon",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xlink:href":"#icon-ceng"}})]):1===i.type&&(r=t("svg",{class:"icon",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xlink:href":"#icon-cube1"}})])),t("span",{style:"white-space: normal;"},[t("span",[r,t("span",[n.label])])])},handleCheckAllChange:function(t){this.leftChecked=t?this.filterPointData:[],this.isIndeterminate=!1},handleCheckAllChange2:function(t){"level1"===this.currentLevelType?this.rightChecked=t?this.level1Parameter:[]:"level2"===this.currentLevelType?this.rightChecked=t?this.level2Parameter:[]:this.rightChecked=t?this.level3Parameter:[],this.isIndeterminate2=!1},leftCheckedChange:function(t){var e=t.length;this.checkAll=e===this.filterPointData.length,this.isIndeterminate=e>0&&e<this.filterPointData.length},rightCheckedChange:function(t){var e=t.length;"level1"===this.currentLevelType?(this.checkAll2=e===this.level1Parameter.length,this.isIndeterminate2=e>0&&e<this.level1Parameter.length):"level2"===this.currentLevelType?(this.checkAll2=e===this.level2Parameter.length,this.isIndeterminate2=e>0&&e<this.level2Parameter.length):(this.checkAll2=e===this.level2Parameter.length,this.isIndeterminate2=e>0&&e<this.level3Parameter.length)},handleCopy:function(){var t=this;if(this.isExistParameter())return!1;this.operationLoading=!0,this.currentOperationBtn=0;var e=this.handleLevel(this.currentLevelType),i=this.leftChecked.map(function(t){return t.key}).join(",");n.i(c.d)({mtid:this.currentNode.mtid,level:e,points:i,type:this.currentNode.type,otype:0}).then(function(e){if("00"===JSON.parse(e.data).flag){var n;t.fetchObservePointList(t.deviceForm),(n=t[t.currentLevelType+"Parameter"]).push.apply(n,s()(t.leftChecked))}else t.$message("点位配置失败")}).catch(function(e){t.$message.error("点位配置失败")}).then(function(){t.operationLoading=!1,t.currentOperationBtn=-1,t.leftChecked=[]})},handleAdd:function(){var t=this;if(this.isExistParameter())return!1;this.operationLoading=!0,this.currentOperationBtn=1;var e=this.handleLevel(this.currentLevelType),i=this.leftChecked.map(function(t){return t.key}).join(",");n.i(c.d)({mtid:this.currentNode.mtid,level:e,points:i,type:this.currentNode.type,otype:1}).then(function(e){if("00"===JSON.parse(e.data).flag){var n;t.fetchObservePointList(t.deviceForm),(n=t[t.currentLevelType+"Parameter"]).push.apply(n,s()(t.leftChecked));for(var i=0;i<t.leftChecked.length;i++)!function(e){t.pointData=t.pointData.filter(function(n){return n!==t.leftChecked[e]})}(i)}else t.$message("点位配置失败")}).catch(function(e){t.$message.error("点位配置失败")}).then(function(){t.operationLoading=!1,t.currentOperationBtn=-1,t.leftChecked=[]})},handleDel:function(){var t=this;this.operationLoading=!0,this.currentOperationBtn=2;var e=this.rightChecked.map(function(t){return t.key}).join(",");n.i(c.e)(this.currentNode.mtid,e).then(function(e){if("00"===JSON.parse(e.data).flag){t.fetchPointList(t.currentNode.projectId,t.currentNode.mtid,t.currentNode.type),t.fetchObservePointList(t.deviceForm);for(var n=0;n<t.rightChecked.length;n++)!function(e){t[t.currentLevelType+"Parameter"]=t[t.currentLevelType+"Parameter"].filter(function(n){return n!==t.rightChecked[e]})}(n)}else t.$message("点位配置失败")}).catch(function(e){t.$message.error("点位配置失败")}).then(function(){t.operationLoading=!1,t.currentOperationBtn=-1,t.rightChecked=[],t.isIndeterminate2=!1,t.checkAll2=!1})},handleFormVisible:function(){this.formVisible=!this.formVisible},searchObsPoint:function(t){var e=this;if(!this.currentNode.mtid)return void this.$message("请先在结构信息中选择位置");this.$refs[t].validate(function(t){if(!t)return!1;e.fetchObservePointList(e.deviceForm)})},handleSizeChange:function(t){this.pagination.currentPage=1,this.deviceForm.page=1,this.deviceForm.num=t,this.fetchObservePointList(this.deviceForm)},handleCurrentChange:function(t){this.deviceForm.page=t,this.fetchObservePointList(this.deviceForm)},changePointType:function(t){if(t.unit="",this.pointTypeList[0].options.forEach(function(e){e.ID===t.type&&(t.state="1",t.typename=e.TypeName)}),this.pointTypeList[1].options.forEach(function(e){e.ID===t.type&&(t.state="2",t.typename=e.TypeName)}),"2"===t.state){var e=[],n=this.pointTypeList[1].options.filter(function(e){return e.ID===t.type})[0];n.Value&&(e=n.Value.split("|")),t.unitOptions=e}else t.unitOptions=[]},editRow:function(t){var e=this;if(t.editable){if(!this.tablePointNameValid)return this.$message("请填写正确的点位名称"),!1;t.editable=!1,this.$set(t,"loading",!0);var i={};i.area=t.area,i.pname=t.pname,i.unit=t.unit,i.typename=t.typename,i.level=t.lev,i.alarmlevel=t.alev,i.type=t.type,i.id=t.id,i.point=t.point,n.i(c.f)(i).then(function(t){"00"===JSON.parse(t.data).flag?(e.$message({type:"success",message:"修改成功"}),e.fetchParameter(e.currentNode.mtid,e.currentNode.type)):e.$message.error("修改失败")}).catch(function(t){e.$message.error("服务器错误,修改失败")}).finally(function(){t.loading=!1})}else if(t.editable=!0,"2"===t.state){var r=[],a=this.pointTypeList[1].options.filter(function(e){return e.ID===t.type})[0];a.Value&&(r=a.Value.split("|")),t.unitOptions=r}},delRow:function(t,e,i,r){var a=this;if("1"===r)return this.$message.warning("该点位已配置报警，不能删除"),!1;this.curObsPoint={index:t,id:e,pointId:i},this.$confirm("确认要删除该监测点位？","提示",{type:"warning"}).then(function(){n.i(c.b)(a.curObsPoint.id,a.curObsPoint.pointId).then(function(t){"00"===JSON.parse(t.data).flag?(a.$message({type:"success",message:"删除成功"}),a.fetchPointList(a.currentNode.projectId,a.currentNode.mtid,a.currentNode.type),a.fetchParameter(a.currentNode.mtid,a.currentNode.type),a.fetchObservePointList(a.deviceForm)):a.$message.error("删除失败")}).catch(function(t){a.$message.error("服务器错误")})})},removeAllPoint:function(){var t=this;if(!this.selectPoints.length)return this.$message("请至少选择一个点位"),!1;if(this.selectPoints.some(function(t){return"1"===t.alarmset}))return this.$message("已配置报警点的点位不能删除"),!1;var e={mtids:this.mtidArr.join(","),pointS:this.pointArr.join(",")};this.$confirm("确认要删除以下监测点位?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.i(c.g)(e).then(function(e){e.data>0?(t.$message({type:"success",message:"删除成功!"}),t.fetchObservePointList(t.deviceForm),t.fetchPointList(t.currentNode.projectId,t.currentNode.mtid,t.currentNode.type),t.fetchParameter(t.currentNode.mtid,t.currentNode.type)):t.$message.error("删除失败")})}).then(function(){t.mtidArr=[],t.pointArr=[]})},fetchObservePointList:function(t,e){var i=this;1===e&&(this.pagination.currentPage=1,t.page=1),this.deviceForm.project=this.project,this.observePointListLoading=!0,n.i(p.f)(t).then(function(t){var e=t.data;e.success?(i.pagination.total=e.totalnum,e.list.forEach(function(t){t.editable=!1,t.type=parseInt(t.type)}),i.observePointList=e.list):(i.observePointList=[],i.pagination.total=0)}).catch(function(t){i.$message.error("服务器错误，监测点列表数据获取失败")}).then(function(){i.observePointListLoading=!1})},fetchPointList:function(t,e,i){var r=this;this.pointLoading=!0,n.i(c.h)(t,this.userId,e,i).then(function(t){var e=JSON.parse(t.data);r.pointLoading=!1,e.success?r.pointData=e.list:r.pointData=[]}).catch(function(t){r.$message.error("服务器错误")})},fetchParameter:function(t,e){var i=this;this.parameterLoading=!0,n.i(c.i)(t,e).then(function(t){i.parameterLoading=!1;var e=JSON.parse(t.data);e.success?(i.level1Parameter=e.level1,i.level2Parameter=e.level2,i.level3Parameter=e.level3):(i.level1Parameter=[],i.level2Parameter=[],i.level3Parameter=[])}).catch(function(t){})},fetchPointTypeList:function(t){var e=this;n.i(p.e)(t).then(function(t){var n=JSON.parse(t.data);e.pointTypeList=[{label:"状态量",options:n.State},{label:"模拟量",options:n.Analog}]})},handleLevel:function(){var t=1;switch(this.currentLevelType){case"level1":t=1;break;case"level2":t=2;break;case"level3":t=3}return t},isExistParameter:function(){var t=this,e=!1,n=this.level1Parameter.map(function(t){return t.key}),i=this.level2Parameter.map(function(t){return t.key}),r=this.level3Parameter.map(function(t){return t.key});return this.leftChecked.forEach(function(a){n.indexOf(a.key)>-1&&(setTimeout(function(){t.$notify.info({title:"提示",message:"一级参数中已存在相同的点："+a.area+"--"+a.label,duration:6e3,offset:60})},0),e=!0),i.indexOf(a.key)>-1&&(setTimeout(function(){t.$notify.info({title:"提示",message:"二级参数中已存在相同的点："+a.area+"--"+a.label,duration:6e3,offset:60})},0),e=!0),r.indexOf(a.key)>-1&&(setTimeout(function(){t.$notify.info({title:"提示",message:"三级参数中已存在相同的点："+a.area+"--"+a.label,duration:6e3,offset:60})},0),e=!0)}),e},tableFilterChange:function(t){switch(o()(t)[0]){case"typename":this.deviceForm.types=t.typename.join(",");break;case"unit":this.deviceForm.unit=t.unit.join(",");break;case"alarmset":this.deviceForm.alarmsetwhere=t.alarmset.join(",");break;case"level":this.deviceForm.levels=t.level.join(",")}this.deviceForm.page=1,this.pagination.currentPage=1,this.fetchObservePointList(this.deviceForm)},fetchPointFilterList:function(t){var e=this,i={projectID:this.project,mtid:t||""};n.i(p.g)(i).then(function(t){e.filterPointType=t.data}),n.i(p.h)(i).then(function(t){e.filterPointUnit=t.data})},batchModify:function(){if(!this.selectPoints.length)return this.$message("请至少选择一个点位"),!1;this.attributeDialog=!0},handleSelectionChange:function(t){var e=this;t.forEach(function(t){e.mtidArr.push(t.id),e.pointArr.push(t.point)}),this.mtidArr=[].concat(s()(new r.a(this.mtidArr))),this.pointArr=[].concat(s()(new r.a(this.pointArr))),this.selectPoints=t},switchType:function(t){this.$refs.attrForm.resetFields(),this.attrForm.type=t,2===this.attrForm.type&&(this.selectPointType.state="")},switchPointType:function(t){var e=this;if(this.selectPointType.state="",this.attrForm.pointunit="",this.pointTypeList[0].options.forEach(function(n){n.ID===t&&(e.selectPointType.state="1")}),this.pointTypeList[1].options.forEach(function(n){n.ID===t&&(e.selectPointType.state="2")}),"2"===this.selectPointType.state){var n=[],i=this.pointTypeList[1].options.filter(function(e){return e.ID===t})[0];i.Value&&(n=i.Value.split("|")),this.selectPointType.unitOptions=n}else this.selectPointType.unitOptions=[]},closeAttributeDialog:function(t){this.$refs[t].resetFields(),this.attrForm.type="",this.attributeDialog=!1},submitAttrForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var i={pointS:"",pname:"",type:null,unit:"",level:null};i.pointS=e.selectPoints.map(function(t){return t.point}).join(","),1===e.attrForm.type?i.pname=e.attrForm.pointname:2===e.attrForm.type?(i.type=e.attrForm.pointtype,i.unit=e.attrForm.pointunit):i.level=e.attrForm.pointlevel,n.i(p.i)(i).then(function(t){t.data>0?(e.$message.success("批量点位修改成功"),e.fetchObservePointList(e.deviceForm)):e.$message.error("批量点位修改失败")}).catch(function(t){e.$message.error("批量点位修改失败")}).finally(function(){e.attributeDialog=!1,e.attrForm.type=1,e.attrForm.pointname="",e.attrForm.pointunit="",e.attrForm.pointtype="",e.selectPointType.unitOptions=[]})})},handleTabClick:function(t){var e=this;if(this.tabRadio=t,this.deviceForm.name="","所有设备"===t){this.deviceForm.mtids="";var i={projectID:this.project};this.fetchPointFilterList(),n.i(p.j)(i).then(function(t){e.filterDeviceOptions=t.data}),this.fetchObservePointList(this.deviceForm)}else""!==this.deviceIdReplace?(this.deviceForm.mtids=this.deviceIdReplace,this.fetchObservePointList(this.deviceForm)):this.observePointList=[]},filterByDevice:function(t){"reset"===t?(this.tableFilterDevice=[],this.deviceForm.mtids=""):this.deviceForm.mtids=this.tableFilterDevice.join(","),this.pagination.currentPage=1,this.deviceForm.page=1,"所有设备"===this.tabRadio?this.deviceForm.mname=this.deviceForm.name:this.deviceForm.mname="",this.fetchObservePointList(this.deviceForm),this.filterPopoverVisible=!1},inputPointName:function(t){var e=document.querySelector(".pnameInput"+t.point);/[`~!@#$%^&*()+<>?:"{},.\/;'[\]]/im.test(t.pname)||0===t.pname.length?(e.querySelector("input").style.borderColor="red",this.tablePointNameValid=!1):(e.querySelector("input").style.borderColor="#bfcbd9",this.tablePointNameValid=!0)}}}},893:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(132),r=n.n(i),a=n(722);e.default={data:function(){var t=this,e=function(e,n,i){var r=t.isInteger(n);if(r.res){var a=t.form.list.map(function(t){return t.value.toString()});a.indexOf(n)!==a.lastIndexOf(n)?i(new Error("值不可重复")):i()}else i(new Error(r.msg))},n=function(e,n,i){var r=t.form.list.map(function(t){return t.showvalue.toString()});r.indexOf(n)!==r.lastIndexOf(n)?i(new Error("描述不可重复")):i()};return{currentProject:"0"===this.$store.state.app.pid?this.$store.state.app.proList[0].id:this.$store.state.app.pid,pointType:"",filterText:"",tableData1:[],tableData2:[],multipleSelection1:[],multipleSelection2:[],tableLoading:!1,currentTypeId:-1,dialogVisible:!1,form:{name:"",type:1,list:[]},formRules:{name:[{required:!0,message:"请输入类型名称",trigger:"blur"},{min:1,max:25,message:"长度在 1 到 25 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择数值类型",trigger:"change"}]},checkValue:e,checkLabel:n}},computed:{proList:function(){return this.$store.state.app.proList},project:function(t){return this.$store.state.app.pid}},watch:{project:function(t){this.currentProject=t,this.fetchPointTypeList()}},mounted:function(){this.fetchPointTypeList()},methods:{changeProject:function(t){this.currentProject=t,this.fetchPointTypeList()},handleSelectionChange1:function(t){this.multipleSelection1=t},handleSelectionChange2:function(t){this.multipleSelection2=t},handleDelete:function(){var t=this;this.$confirm("确认要删除选中的点位类型？","提示",{type:"warning"}).then(function(){var e={},i=[].concat(r()(t.multipleSelection1.map(function(t){return t.ID})),r()(t.multipleSelection2.map(function(t){return t.ID})));e.projectId=t.currentProject,e.ID=i,n.i(a.a)(e).then(function(e){0===e.data?t.$message.error("点位类型删除失败"):1===e.data?(t.$message.success("点位类型删除成功"),t.fetchPointTypeList()):t.$message("选中的点位类型中某些已被使用，点位类型不可删除")}).catch(function(e){t.$message.error("删除失败")})})},openEditDialog:function(t){var e=this;this.currentTypeId=t,-1!==t&&n.i(a.b)(t,this.currentProject).then(function(t){var n=JSON.parse(t.data);e.form.name=n.TypeName,e.form.type=n.type,e.form.list=n.list}).catch(function(t){}),this.dialogVisible=!0},changeValueType:function(t){this.form.list=[]},addFormItem:function(){2===this.form.type?this.form.list.push({unit:"",key:Date.now()}):this.form.list.push({showvalue:"",value:""})},delFormItem:function(t){this.form.type,this.form.list.splice(t,1)},submit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;if(!t.form.list.length)return 1===t.form.type?t.$message("请至少添加一个状态值"):t.$message("请至少添加一个单位"),!1;var i={};i.TypeName=t.form.name,i.type=t.form.type,i.projectId=t.currentProject,i.list=t.form.list,i.ID=-1===t.currentTypeId?"":t.currentTypeId,-1===t.currentTypeId?n.i(a.c)(i).then(function(e){e.data?(t.$message.success("点位类型添加成功"),t.fetchPointTypeList()):t.$message.error("添加失败"),t.fetchPointTypeList()}).catch(function(t){}).finally(function(){t.dialogVisible=!1}):n.i(a.d)(i).then(function(e){e.data?(t.$message.success("点位类型修改成功"),t.fetchPointTypeList()):t.$message.error("修改失败"),t.fetchPointTypeList()}).catch(function(t){}).finally(function(){t.dialogVisible=!1})})},dialogClose:function(){this.form.name="",this.form.type=1,this.form.list=[]},fetchPointTypeList:function(){var t=this;this.tableLoading=!0,n.i(a.e)(this.currentProject,this.filterText).then(function(e){var n=JSON.parse(e.data);t.tableData2=n.Analog,t.tableData1=n.State}).catch(function(t){}).finally(function(){t.tableLoading=!1})},isInteger:function(t){return""===t?{res:!1,msg:"必填"}:parseInt(t,10)!=t?{res:!1,msg:"必须是整数"}:{res:!0}}}}},918:function(t,e,n){e=t.exports=n(539)(),e.push([t.i,".point-type .custom-form-item1 .el-form-item__content{display:-ms-flexbox;display:flex}.point-type .custom-form-item1 .el-input{-ms-flex:0 0 200px;flex:0 0 200px}.point-type .custom-form-item1 .el-button{-ms-flex:0 0 60px;flex:0 0 60px}.point-type .custom-form-item2{display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start;margin-left:80px}.point-type .custom-form-item2>span{-ms-flex:0 0 20px;flex:0 0 20px;text-align:center;margin-top:10px}.point-type .custom-form-item2 .el-button{-ms-flex:0 0 50px;flex:0 0 50px}.point-type .custom-form-item2 div:first-child{-ms-flex:2;flex:2}.point-type .custom-form-item2 div:nth-child(3){-ms-flex:3;flex:3}",""])},919:function(t,e,n){e=t.exports=n(539)(),e.push([t.i,".point-type[data-v-2c3ed75c]{background:#fff;padding:24px 32px}.table-title[data-v-2c3ed75c]{font-weight:700;font-size:15px;margin-top:25px}",""])},926:function(t,e,n){e=t.exports=n(539)(),e.push([t.i,".pointConnect{padding:7px 0 22px}.pointConnect .content-wrap{margin-top:25px;padding:0 15px}.pointConnect .struct{border-radius:4px;overflow:hidden}.pointConnect .struct .content-wrap{margin-top:10px;height:378px;overflow:auto}.pointConnect .struct .el-tree{border:none}.pointConnect .struct .el-tree .icon{font-size:16px;margin-right:5px;color:#20a0ff}.pointConnect .struct .el-tree .el-tree__empty-block{min-height:358px}.pointConnect .transfer-wrap{display:-ms-flexbox;display:flex;height:430px}.pointConnect .transfer-wrap .transfer-body{height:310px;overflow-y:auto;position:relative}.pointConnect .transfer-wrap .transfer-body .transfer-no-data{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);color:#5e6d82;font-size:14px}.pointConnect .transfer-wrap .transfer-body .el-checkbox{display:block;margin-top:5px;margin-left:30px}.pointConnect .transfer-wrap .transfer-left{-ms-flex:1;flex:1;border-radius:4px;overflow:hidden}.pointConnect .transfer-wrap .transfer-left .transfer-search{margin:6px 30px}.pointConnect .transfer-wrap .transfer-right{-ms-flex:1;flex:1;border-radius:4px;overflow:hidden}.pointConnect .transfer-wrap .transfer-right .level-btn-wrap{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;margin-top:10px}.pointConnect .transfer-wrap .transfer-operation{-ms-flex:0 0 80px;flex:0 0 80px;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column}.pointConnect .transfer-wrap .transfer-operation .el-button{margin-top:10px;color:#fff;padding:6px}.pointConnect .transfer-wrap .transfer-operation .el-button+.el-button{margin-left:0}.pointConnect .transfer-wrap .transfer-footer{border-top:1px solid #dedfe0}.pointConnect .transfer-wrap .transfer-footer .transfer-save-btn{float:right;margin-top:10px;margin-right:10px}.pointConnect .point-list{border-radius:4px;margin-top:25px;overflow:hidden}.pointConnect .point-list .content-wrap{padding-bottom:15px}.pointConnect .btn-active{color:#fff;background-color:#20a0ff;border-color:#20a0ff}.pointConnect .typeTree{height:200px;overflow:auto;border-radius:4px;border:1px solid #dcdfe6}.no-permission-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:calc(100vh - 230px)}.no-permission-wrap .left,.no-permission-wrap .right{-ms-flex:0 0 50%;flex:0 0 50%}.no-permission-wrap .left{text-align:right}.no-permission-wrap img{width:300px}.no-permission-wrap p{color:#a5a6a9;font-size:30px;text-align:left;letter-spacing:3px}div.pointConnect-table-filter-popover{padding:0}div.pointConnect-table-filter-popover .filter-top{border-bottom:1px solid #ebeef5;padding:8px}div.pointConnect-table-filter-popover .filter-btn{background:0 0;border:none;outline:none;color:#606266;cursor:pointer;font-size:13px;padding:0 3px;padding-top:7px}div.pointConnect-table-filter-popover .filter-btn:hover{color:#409eff}div.pointConnect-table-filter-popover .filter-btn.disabled{color:#c0c4cc;cursor:not-allowed}@media (max-width:1200px){.transfer-wrap{margin-top:25px}}",""])},927:function(t,e,n){e=t.exports=n(539)(),e.push([t.i,'.navtabs-wrap[data-v-8d43374c]{margin-bottom:15px;border-bottom:2px solid #e4e7ed;background:#fff;padding-left:20px}.navtabs-item[data-v-8d43374c]{padding:0 20px;height:40px;box-sizing:border-box;line-height:40px;display:inline-block;list-style:none;font-size:14px;font-weight:500;position:relative;cursor:pointer}.navtabs-item[data-v-8d43374c]:hover{color:#1890ff!important;cursor:pointer}.navtabs-item[data-v-8d43374c]:first-child{padding-left:0}.navtabs-item:first-child.is-active[data-v-8d43374c]:after{width:calc(100% - 20px);left:0;transform:none}.navtabs-item.is-active[data-v-8d43374c]:after{content:"";position:absolute;left:50%;transform:translateX(-50%);width:calc(100% - 40px);height:2px;bottom:-2px;background:currentColor}',""])},982:function(t,e,n){var i=n(918);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(540)("03cffbc1",i,!0)},983:function(t,e,n){var i=n(919);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(540)("439f7232",i,!0)},990:function(t,e,n){var i=n(926);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(540)("c40a2a98",i,!0)},991:function(t,e,n){var i=n(927);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(540)("667b3ca4",i,!0)}});