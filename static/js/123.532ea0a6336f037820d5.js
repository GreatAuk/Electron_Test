webpackJsonp([123],{1039:function(e,a){e.exports={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"permission-select"},[t("el-alert",{directives:[{name:"show",rawName:"v-show",value:e.role&&0===e.role.CompanyId,expression:"role && role.CompanyId === 0"}],attrs:{title:'"系统角色"是默认角色，无法编辑，请到『关联人员』选项卡中选择角色关联的人员',type:"warning"}}),e._v(" "),e.role&&0!==e.role.CompanyId?t("div",{staticStyle:{margin:"15px 0"}},[t("el-radio-group",{attrs:{size:"small"},model:{value:e.groupType,callback:function(a){e.groupType=a},expression:"groupType"}},[t("el-radio-button",{attrs:{label:"business"}},[e._v("\n        业务平台\n      ")]),e._v(" "),t("el-radio-button",{attrs:{label:"data"}},[e._v("\n        数据平台\n      ")]),e._v(" "),t("el-radio-button",{attrs:{label:"dataScreen"}},[e._v("\n        数据大屏\n      ")])],1),e._v(" "),t("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},nativeOn:{click:function(a){return e.submit(a)}}},[e._v("\n      保存修改\n    ")])],1):e._e(),e._v(" "),t("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.role&&0===e.role.CompanyId,expression:"role && role.CompanyId === 0"},{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"tree",staticStyle:{margin:"30px 40px"},attrs:{data:e.treeData,"show-checkbox":"","node-key":"FuncId","default-expand-all":"","default-checked-keys":e.defaultChecked,props:{children:"Children",label:"FuncName"}},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.node;return t("span",{class:["custom-tree-node",3===n.level?"lv3-node":null]},[t("span",[e._v(e._s(n.label))])])}}])}),e._v(" "),t("el-tree",{directives:[{name:"show",rawName:"v-show",value:"business"===e.groupType&&e.role&&0!==e.role.CompanyId,expression:"groupType === 'business' && (role && role.CompanyId !== 0)"},{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"businessTree",staticStyle:{margin:"30px 40px"},attrs:{data:e.businessTreeData,"show-checkbox":"","node-key":"FuncId","default-expand-all":"","default-checked-keys":e.businessTreeChecked,props:{children:"Children",label:"FuncName"}},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.node;return t("span",{class:["custom-tree-node",3===n.level?"lv3-node":null]},[t("span",[e._v(e._s(n.label))])])}}])}),e._v(" "),t("el-tree",{directives:[{name:"show",rawName:"v-show",value:"data"===e.groupType&&e.role&&0!==e.role.CompanyId,expression:"groupType === 'data' && (role && role.CompanyId !== 0)"},{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"dataTree",staticStyle:{margin:"50px"},attrs:{data:e.dataTreeData,"show-checkbox":"","node-key":"FuncId","default-expand-all":"","default-checked-keys":e.dataTreeChecked,props:{children:"Children",label:"FuncName"}},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.node;return t("span",{class:["custom-tree-node",3===n.level?"lv3-node":null]},[t("span",[e._v(e._s(n.label))])])}}])}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"dataScreen"===e.groupType&&e.role&&0!==e.role.CompanyId,expression:"groupType === 'dataScreen' && (role && role.CompanyId !== 0)"}],staticStyle:{margin:"30px 40px"}},[t("el-checkbox",{staticStyle:{"font-size":"13px","font-weight":"normal"},model:{value:e.dataScreenChecked,callback:function(a){e.dataScreenChecked=a},expression:"dataScreenChecked"}},[e._v("\n      数据大屏\n    ")])],1)],1)},staticRenderFns:[]}},569:function(e,a,t){var n=t(38)(t(898),t(1039),null,null);e.exports=n.exports},898:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t(132),r=t.n(n),o=t(235);a.default={props:{role:{type:Object,default:function(){return null}}},data:function(){return{groupType:"business",treeLoading:!1,treeData:[],businessTreeData:[],dataTreeData:[],defaultChecked:[],businessTreeChecked:[],dataTreeChecked:[],dataScreenChecked:!1}},watch:{role:{handler:function(e){e&&this.drawTree()}}},methods:{submit:function(){var e=this,a=[].concat(r()(this.$refs.businessTree.getCheckedKeys()),r()(this.$refs.dataTree.getCheckedKeys()));this.dataScreenChecked&&a.push(40),t.i(o.a)({HalfSelection:[].concat(r()(this.$refs.businessTree.getHalfCheckedKeys()),r()(this.$refs.dataTree.getHalfCheckedKeys())),FuncIdS:a,RoleId:this.role.RoleId}).then(function(a){200===a.data.Code?e.$message.success("角色修改成功"):e.$message.error("角色修改失败")}).catch(function(a){e.$message.error("角色修改失败")})},drawTree:function(){var e=this;this.treeLoading=!0,this.defaultChecked=[],this.businessTreeChecked=[],this.dataTreeChecked=[],0===this.role.CompanyId?t.i(o.b)({roleId:this.role.RoleId,PlatformType:0}).then(function(a){var t=a.data;200===t.Code?(e.walk(t.Data,1,e.defaultChecked),e.treeData=t.Data,e.$nextTick(function(){e.changeDomStyle()})):e.treeData=[]}).catch(function(a){e.treeData=[]}).finally(function(){e.treeLoading=!1}):(t.i(o.b)({roleId:this.role.RoleId,PlatformType:1}).then(function(a){var t=a.data;200===t.Code?(e.walk(t.Data,2,e.businessTreeChecked),e.businessTreeData=t.Data,e.$nextTick(function(){e.changeDomStyle()})):e.treeData=[]}).catch(function(a){e.treeData=[]}).finally(function(){e.treeLoading=!1}),t.i(o.b)({roleId:this.role.RoleId,PlatformType:2}).then(function(a){var t=a.data;200===t.Code?(e.walk(t.Data,2,e.dataTreeChecked),e.dataTreeData=t.Data,e.$nextTick(function(){e.changeDomStyle()})):e.treeData=[]}).catch(function(a){e.treeData=[]}).finally(function(){e.treeLoading=!1}),t.i(o.b)({roleId:this.role.RoleId,PlatformType:4}).then(function(a){var t=a.data;200===t.Code?e.dataScreenChecked=t.Data[0].Checked:e.dataScreenChecked=!1}).catch(function(a){e.treeData=[]}))},walk:function(e,a,t){var n=this;1===a?e.forEach(function(e){e.disabled=!0,e.Checked&&t.push(e.FuncId),e.Children.length&&n.walk(e.Children,a,t)}):2===a&&e.forEach(function(e){1===e.HalfSelection&&t.push(e.FuncId),e.Children.length&&n.walk(e.Children,a,t)})},changeDomStyle:function(){document.querySelectorAll(".lv3-node").forEach(function(e){var a=e.parentNode.parentNode;a.style.display="inline-block",a.parentNode.cssText="overflow: visible;white-space: pre-wrap;"})}}}}});