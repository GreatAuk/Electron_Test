webpackJsonp([69],{1173:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(93),n=o.n(i),a=o(773),r=o(838);t.default={data:function(){var e=this,t=function(t,o,i){""===o?i(new Error("请输入密码")):(""!==e.formPassword.checkpwd&&e.$refs.formPassword.validateField("checkpwd"),i())},i=function(t,o,i){""===o?i(new Error("请再次输入密码")):o!==e.formPassword.pwdnew?i(new Error("两次输入密码不一致!")):i()},n=function(t,i,n){o.i(a.a)({mobile:e.formPhone.phone}).then(function(e){e.data?n(new Error("该手机号已被注册")):n()})};return{file:[],img:"",imgs:"",imagelist:[],form:{},port:_host+"/Img/Person/",formPhone:{phone:"",checkCode:"",pwd:""},phoneRules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^(((13[0-9]{1})|(15[0-9]{1})| |(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/,message:"请输入正确的手机格式",trigger:"blur"},{validator:n,trigger:"blur"}],pwd:[{required:!0,trigger:"blur",message:"请填写密码"}]},formemail:{emails:"",passwords:""},emailRules:{emails:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],passwords:[{required:!0,trigger:"blur",message:"请填写密码"}]},formPassword:{pwd:"",pwdnew:"",checkpwd:""},passwordRules:{pwd:[{required:!0,trigger:"blur",message:"请填写密码"}],pwdnew:[{required:!0,validator:t,trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,16}$/,message:"8到16位（由字母和数字组成）"}],checkpwd:[{required:!0,validator:i,trigger:"blur"}]},dialogPhoneVisible:!1,dialogEmailVisible:!1,dialogPswVisible:!1,dialogweixinVisible:!1,canSent:!0,time:120}},mounted:function(){var e=this;o.i(r.a)().then(function(t){e.imagelist=JSON.parse(t.data).list}).catch(function(e){});var t=JSON.parse(sessionStorage.getItem("userInfo"));o.i(r.b)(t.uid).then(function(t){e.form=JSON.parse(t.data),e.img=e.port+e.form.img,e.imgs=e.form.img}).catch(function(e){})},methods:{sendMsg:function(){var e=this;if(!this.formPhone.phone)return void this.$message("请填写手机号");o.i(a.a)({mobile:this.formPhone.phone}).then(function(t){t.data?e.canSent=!0:(e.canSent=!1,e.countDown(),o.i(a.b)(e.formPhone.phone).catch(function(e){}))})},countDown:function(){var e=this;0===this.time?(this.canSent=!0,this.time=120):(this.time--,setTimeout(function(){e.countDown()},1e3))},sureBingding:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;o.i(r.c)(t.formPhone.phone,t.formPhone.checkCode,t.formPhone.pwd).then(function(e){var o=JSON.parse(e.data);if("00"!==o.flag)return t.$message.error(o.msg),!1;t.$message({message:o.msg,type:"success"}),t.form.mobile=t.formPhone.phone,t.dialogPhoneVisible=!1}).catch(function(e){})})},cancelphone:function(){this.dialogPhoneVisible=!1,this.canSent=!0,this.time=120,this.formPhone.phone=""},sendemail:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;o.i(r.d)(t.formemail.emails,t.formemail.passwords).then(function(e){var o=JSON.parse(e.data);"00"===o.flag?(t.$message({type:"success",message:o.msg}),t.dialogEmailVisible=!1):t.$message({type:"error",message:o.msg})}).catch(function(e){})})},cancelemail:function(e){this.$refs[e].resetFields(),this.dialogEmailVisible=!1},sendpwd:function(e){var t=this;this.$refs[e].validate(function(i){i&&o.i(r.e)(t.formPassword.pwd,t.formPassword.pwdnew).then(function(o){var i=JSON.parse(o.data);"00"===i.flag?(t.$message({type:"success",message:i.msg}),t.$refs[e].resetFields(),setTimeout(function(){var e=t;sessionStorage.removeItem("user"),e.$router.push("/login")},2e3)):t.$message({type:"error",message:i.msg})}).catch(function(e){})})},cancelpwd:function(e){this.$refs[e].resetFields(),this.dialogPswVisible=!1},selectImg:function(e){this.img=this.port+e,this.imgs=e,this.file=e},saveImg:function(){var e=this,t=JSON.parse(sessionStorage.getItem("userInfo"));o.i(r.f)(this.file,t.uid).then(function(o){"00"===JSON.parse(o.data).flag?(e.$message("修改成功"),t.avatar=e.imgs,e.$store.commit("UPDATE_USERINFO",n()(t)),sessionStorage.setItem("userInfo",n()(t))):e.$message.error("修改失败")}).catch(function(e){})},beforeDevImgUpload:function(e){var t=this,i=new FormData;return i.append("file",e),o.i(r.g)(i).then(function(e){t.img=t.port+e.data,t.imgs=e.data,t.file=e.data}).catch(function(e){}),!1},clearImg:function(){this.$refs.upload.clearFiles()},updatePhone:function(){this.dialogPhoneVisible=!0},updateEmail:function(){this.dialogEmailVisible=!0,this.formemail.emails="",this.formemail.pwds=""},updatePsw:function(){this.dialogPswVisible=!0},bingding:function(){this.dialogweixinVisible=!0},cancelbingding:function(){var e=this;this.$prompt("请输入帐号密码","输入密码",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var i=t.value;o.i(r.h)(i).then(function(t){var o=JSON.parse(t.data);"00"===o.flag?(e.$message({type:"success",message:o.msg}),e.dialogweixinVisible=!1):e.$message({type:"error",message:o.msg})}).catch(function(e){})}).catch(function(e){})},submitForm:function(){o.i(r.i)({id:this.form.id,account:this.form.account,nickname:this.form.nickname,cname:this.form.cname,mobile:this.form.mobile,email:this.form.email,depart:this.form.depart}).then(function(e){"00"===JSON.parse(e.data).flag?this.$message("修改成功"):this.$message.error("修改失败")}).catch(function(e){})}}}},1209:function(e,t,o){t=e.exports=o(539)(),t.push([e.i,'.myinfo .emailbox input:-webkit-autofill{box-shadow:inset 0 0 0 1000px #fff;-webkit-text-fill-color:#fff}.myinfo .commonWrapper{color:#324057}.myinfo .commonWrapper .commonBox{border-radius:4px;margin-bottom:20px;background:#fff}.myinfo .commonWrapper .commonBox .commonHeader{height:46px;padding:10px;color:#324057;border-bottom:1px solid #dedfe0}.myinfo .commonWrapper .commonBox .commonHeader .title-icon{font-size:20px;margin-right:6px;vertical-align:-.2em}.myinfo .commonWrapper .commonBox .commonHeader .commonImg{float:left;margin-right:10px;height:26px;width:26px}.myinfo .commonWrapper .commonBox .commonHeader .squareDown{float:right;margin-top:12px;margin-right:10px;height:20px;width:20px;cursor:pointer}.myinfo .commonWrapper .commonBox .commonHeader .squareDown .commonIcon{float:left}.myinfo .commonWrapper .commonBox .commonHeader .commonTitle{height:26px;line-height:26px;font-size:16px;font-weight:700}.myinfo .clearfix:after{content:"";display:block;clear:both}.myinfo .p_gap{padding:40px 20px}.myinfo .myimage{height:45px;width:45px;margin-right:15px}.myinfo .mine{margin-bottom:10px}.myinfo .mine span{display:inline-block;vertical-align:top;line-height:45px}.myinfo .imgList{text-align:center;margin:35px 30px}.myinfo .imgList .myimg{height:45px;width:45px;margin:0 20px 10px;cursor:pointer}.myinfo .upload-demo{width:40%;display:inline-block;height:46px;line-height:46px;border:1px solid #ccc;padding:0 10px;border-radius:4px}.myinfo .el-upload--text{width:auto;height:auto;border:none;vertical-align:top}.myinfo .el-upload-list{display:inline-block}.myinfo .btn{text-align:center}.myinfo .el-form{padding:0 10%}.myinfo .table{padding:20px 15%}.myinfo .table .el-col{margin-bottom:15px}.myinfo .table .el-col:last-child{margin-bottom:0}.myinfo .table .el-col div:first-child{margin-bottom:10px}.myinfo .table .el-col .txtcolor{cursor:pointer;color:#399;float:right}.myinfo .dialogBox .el-dialog{width:400px}',""])},1339:function(e,t,o){var i=o(1209);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o(540)("5ea38ffc",i,!0)},1500:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-row",{staticClass:"myinfo pdg2",staticStyle:{margin:"0"},attrs:{gutter:20}},[o("el-col",{staticClass:"commonWrapper",staticStyle:{"padding-left":"0"},attrs:{span:12}},[o("div",{staticClass:"commonBox clearfix"},[o("el-col",{staticClass:"commonHeader"},[o("c-svg",{attrs:{name:"smile","class-name":"commonImg"}}),e._v(" "),o("span",{staticClass:"commonTitle"},[e._v("我的头像")])],1),e._v(" "),o("el-col",{staticClass:"commonContent p_gap"},[o("div",{staticClass:"mine"},[o("img",{staticClass:"myimage",attrs:{src:e.img}}),e._v(" "),o("span",[e._v("头像预览")]),e._v(" "),o("span",[e._v("(建议用主流的PNG,GIF,jpeg,bmp，建议用200KB以内的图片)")])]),e._v(" "),o("div",[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","before-upload":e.beforeDevImgUpload,accept:"image/png,image/jpg,image/jpeg"}},[o("el-button",{attrs:{slot:"trigger",size:"big",type:"primary"},on:{click:e.clearImg},slot:"trigger"},[e._v("\n              选取文件\n            ")])],1)],1),e._v(" "),o("div",{staticClass:"imgList"},e._l(e.imagelist,function(t,i){return o("img",{key:i,staticClass:"myimg",attrs:{src:e.port+t.name},on:{click:function(o){return e.selectImg(t.name)}}})}),0),e._v(" "),o("div",{staticClass:"btn"},[o("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.saveImg(t)}}},[e._v("\n            确认\n          ")])],1)])],1)]),e._v(" "),o("el-col",{staticClass:"commonWrapper",attrs:{span:12}},[o("div",{staticClass:"commonBox clearfix"},[o("el-col",{staticClass:"commonHeader"},[o("c-svg",{attrs:{name:"hamburger","class-name":"commonImg"}}),e._v(" "),o("span",{staticClass:"commonTitle"},[e._v("我的信息设置")])],1),e._v(" "),o("el-col",{staticClass:"commonContent table"},[o("el-col",{attrs:{span:12}},[o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("用户名")])]),e._v(" "),o("div",[o("el-input",{attrs:{disabled:!0},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1)]),e._v(" "),o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("手机号")]),o("span",{staticClass:"txtcolor",on:{click:e.updatePhone}},[e._v("修改手机")])]),e._v(" "),o("div",[o("el-input",{attrs:{disabled:!0},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)]),e._v(" "),o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("公司名称")])]),e._v(" "),o("div",[o("el-input",{model:{value:e.form.cname,callback:function(t){e.$set(e.form,"cname",t)},expression:"form.cname"}})],1)]),e._v(" "),o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("密码")]),o("span",{staticClass:"txtcolor",on:{click:e.updatePsw}},[e._v("修改密码")])])])],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("姓名")])]),e._v(" "),o("div",[o("el-input",{model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1)]),e._v(" "),o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("邮箱")]),o("span",{staticClass:"txtcolor",on:{click:e.updateEmail}},[e._v("修改邮箱")])]),e._v(" "),o("div",[o("el-input",{attrs:{disabled:!0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)]),e._v(" "),o("el-col",{attrs:{span:24}},[o("div",[o("span",[e._v("部门")])]),e._v(" "),o("div",[o("el-input",{model:{value:e.form.depart,callback:function(t){e.$set(e.form,"depart",t)},expression:"form.depart"}})],1)]),e._v(" "),o("el-col",{attrs:{span:24}},[o("div",{directives:[{name:"show",rawName:"v-show",value:""==e.form.wxicon,expression:"form.wxicon==''"}]},[o("span",{staticClass:"txtcolor",on:{click:e.bingding}},[e._v("绑定微信")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.wxicon,expression:"form.wxicon!=''"}]},[o("img",{attrs:{src:e.port+e.form.wxicon}}),o("span",{staticClass:"txtcolor",on:{click:e.cancelbingding}},[e._v("解除绑定")])])])],1),e._v(" "),o("el-col",{staticClass:"btn",attrs:{span:24}},[o("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("\n            确认\n          ")])],1)],1)],1)]),e._v(" "),o("el-dialog",{staticClass:"dialogBox",attrs:{title:"绑定手机",visible:e.dialogPhoneVisible},on:{"update:visible":function(t){e.dialogPhoneVisible=t}}},[o("el-form",{ref:"formPhone",attrs:{model:e.formPhone,rules:e.phoneRules}},[o("el-form-item",{attrs:{prop:"phone"}},[o("el-input",{attrs:{placeholder:"手机号"},model:{value:e.formPhone.phone,callback:function(t){e.$set(e.formPhone,"phone","string"==typeof t?t.trim():t)},expression:"formPhone.phone"}},[o("template",{slot:"prepend"},[o("el-button",[e._v("+86")])],1)],2)],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{placeholder:"手机验证码",maxlength:4,minlength:4},model:{value:e.formPhone.checkCode,callback:function(t){e.$set(e.formPhone,"checkCode","string"==typeof t?t.trim():t)},expression:"formPhone.checkCode"}},[o("template",{slot:"append"},[o("el-button",{staticClass:"send-msg-btn",attrs:{disabled:!e.canSent},on:{click:e.sendMsg}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.canSent,expression:"canSent"}]},[e._v("发送短信")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.canSent,expression:"!canSent"}]},[e._v(e._s(e.time)+"S")])])],1)],2)],1),e._v(" "),o("el-form-item",{attrs:{prop:"pwd"}},[o("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.formPhone.pwd,callback:function(t){e.$set(e.formPhone,"pwd","string"==typeof t?t.trim():t)},expression:"formPhone.pwd"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"text-align":"center"}},[o("el-button",{on:{click:e.cancelphone}},[e._v("\n          取消\n        ")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureBingding("formPhone")}}},[e._v("\n          确认\n        ")])],1)],1)],1),e._v(" "),o("el-dialog",{staticClass:"dialogBox",attrs:{title:"修改邮箱",visible:e.dialogEmailVisible},on:{"update:visible":function(t){e.dialogEmailVisible=t}}},[o("el-form",{ref:"formemail",staticClass:"emailbox",attrs:{model:e.formemail,rules:e.emailRules}},[o("el-form-item",{attrs:{prop:"emails"}},[o("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]}),e._v(" "),o("el-input",{attrs:{type:"text",placeholder:"邮箱","auto-complete":""},model:{value:e.formemail.emails,callback:function(t){e.$set(e.formemail,"emails",t)},expression:"formemail.emails"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"passwords"}},[o("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]}),e._v(" "),o("el-input",{attrs:{type:"password",placeholder:"密码","auto-complete":""},model:{value:e.formemail.passwords,callback:function(t){e.$set(e.formemail,"passwords",t)},expression:"formemail.passwords"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"text-align":"center"}},[o("el-button",{on:{click:function(t){return e.cancelemail("formemail")}}},[e._v("\n          取 消\n        ")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sendemail("formemail")}}},[e._v("\n          确 认\n        ")])],1)],1)],1),e._v(" "),o("el-dialog",{staticClass:"dialogBox",attrs:{title:"修改密码",visible:e.dialogPswVisible},on:{"update:visible":function(t){e.dialogPswVisible=t}}},[o("el-form",{ref:"formPassword",attrs:{model:e.formPassword,rules:e.passwordRules}},[o("el-form-item",{attrs:{prop:"pwd"}},[o("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.formPassword.pwd,callback:function(t){e.$set(e.formPassword,"pwd","string"==typeof t?t.trim():t)},expression:"formPassword.pwd"}})],1),e._v(" "),o("el-form-item",{attrs:{error:"",prop:"pwdnew"}},[o("el-input",{attrs:{type:"password",placeholder:"新密码"},model:{value:e.formPassword.pwdnew,callback:function(t){e.$set(e.formPassword,"pwdnew","string"==typeof t?t.trim():t)},expression:"formPassword.pwdnew"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"checkpwd"}},[o("el-input",{attrs:{type:"password",placeholder:"确认密码"},model:{value:e.formPassword.checkpwd,callback:function(t){e.$set(e.formPassword,"checkpwd","string"==typeof t?t.trim():t)},expression:"formPassword.checkpwd"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"text-align":"center"}},[o("el-button",{on:{click:function(t){return e.cancelpwd("formPassword")}}},[e._v("\n          取 消\n        ")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sendpwd("formPassword")}}},[e._v("\n          确认修改\n        ")])],1)],1)],1),e._v(" "),o("el-dialog",{staticClass:"dialogBox",attrs:{title:"扫一扫",visible:e.dialogweixinVisible},on:{"update:visible":function(t){e.dialogweixinVisible=t}}},[o("el-form",{staticStyle:{"text-align":"center"}},[o("img",{staticStyle:{width:"215px",height:"215px"},attrs:{src:"static/img/Coolcarewx.jpg"}}),e._v(" "),o("div",[e._v("请扫码关注，以进行用户绑定")])])],1)],1)},staticRenderFns:[]}},678:function(e,t,o){o(1339);var i=o(38)(o(1173),o(1500),null,null);e.exports=i.exports},773:function(e,t,o){"use strict";o.d(t,"a",function(){return n}),o.d(t,"e",function(){return a}),o.d(t,"b",function(){return r}),o.d(t,"d",function(){return s}),o.d(t,"f",function(){return l}),o.d(t,"g",function(){return m}),o.d(t,"c",function(){return c});var i=o(32),n=function(e){return i.a.post("/api/user/Exists",e)},a=function(e){return i.a.post("/api/user/AddUser",e)},r=function(e){return i.a.get("/api/user/MobileCode",{params:{mobile:e}})},s=function(e,t){return i.a.get("/api/user/CheckCode",{params:{mobile:e,code:t}})},l=function(e){return i.a.post("/api/user/ForgetPwd",e)},m=function(e){return i.a.get("/api/user/InvitationUser",{params:{mobile:e}})},c=function(e){return i.a.get("/api/user/GetCompanyName",{params:{companyName:e}})}},838:function(e,t,o){"use strict";o.d(t,"k",function(){return n}),o.d(t,"j",function(){return a}),o.d(t,"l",function(){return r}),o.d(t,"m",function(){return s}),o.d(t,"b",function(){return l}),o.d(t,"g",function(){return m}),o.d(t,"a",function(){return c}),o.d(t,"f",function(){return p}),o.d(t,"i",function(){return d}),o.d(t,"c",function(){return u}),o.d(t,"d",function(){return f}),o.d(t,"e",function(){return g}),o.d(t,"h",function(){return h});var i=o(32),n=function(e){var t=e.RoleName,o=e.CompanyId;return i.a.post(BASE_URI+"/api/Role/AddRole",{RoleName:t,CompanyId:o},{headers:{"Content-Type":"application/json"}})},a=function(e){var t=e.companyId;return i.a.get(BASE_URI+"/api/Role/GetCompany_RoleList",{params:{companyId:t}})},r=function(e){var t=e.roleId;return i.a.get(BASE_URI+"/api/Role/DaleteRole",{params:{roleId:t}})},s=function(e){var t=e.roleId,o=e.roleName;return i.a.get(BASE_URI+"/api/Role/UpdateRole",{params:{roleId:t,roleName:o}})},l=function(e){return i.a.get("/api/Role/getInfo",{params:{uid:e}})},m=function(e){return i.a.post("/api/Role/imgUrl",e,{headers:{"Content-Type":"multipart/form-data"}})},c=function(){return i.a.get("/api/Role/imgShow")},p=function(e,t){return i.a.get("/api/Role/updateImg",{params:{url:e,uid:t}})},d=function(e){return i.a.post("/api/Role/updateInfo",e)},u=function(e,t,o){return i.a.get("/api/Role/updateMobile",{params:{mobile:e,code:t,pwd:o}})},f=function(e,t){return i.a.get("/api/Role/exitEmail",{params:{email:e,pwd:t}})},g=function(e,t){return i.a.get("/api/Role/updatePwd",{params:{pwd:e,newpwd:t}})},h=function(e){return i.a.get("/api/Role/updateWChart",{params:{pwd:e}})}}});