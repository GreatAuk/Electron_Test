webpackJsonp([94],{1177:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a(218),o=a.n(l);t.default={data:function(){return{positionList:"",total:null,pointList:null,filters:{name:""},sels:[],listLoading:!0,listQuery:{page:1,limit:20},pname:null,mtid:null,pointForm:{},dialogVisible:!1,dialogFormVisible:!1,confirmDialog:!1,pointFormRules:{area:[{required:!0,message:"请输入区域",trigger:"blur"}],pname:[{required:!0,message:"请输入名称",trigger:"blur"}],alevel:[{required:!0,message:"请输入报警级别",trigger:"blur"}],level:[{required:!0,message:"请输入测点级别",trigger:"blur"}]},typeTreeData:null,typeTreeProps:{label:"name",children:"Child"},tableData:[{cn:1231323,area:"一楼",place:"沙发",name:"xxxxxx",type:"球型",state:"在线",alarmlevel:"一级",siteId:"123"},{cn:1231323,area:"二楼",place:"电视",name:"xxxxxx",type:"球型",state:"离线",alarmlevel:"二级",siteId:"1236"},{cn:1231323,area:"三楼",place:"厕所",name:"xxxxxx",type:"球型",state:"离线",alarmlevel:"三级",siteId:"1235"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"},{cn:1231323,area:"四楼",place:"电脑",name:"xxxxxx",type:"普通",state:"在线",alarmlevel:"四级",siteId:"1234"}],treeLoading:!0,searchForm:{mtid:sessionStorage.getItem("mtid"),level:"",page:1,num:10,area:"",name:"",stime:"",etime:"",typecn:"",status:null,alarmlevel:"",stype:1}}},mounted:function(){},methods:{selsChange:function(e){this.sels=e},getList:function(){var e=this;this.mtid=sessionStorage.getItem("mtid"),this.tableData.mtid=sessionStorage.getItem("mtid"),this.tableData.page=this.listQuery.page,this.tableData.num=this.listQuery.limit,this.tableData.level=0,this.tableData.area="",this.tableData.name="",this.tableData.stime=null,this.tableData.etime=null,this.tableData.status="",this.tableData.typecn="",this.tableData.stype=1,this.tableData.alarmlevel=null,this.$http.post(""+monitor.pointAll,this.tableData,{emulateJSON:!0}).then(function(t){e.listLoading=!1,JSON.parse(t.data).success&&(e.pointList=JSON.parse(t.data).list,e.pname=e.pointList[0].pname,e.total=JSON.parse(t.data).totalcount)}).catch(function(t){e.$message.error("服务器错误")})},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},formatter:function(e,t){return 0===e.status?"离线":"在线"},openDialog:function(e){var t=this;this.$http.get(monitor.openDialog+"?mtid="+this.mtid+"&point="+e).then(function(e){t.pointForm=JSON.parse(e.body),t.dialogFormVisible=!0,t.$http.get(""+monitor.getType).then(function(e){t.typeTreeData=JSON.parse(e.body).list,t.treeLoading=!1}).catch(function(e){})}).catch(function(e){})},typeTreeClick:function(e){this.pointForm.type=e.id},clickDel:function(e){this.confirmDialog=!0,this.pointId=e},delPoint:function(){var e=this;this.$http.get(monitor.delPoint+"?mtid="+this.mtid+"&point="+this.pointId).then(function(t){"00"===JSON.parse(t.data).flag?(e.$message({type:"success",message:"删除成功"}),e.confirmDialog=!1,e.tableLoading=!0,e.getList()):e.$message({type:"error",message:"删除失败"})}).catch(function(e){})},submitPointForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$http.post(""+monitor.modifyPoint,t.pointForm,{emulateJSON:!0}).then(function(e){"00"===JSON.parse(e.body).flag?(t.$message({type:"success",message:"修改成功"}),t.dialogFormVisible=!1,t.tableLoading=!0,t.getList()):t.$message.error("修改失败")}).catch(function(e){t.$message.error("服务器错误")})})},handleDownload:function(){var e=this;this.tableData.mtid=this.mtid,this.tableData.page=1,this.tableData.num=this.total,this.$http.post(""+monitor.pointAll,this.tableData,{emulateJSON:!0}).then(function(t){e.excelList=JSON.parse(t.data).list,e.total=JSON.parse(t.data).totalcount,a.e(145).then(function(){var t=a(832),l=t.export_json_to_excel,o=["id","区域","名称","值","更新时间","类型","测点级别","状态","报警级别"],i=["id","area","name","valuename","updatetime","typeCn","level","status","alarmlevel"];l(o,e.formatJson(i,e.excelList),"监测点列表")}.bind(null,a)).catch(a.oe)}).catch(function(t){e.$message.error("服务器错误")})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},findPoint:function(){this.tableLoading=!1;var e=o()({},this.searchForm);e.stime&&(e.stime=e.stime.format("yyyy/MM/dd hh:mm")),e.etime&&(e.etime=e.etime.format("yyyy/MM/dd hh:mm")),this.$http.post(""+monitor.pointAll,e,{emulateJSON:!0}).then(function(e){this.pointList=JSON.parse(e.data).list,this.tableLoading=!1}).catch(function(e){})},checkVideo:function(){this.dialogVisible=!0,setTimeout(function(){var e=new EZUIPlayer("myPlayer");e.on("error",function(){}),e.on("play",function(){}),e.on("pause",function(){})},1e3)}}}},1251:function(e,t,a){t=e.exports=a(539)(),t.push([e.i,".video-wrapper[data-v-47d474cf]{text-align:center;overflow:hidden}.video-wrapper .video[data-v-47d474cf]{width:800px;height:350px}.toolbar[data-v-47d474cf]{margin:15px 0}.toolbar .el-form-item[data-v-47d474cf]{margin-bottom:10px}.commonWrapper[data-v-47d474cf]{width:100%}.commonWrapper .commonBox[data-v-47d474cf]{box-shadow:0 0 6px rgba(0,0,0,.4);border-radius:4px;margin-bottom:20px}.commonWrapper .commonBox .commonHeader[data-v-47d474cf]{height:26px;line-height:26px;padding:10px;border-bottom:1px solid #dedfe0}.commonWrapper .commonBox .commonHeader .commonImg[data-v-47d474cf]{float:left;margin-right:10px;height:26px;width:26px}.commonWrapper .commonBox .commonHeader .squareDown[data-v-47d474cf]{float:right;margin-top:12px;margin-right:10px;height:20px;width:20px;cursor:pointer}.commonWrapper .commonBox .commonHeader .squareDown .commonIcon[data-v-47d474cf]{float:left;height:8px;width:10px}.commonWrapper .commonBox .commonHeader .commonTitle[data-v-47d474cf]{float:left;height:26px;line-height:28px;font-size:16px;font-weight:700}.commonWrapper .commonBox .tableWrapper[data-v-47d474cf]{padding:15px}.pointDialog .typeTree[data-v-47d474cf]{height:200px;overflow:auto;border-radius:4px}",""])},1381:function(e,t,a){var l=a(1251);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a(540)("2394f07e",l,!0)},1535:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tableContainer"},[a("div",{staticClass:"commonWrapper"},[a("div",{staticClass:"commonBox"},[e._m(0),e._v(" "),a("el-row",{staticStyle:{margin:"0"},attrs:{gutter:24}},[a("el-col",{staticClass:"toolbar",staticStyle:{padding:"0"},attrs:{"label-width":"100px"}},[a("el-form",{staticStyle:{float:"left",width:"100%"},attrs:{inline:!1,model:e.searchForm}},[a("el-col",{attrs:{sm:6,md:6,lg:3}},[a("el-form-item",{staticClass:"toolwrapper"},[a("el-input",{attrs:{placeholder:"区域"},model:{value:e.searchForm.area,callback:function(t){e.$set(e.searchForm,"area",t)},expression:"searchForm.area"}})],1)],1),e._v(" "),a("el-col",{attrs:{sm:6,md:6,lg:3}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"位置"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{sm:6,md:6,lg:3}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"类型"},model:{value:e.searchForm.typeCn,callback:function(t){e.$set(e.searchForm,"typeCn",t)},expression:"searchForm.typeCn"}})],1)],1),e._v(" "),a("el-col",{attrs:{sm:6,md:6,lg:3}},[a("el-form-item",[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"在线",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"离线",value:"-1"}}),e._v(" "),a("el-option",{attrs:{label:"报警",value:"1"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{sm:6,md:6,lg:3}},[a("el-form-item",[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"报警级别"},model:{value:e.searchForm.alarmlevel,callback:function(t){e.$set(e.searchForm,"alarmlevel",t)},expression:"searchForm.alarmlevel"}},[a("el-option",{attrs:{label:"紧急",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"重要",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"一般",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"记录",value:"4"}})],1)],1)],1),e._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"20px"},attrs:{type:"primary"}},[e._v("\n              查找\n            ")])],1)],1),e._v(" "),a("el-col",{staticStyle:{padding:"0 11px"}},[a("el-table",{attrs:{data:e.tableData,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"area",label:"区域",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"place",label:"位置",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型",sortable:"",align:"center",width:"150px"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"200px",align:"center",formatter:e.formatter,prop:"state"}}),e._v(" "),a("el-table-column",{attrs:{label:"报警级别",width:"200px",align:"center",prop:"alarmlevel"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkVideo(t)}}},[e._v("\n                  查看视频\n                ")])]}}])})],1),e._v(" "),a("div",{staticClass:"toolbar",staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"pointDialog",attrs:{title:"编辑点位",visible:e.dialogFormVisible,size:"tiny"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"pointForm",attrs:{model:e.pointForm,rules:e.pointFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"区域",prop:"area"}},[a("el-input",{model:{value:e.pointForm.area,callback:function(t){e.$set(e.pointForm,"area",t)},expression:"pointForm.area"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"名称",prop:"pname"}},[a("el-input",{model:{value:e.pointForm.pname,callback:function(t){e.$set(e.pointForm,"pname",t)},expression:"pointForm.pname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单位",prop:"unit"}},[a("el-input",{model:{value:e.pointForm.unit,callback:function(t){e.$set(e.pointForm,"unit",t)},expression:"pointForm.unit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"测点级别",prop:"level"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.pointForm.level,callback:function(t){e.$set(e.pointForm,"level",t)},expression:"pointForm.level"}},[a("el-option",{attrs:{label:"一级测点",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"二级测点",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"三级测点",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"报警级别",prop:"alarmLevel"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.pointForm.alarmLevel,callback:function(t){e.$set(e.pointForm,"alarmLevel",t)},expression:"pointForm.alarmLevel"}},[a("el-option",{attrs:{label:"紧急",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"重要",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"一般",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"记录",value:"4"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类型名称",prop:"typename"}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],staticClass:"typeTree",attrs:{data:e.typeTreeData,"node-key":"id","current-node-key":e.pointForm.type,"default-expanded-keys":[e.pointForm.type],accordion:"",props:e.typeTreeProps,"highlight-current":"","element-loading-text":"加载中..."},on:{"node-click":e.typeTreeClick}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:function(t){return e.submitPointForm("pointForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"删除点位",visible:e.confirmDialog,"custom-class":"confirmDialog"},on:{"update:visible":function(t){e.confirmDialog=t}}},[a("span",[e._v("您确定要删除这条数据吗？")]),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.confirmDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:e.delPoint}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"一楼沙发旁",visible:e.dialogVisible,width:"1200px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("div",{staticClass:"video-wrapper"},[a("video",{staticClass:"video",attrs:{id:"myPlayer",poster:"",controls:"",playsInline:"","webkit-playsinline":"",autoplay:""}},[a("source",{attrs:{src:"rtmp://rtmp.open.ys7.com/openlive/d146d8ab81ae45bbb4495fca16b3f5f9.hd",type:""}}),e._v(" "),a("source",{attrs:{src:"http://hls.open.ys7.com/openlive/d146d8ab81ae45bbb4495fca16b3f5f9.hd.m3u8",type:"application/x-mpegURL"}})])]):e._e()])],1)])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"commonHeader"},[a("img",{staticClass:"commonImg",attrs:{src:"static/img/icon/calendar.png"}}),e._v(" "),a("span",{staticClass:"commonTitle"},[e._v("监控器列表")])])}]}},682:function(e,t,a){a(1381);var l=a(38)(a(1177),a(1535),"data-v-47d474cf",null);e.exports=l.exports}});